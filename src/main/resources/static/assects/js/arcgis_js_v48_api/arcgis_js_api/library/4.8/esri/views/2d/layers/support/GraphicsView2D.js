// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.8/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../Graphic ../../../../core/Collection ../../../../core/Handles ../../../../core/promiseUtils ../../../../core/accessorSupport/decorators ../../engine/graphics/GFXGroup ../../engine/graphics/GFXObject ../../engine/graphics/GFXSurface ../../../layers/GraphicsView".split(" "),function(u,v,h,f,k,l,m,n,e,p,q,r,t){return function(g){function c(){for(var a=[],b=0;b<arguments.length;b++)a[b]=
arguments[b];var d=g.apply(this,a)||this;d._frontGroup=new p;d._handles=new m;d._objects=new Map;d.container=new r;d.container.addChild(d._frontGroup);d.watch("graphics",function(){return d._reset()},!0);return d}h(c,g);c.prototype.hitTest=function(a,b){if(!this.view||!this.view.position)return null;a+=this.view.position[0]-window.pageXOffset;b+=this.view.position[1]-window.pageYOffset;return(a=this.container.hitTest(a,b))?n.resolve(a.graphic):null};c.prototype.graphicUpdateHandler=function(a){var b=
a.graphic,d=a.property;a=a.newValue;if(this._objects.has(b)){var c=this._objects.get(b);switch(d){case "geometry":c.graphic=b;break;case "symbol":c.renderingInfo={symbol:a};break;case "visible":c.visible=a}}};c.prototype._reset=function(){var a=this;this._handles.remove("graphics");this._objects.forEach(function(b,c){a._frontGroup.removeChild(b)});this._objects.clear();this.graphics&&(this.graphics.forEach(this._add,this),this._handles.add(this.graphics.on("change",function(b){return a._graphicsChangeHandler(b)}),
"graphics"))};c.prototype._add=function(a){if(a&&!this._objects.has(a)){var b=new q;b.graphic=a;b.renderingInfo={symbol:a.symbol};this._objects.set(a,b);this._frontGroup.addChild(b)}};c.prototype._remove=function(a){var b=this._objects.get(a);b&&(this._objects.delete(a),this._frontGroup.removeChild(b))};c.prototype._graphicsChangeHandler=function(a){var b=a.added,c=a.removed;a.moved.length&&this._reset();for(var e=0;e<b.length;e++)a=b[e],this._add(a);for(b=0;b<c.length;b++)a=c[b],this._remove(a)};
f([e.property(),e.cast(l.ofType(k))],c.prototype,"graphics",void 0);f([e.property()],c.prototype,"view",void 0);return c=f([e.subclass("esri.views.2d.layers.support.GraphicsView2D")],c)}(e.declared(t))});