// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.8/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper dojo/i18n!../../Legend/nls/Legend dojox/gfx ../../../core/accessorSupport/decorators ../../Widget ./common ../../Legend/support/styleUtils ../../support/widget".split(" "),function(z,A,v,r,t,w,q,x,y,n,g){return function(u){function f(a){a=u.call(this)||this;a.activeLayerInfos=null;return a}v(f,u);f.prototype.render=function(){var a=this,d=this.activeLayerInfos,b=this.classes("esri-legend esri-widget--panel",
"esri-widget"),d=d&&d.toArray().map(function(c){return a._renderLegendForLayer(c)}).filter(function(a){return!!a});return g.tsx("div",{class:b},d&&d.length?d:g.tsx("div",{class:"esri-legend__message"},t.noLegend))};f.prototype._renderLegendForLayer=function(a){var d=this,b;if(!a.ready)return null;var c=!!a.children.length,k="esri-legend__"+a.layer.uid+"-version-"+a.version,e=a.title?g.tsx("h3",{class:this.classes("esri-widget__header","esri-legend__service-label")},a.title):null;if(c)return b=a.children.map(function(a){return d._renderLegendForLayer(a)}).toArray(),
g.tsx("div",{key:k,class:this.classes("esri-legend__service","esri-legend__group-layer")},e,b);if((c=a.legendElements)&&!c.length)return null;c=c.map(function(b){return d._renderLegendForElement(b,a.layer)}).filter(function(a){return!!a});if(!c.length)return null;var h=(b={},b["esri-legend__group-layer-child"]=!!a.parent,b);return g.tsx("div",{key:k,class:this.classes("esri-legend__service",h)},e,g.tsx("div",{class:"esri-legend__layer"},c))};f.prototype._renderLegendForElement=function(a,d,b){var c=
this,k,e="color-ramp"===a.type,h="opacity-ramp"===a.type,f="size-ramp"===a.type,p=null;if("symbol-table"===a.type||f){var l=a.infos.map(function(b){return c._renderLegendForElementInfo(b,d,f,a.legendType)}).filter(function(a){return!!a});l.length&&(p=g.tsx("div",{class:"esri-legend__layer-body"},l))}else"color-ramp"===a.type||"opacity-ramp"===a.type||"heatmap-ramp"===a.type?p=this._renderLegendForRamp(a):"relationship-ramp"===a.type&&(p=y.renderRelationshipRamp(a,this.id));if(!p)return null;var l=
a.title,m=null;"string"===typeof l?m=l:l&&(m=n.getTitle(l,e||h),m=n.isRendererTitle(l,e||h)&&l.title?l.title+" ("+m+")":m);e=b?"esri-legend__layer-child-table":"esri-legend__layer-table";h=m?g.tsx("div",{class:"esri-legend__layer-caption"},m):null;b=(k={},k["esri-legend__layer-table--size-ramp"]=f||!b,k);return g.tsx("div",{class:this.classes(e,b)},h,p)};f.prototype._renderLegendForRamp=function(a){var d=a.infos,b="opacity-ramp"===a.type,c="heatmap-ramp"===a.type,k=d.length-1,e=null;2<k&&!c?e=25*
k:e=c?75:50;var h=document.createElement("div");h.className="esri-legend__color-ramp "+(b?"esri-legend__opacity-ramp":"");h.style.height=e+"px";b=w.createSurface(h,"100%",e);try{if(c||d.forEach(function(a,b){a.offset=b/k}),b.createRect({x:0,y:0,width:"100%",height:e}).setFill({type:"linear",x1:0,y1:0,x2:0,y2:e,colors:d}).setStroke(null),"color-ramp"===a.type||"opacity-ramp"===a.type){var f=a.overlayColor;f&&0<f.a&&b.createRect({x:0,y:0,width:"100%",height:e}).setFill(f).setStroke(null)}}catch(p){b.clear(),
b.destroy()}if(!b)return null;a=d.filter(function(a){return!!a.label}).map(function(a){return g.tsx("div",{class:"esri-legend__ramp-label"},c?t[a.label]:a.label)});e={height:e+"px"};return g.tsx("div",{class:"esri-legend__layer-row"},g.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--symbols",styles:{width:"24px"}},g.tsx("div",{class:"esri-legend__ramps",bind:h,afterCreate:n.attachToNode})),g.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},g.tsx("div",{class:"esri-legend__ramp-labels",
styles:e},a)))};f.prototype._renderLegendForElementInfo=function(a,d,b,c){var f,e;if(a.type)return this._renderLegendForElement(a,d,!0);var h=null;c=n.isImageryStretchedLegend(d,c);a.symbol&&a.preview?h=g.tsx("div",{class:"esri-legend__symbol",bind:a.preview,afterCreate:n.attachToNode}):a.src&&(h=this._renderImage(a,d,c));if(!h)return null;d=(f={},f["esri-legend__imagery-layer-info--stretched"]=c,f);b=(e={},e["esri-legend__imagery-layer-info--stretched"]=c,e["esri-legend__size-ramp"]=!c&&b,e);return g.tsx("div",
{class:"esri-legend__layer-row"},g.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--symbols",b)},h),g.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--info",d)},n.getTitle(a.label,!1)||""))};f.prototype._renderImage=function(a,d,b){var c,f=a.label,e=a.src,h=a.opacity;b=(c={},c["esri-legend__imagery-layer-image--stretched"]=b,c["esri-legend__symbol"]=!b,c);d={opacity:""+(null!=h?h:d.opacity)};return g.tsx("img",{alt:f,src:e,border:0,width:a.width,
height:a.height,class:this.classes(b),styles:d})};r([g.renderable(),q.property()],f.prototype,"activeLayerInfos",void 0);return f=r([q.subclass("esri.widgets.Legend.styles.Classic")],f)}(q.declared(x))});