// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.8/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper dojo/promise/all ../../../core/promiseUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators ./TiledLayerView3D ../../vectorTiles/SchemaHelper ../../vectorTiles/TileHandler ../../vectorTiles/renderers/Renderer".split(" "),function(r,t,g,e,h,k,l,d,m,n,p,q){return function(f){function a(b){return f.call(this)||this}g(a,f);a.prototype.initialize=function(){var b=this,c;c=this._getTileInfoSupportError(this.layer.compatibleTileInfo256,
this.layer.fullExtent);var a;c?this.addResolvingPromise(k.reject(c)):a=l.whenTrueOnce(this.view,"basemapTerrain.tilingSchemeLocked").then(function(){var a=b.view.basemapTerrain.tilingScheme,c=a.pixelSize[0];b.schemeHelper=new n(c,b.view.spatialReference.isWGS84);c=256===c?b.layer.compatibleTileInfo256:b.view.spatialReference.isWGS84?b.layer.compatibleTileInfo512:b.layer.tileInfo;if(a=b._getTileInfoCompatibilityError(c,a))throw a;b.tileInfo=c;b._updateMinMaxDataLevel()});var d;c=this._initializeTileHandler();
this.tileHandler=c[0];this.renderer=c[1];this._tileHandlerPromise=d=c[2];this.watch("layer.currentStyleInfo",function(){var a,c,e;b._tileHandlerPromise.isFulfilled()||b._tileHandlerPromise.cancel();a=b._initializeTileHandler();c=a[0];e=a[1];a=a[2];b._tileHandlerPromise=d;a.then(function(){var a=b.tileHandler;b.renderer=e;b.tileHandler=c;b.emit("data-changed");a.destroy()})});a=h([a,d]);this.addResolvingPromise(a)};a.prototype.destroy=function(){this.renderer=null;this.tileHandler.destroy();this.tileHandler=
null};a.prototype._initializeTileHandler=function(){var a=new p(this.layer,function(){},1),c=new q,d=a.start();d.then(function(){c.initialize(a.spriteMosaic,a.glyphMosaic,!1)});return[a,c,d]};e([d.property({aliasOf:"layer.fullExtent"})],a.prototype,"fullExtent",void 0);e([d.property()],a.prototype,"layer",void 0);e([d.property()],a.prototype,"updatingPercentageValue",void 0);return a=e([d.subclass("esri.views.3d.layers.VectorTileLayerView3D")],a)}(d.declared(m))});