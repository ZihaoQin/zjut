// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.8/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/accessorSupport/decorators ../../../../geometry/Point ../../lib/glMatrix ../mathUtils ../PropertiesPool ./PointOfInterest".split(" "),function(f,k,p,h,g,q,d,r,t,u){Object.defineProperty(k,"__esModule",{value:!0});var v=Array;f=function(f){function b(a){a=f.call(this,a)||this;a.propertiesPool=new t.default({locationOnSurface:q,renderLocationOnSurface:v},a);a.centerOnSurface=
null;return a}p(b,f);Object.defineProperty(b.prototype,"locationOnSurface",{get:function(){var a=this.propertiesPool.get("locationOnSurface");this.renderCoordsHelper.fromRenderCoords(this.renderLocationOnSurface,a,this.state.spatialReference);return a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"renderLocationOnSurface",{get:function(){var a=this.centerOnSurface.renderLocation,c=this.renderCoordsHelper,b=this.calculateScreenHorizontalEdgeOnSurface(w);d.vec3d.subtract(a,this.state.camera.eye,
l);d.vec3d.normalize(l);c.worldUpAtPosition(a,n);var e=Math.abs(Math.acos(d.vec3d.dot(n,l))-.5*Math.PI),c=this.propertiesPool.get("renderLocationOnSurface"),e=1-r.clamp(e/(.5*Math.PI),0,1);d.vec3d.lerp(a,b,e*e*e,c);return c},enumerable:!0,configurable:!0});b.prototype.update=function(a){};b.prototype.forceUpdate=function(){};b.prototype.hasPendingUpdates=function(){return this.centerOnSurface.hasPendingUpdates()};b.prototype.calculateScreenHorizontalEdgeOnSurface=function(a){var c=this.state.camera,
b=this.renderCoordsHelper.getAltitude(this.centerOnSurface.renderLocation),e=this.renderCoordsHelper.getAltitude(c.eye)>=b?c.padding[2]:c.fullHeight-c.padding[0];c.unprojectPoint([c.padding[3]+c.width/2,e,.5],m);e=d.vec3d.normalize(d.vec3d.subtract(m,c.eye,m));this.renderCoordsHelper.intersectManifold(c.eye,e,b,a)||(d.vec3d.set(c.eye,a),this.renderCoordsHelper.setAltitude(b,a));return a};h([g.property({constructOnly:!0})],b.prototype,"centerOnSurface",void 0);h([g.property({readOnly:!0,dependsOn:["renderLocationOnSurface"]})],
b.prototype,"locationOnSurface",null);h([g.property({readOnly:!0,dependsOn:["centerOnSurface.renderLocation"]})],b.prototype,"renderLocationOnSurface",null);return b=h([g.subclass("esri.views.3d.support.CenterOnSurface")],b)}(g.declared(u.PointOfInterest));k.Focus=f;var l=d.vec3d.create(),n=d.vec3d.create(),m=d.vec3d.create(),w=d.vec3d.create();k.default=f});