// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.8/esri/copyright.txt for details.
//>>built
define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper ../request ../core/accessorSupport/decorators ../geometry/SpatialReference ./Task ./support/AddressCandidate".split(" "),function(x,y,u,g,l,n,d,v,w,m){return function(p){function b(a){a=p.call(this,a)||this;a.categories=null;a.countryCode=null;a.outSpatialReference=null;a.url=null;return a}u(b,p);b.prototype.addressToLocations=function(a,c){var e=a.address,k=a.categories,
f=a.countryCode,q=a.distance,b=a.forStorage,h=a.location,d=a.magicKey,g=a.maxLocations,m=a.outFields;a=a.searchExtent;var p=h?h.clone().normalize():null,r=a?a.shiftCentralMeridian():null,t=this.outSpatialReference,h=this.parsedUrl;a=this.requestOptions;k={f:"json",outSR:t?JSON.stringify(t.toJSON()):null,outFields:m?m.join(","):null,searchExtent:r?JSON.stringify(r.toJSON()):null,category:k?k.join(","):null,countryCode:f||null,magicKey:d||null,distance:q||null,location:p,maxLocations:g||null,forStorage:b||
null};e={query:this._encode(l({},h.query,e,k)),callbackParamName:"callback"};c=l({},a,c,e);return n(h.path+"/findAddressCandidates",c).then(this._handleAddressToLocationsResponse)};b.prototype.suggestLocations=function(a,c){var e=this.parsedUrl,k=this.requestOptions,f=a.location,b=a.searchExtent,f=f?f.clone().normalize():null,b=b?b.shiftCentralMeridian():null;a={f:"json",text:a.text,maxSuggestions:a.maxSuggestions,searchExtent:b?JSON.stringify(b.toJSON()):null,category:a.categories?a.categories.join(","):
null,countryCode:a.countryCode||null,location:f,distance:a.distance||null};a={query:this._encode(l({},e.query,a)),callbackParamName:"callback"};c=l({},k,c,a);return n(e.path+"/suggest",c).then(this._handleSuggestLocationsResponse)};b.prototype.addressesToLocations=function(a,c){var b=this.outSpatialReference,k=this.parsedUrl,f=this.requestOptions,q=a.addresses,d=a.categories;a=a.countryCode;var h=[];Array.isArray(q)&&q.forEach(function(a){h.push({attributes:a})});b={category:d?d.join(","):null,sourceCountry:a||
null,addresses:JSON.stringify({records:h}),f:"json",outSR:b?JSON.stringify(b):null};b={query:this._encode(l({},k.query,b)),callbackParamName:"callback"};c=l({},f,c,b);return n(k.path+"/geocodeAddresses",c).then(this._handleAddressesToLocationsResponse)};b.prototype.locationToAddress=function(a,b,e){var c=a?a.clone().normalize():null,f="undefined"!==typeof c,d="undefined"!==typeof b&&f,g=this.outSpatialReference;a=this.parsedUrl;var h=this.requestOptions;b={outSR:g?JSON.stringify(g.toJSON()):null,
location:f?JSON.stringify(c.toJSON()):null,distance:d?b:null,f:"json"};b={query:this._encode(l({},a.query,b)),callbackParamName:"callback"};e=l({},h,e,b);return n(a.path+"/reverseGeocode",e).then(this._handleLocationToAddressResponse)};b.prototype._handleAddressToLocationsResponse=function(a){a=a.data;if(!a)return[];var b=a.candidates,e=a.spatialReference;return b?b.map(function(a){if(a){var b=a.extent,c=a.location,d=b?b&&"number"===typeof b.xmin&&"number"===typeof b.ymin&&"number"===typeof b.xmax&&
"number"===typeof b.ymax:!0;if(c&&"number"===typeof c.x&&"number"===typeof c.x&&d)return b&&(b.spatialReference=e),c.spatialReference=e,m.fromJSON(a)}}):[]};b.prototype._handleSuggestLocationsResponse=function(a){return(a=a.data)?a.suggestions||[]:[]};b.prototype._handleAddressesToLocationsResponse=function(a){a=a.data;if(!a)return[];var b=a.locations,d=a.spatialReference;return b?b.map(function(a){var b=a.location;b&&(b.spatialReference=d);return m.fromJSON(a)}):[]};b.prototype._handleLocationToAddressResponse=
function(a){if(a=a.data){var b=a.address;return m.fromJSON({address:b&&b.Match_addr||"",attributes:b||{},location:a.location,score:100})}};g([d.property()],b.prototype,"categories",void 0);g([d.property()],b.prototype,"countryCode",void 0);g([d.property({type:v})],b.prototype,"outSpatialReference",void 0);g([d.property()],b.prototype,"url",void 0);return b=g([d.subclass("esri.tasks.Locator")],b)}(d.declared(w))});