// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.8/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/Logger ./CIMSymbolDrawHelper ./SDFHelper ../../../vectorTiles/GeometryUtils".split(" "),function(h,k,r,n,t,p){Object.defineProperty(k,"__esModule",{value:!0});var q=r.getLogger("esri/views/2d/engine/webgl/CIMSymbolHelper");h=function(){function g(){}g.getEnvelope=function(d){if("CIMPointSymbol"!==d.type)return null;var a=new n.EnvDrawHelper;a.drawSymbol(d,{type:"point",x:0,y:0});return a.envelope()};g.rasterize=function(d,a){var b=this.getEnvelope(a);if(!b||
0>=b.width||0>=b.height)return[null,0,0,0,0];var c=96/72,e=(b.x+.5*b.width)*c,f=-(b.y+.5*b.height)*c;d.width=b.width*c+2;d.height=b.height*c+2;b=d.getContext("2d");c=n.Transformation.createScale(c,-c);c.translate(.5*d.width-e,.5*d.height-f);(new n.CanvasDrawHelper(b,c)).drawSymbol(a,{type:"point",x:0,y:0});a=b.getImageData(0,0,d.width,d.height);a=new Uint8Array(a.data);for(b=0;b<a.length;b+=4)c=a[b+3]/255,a[b]*=c,a[b+1]*=c,a[b+2]*=c;return[a,d.width,d.height,e/d.width,f/d.height]};g.fromSimpleMarker=
function(d){var a,b,c=d.style;if("circle"===c||"esriSMSCircle"===c){a=Math.acos(.995);b=Math.ceil(p.C_PI/a/4);0===b&&(b=1);a=p.C_PI_BY_2/b;b*=4;c=[];c.push([50,0]);for(var e=1;e<b;e++)c.push([50*Math.cos(e*a),-50*Math.sin(e*a)]);c.push([50,0]);a={rings:[c]};b={xmin:-50,ymin:-50,xmax:50,ymax:50}}else if("cross"===c||"esriSMSCross"===c)a=0,a={rings:[[[a,50],[a,a],[50,a],[50,-a],[a,-a],[a,-50],[-a,-50],[-a,-a],[-50,-a],[-50,a],[-a,a],[-a,50],[a,50]]]},b={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("diamond"===
c||"esriSMSDiamond"===c)a={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},b={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("square"===c||"esriSMSSquare"===c)a={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},b={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("x"===c||"esriSMSX"===c)a=0,a={rings:[[[0,a],[50-a,50],[50,50-a],[a,0],[50,a-50],[50-a,-50],[0,-a],[a-50,-50],[-50,a-50],[-a,0],[-50,50-a],[a-50,50],[0,a]]]},b={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("triangle"===c||"esriSMSTriangle"===
c)b=2/3*100,c=b-100,a={rings:[[[-57.735026918962575,c],[0,b],[57.735026918962575,c],[-57.735026918962575,c]]]},b={xmin:-57.735026918962575,ymin:c,xmax:57.735026918962575,ymax:b};var f;a&&b&&(f=[{type:"CIMSolidFill",enable:!0,color:d.color}],d.outline&&f.push({type:"CIMSolidStroke",enable:!0,width:d.outline.width,color:d.outline.color}),f={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:d.angle,size:d.size,offsetX:d.xoffset,offsetY:d.yoffset,frame:b,markerGraphics:[{type:"CIMMarkerGraphic",
geometry:a,symbol:{type:"CIMPolygonSymbol",symbolLayers:f}}]}]});return f};return g}();k.CIMSymbolHelper=h;h=function(){function g(){}g.rasterizeSimpleFill=function(d,a){"solid"!==a&&"none"!==a&&"esriSFSSolid"!==a&&"esriSFSNull"!==a||console.error("Unexpected: style does not require rasterization");d.width=8;d.height=8;var b=d.getContext("2d");b.strokeStyle="#FFFFFF";b.beginPath();if("vertical"===a||"cross"===a||"esriSFSCross"===a||"esriSFSVertical"===a)b.moveTo(0,0),b.lineTo(0,8);if("horizontal"===
a||"cross"===a||"esriSFSCross"===a||"esriSFSHorizontal"===a)b.moveTo(0,0),b.lineTo(8,0);if("forward-diagonal"===a||"diagonal-cross"===a||"esriSFSDiagonalCross"===a||"esriSFSForwardDiagonal"===a)b.moveTo(0,0),b.lineTo(8,8);if("backward-diagonal"===a||"diagonal-cross"===a||"esriSFSBackwardDiagonal"===a||"esriSFSDiagonalCross"===a)b.moveTo(8,0),b.lineTo(0,8);b.stroke();a=b.getImageData(0,0,d.width,d.height);a=new Uint8Array(a.data);for(var c=0;c<a.length;c+=4)b=a[c+3]/255,a[c]*=b,a[c+1]*=b,a[c+2]*=b;
return[a,d.width,d.height]};g.rasterizeSimpleLine=function(d,a){var b;switch(a){case "dash":case "esriSLSDash":b=[3,2];break;case "dash-dot":case "esriSLSDashDot":b=[2,2,0,2];break;case "dot":case "esriSLSDot":b=[0,3];break;case "long-dash":case "esriSLSLongDash":b=[6,3];break;case "long-dash-dot":case "esriSLSLongDashDot":b=[6,3,0,3];break;case "long-dash-dot-dot":case "esriSLSDashDotDot":b=[2,2,0,2,0,2];break;case "short-dash":case "esriSLSShortDash":b=[2,2];break;case "short-dash-dot":case "esriSLSShortDashDot":b=
[2,2,0,2];break;case "short-dash-dot-dot":case "esriSLSShortDashDotDot":b=[2,2,0,2,0,2];break;case "short-dot":case "esriSLSShortDot":b=[0,2];break;case "solid":case "esriSLSSolid":case "none":q.error("Unexpected: style does not require rasterization");b=[0,0];break;default:q.error("Tried to rasterize SLS, but found an unexpected style: "+a+"!"),b=[0,0]}a=d=0;for(var c=b;a<c.length;a++){var e=c[a];d+=e}d*=16;c=31*d;a=new Float32Array(c);for(e=0;e<c;++e)a[e]=257;for(var f=c=.5,g=!0,h=0;h<b.length;h++){for(var e=
b[h],c=f,f=f+16*e,l=c;l<f;){for(var m=.5;31>m;){var e=(31-m+1.5)*d+l-.5,k=(m-15.5)*(m-15.5);a[e]=g?k:Math.min((l-c)*(l-c)+k,(l-f)*(l-f)+k);m++}l++}g=!g}b=a.length;c=new Uint8Array(4*b);for(e=0;e<b;++e)t.packFloat(Math.sqrt(a[e])/15,c,4*e);return[c,d,31]};return g}();k.SymbolHelper=h});