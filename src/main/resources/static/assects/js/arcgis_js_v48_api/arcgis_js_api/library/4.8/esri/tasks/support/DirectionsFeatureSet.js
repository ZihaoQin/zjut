// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.8/esri/copyright.txt for details.
//>>built
define("../../geometry/Extent ../../geometry/Point ../../geometry/Polyline ../../geometry/SpatialReference ./FeatureSet ../../Graphic".split(" "),function(t,u,v,w,x,g){return x.createSubclass({declaredClass:"esri.tasks.support.DirectionsFeatureSet",properties:{geometryType:"esriGeometryPolyline",extent:{type:t,json:{read:{source:"summary.envelope"}}},features:{value:null,json:{read:function(a,e){(a||[]).forEach(function(a){this._decompressFeatureGeometry(a,e.summary.envelope.spatialReference)},this);
var h=w.fromJSON(e.spatialReference);return a.map(function(a){var b=g.fromJSON(a),m=a.geometry&&a.geometry.spatialReference;b.geometry&&!m&&(b.geometry.spatialReference=h);b.strings=a.strings;b.events=(a.events||[]).map(function(b){var d=new g({geometry:new u({x:b.point.x,y:b.point.y,z:b.point.z,hasZ:void 0!==b.point.z,spatialReference:a.geometry&&a.geometry.spatialReference}),attributes:{ETA:b.ETA,arriveTimeUTC:b.arriveTimeUTC}});d.strings=b.strings;return d});return b})}}},mergedGeometry:{value:null,
readOnly:!0,dependsOn:["features","extent.spatialReference"],get:function(){if(!this.features)return null;var a=this.features.map(function(a){return a.geometry}),e=this.get("extent.spatialReference");return this._mergePolylinesToSinglePath(a,e)}},routeId:null,routeName:null,strings:{value:null,readOnly:!0,dependsOn:["features"],get:function(){return this.features.map(function(a){return a.strings})}},totalDriveTime:{value:null,json:{read:{source:"summary.totalDriveTime"}}},totalLength:{value:null,
json:{read:{source:"summary.totalLength"}}},totalTime:{value:null,json:{read:{source:"summary.totalTime"}}}},_decompressFeatureGeometry:function(a,e){a.geometry=this._decompressGeometry(a.compressedGeometry,e)},_decompressGeometry:function(a,e){var h=0,p=0,b=0,m=0,q=[],d,f,n,g,r,c=0,k=0,l=0;(a=a.match(/((\+|\-)[^\+\-\|]+|\|)/g))||(a=[]);0===parseInt(a[c],32)?(c=2,d=parseInt(a[c],32),c++,n=parseInt(a[c],32),c++,d&1&&(k=a.indexOf("|")+1,g=parseInt(a[k],32),k++),d&2&&(l=a.indexOf("|",k)+1,r=parseInt(a[l],
32),l++)):(n=parseInt(a[c],32),c++);for(;c<a.length&&"|"!==a[c];)d=parseInt(a[c],32)+h,c++,h=d,f=parseInt(a[c],32)+p,c++,p=f,d=[d/n,f/n],k&&(f=parseInt(a[k],32)+b,k++,b=f,d.push(f/g)),l&&(f=parseInt(a[l],32)+m,l++,m=f,d.push(f/r)),q.push(d);return{paths:[q],hasZ:0<k,hasM:0<l,spatialReference:e}},_mergePolylinesToSinglePath:function(a,e){var h=[];(a||[]).forEach(function(a){a.paths.forEach(function(a){h=h.concat(a)})});var g=[],b=[0,0];h.forEach(function(a){if(a[0]!==b[0]||a[1]!==b[1])g.push(a),b=
a});return new v({paths:[g]},e)}})});