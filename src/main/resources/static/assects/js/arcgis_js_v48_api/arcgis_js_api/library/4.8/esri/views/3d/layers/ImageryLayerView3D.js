// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.8/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../core/watchUtils ../../../core/accessorSupport/decorators ./DynamicLayerView3D".split(" "),function(m,n,h,g,k,e,l){return function(f){function c(){return null!==f&&f.apply(this,arguments)||this}h(c,f);c.prototype.initialize=function(){var a=this;this.handles.add([k.whenOnce(this.view.basemapTerrain,"ready",function(){return a.initializeMaximumDataResolution()}),this.handles.add(this.layer.watch("exportImageServiceParameters.version",
function(b){a.doRefresh()}))])};c.prototype.initializeMaximumDataResolution=function(){var a=this.view.basemapTerrain.spatialReference,b=this.layer.fullExtent;b&&a.equals(b.spatialReference)&&(this.maximumDataResolution={x:this.layer.pixelSizeX,y:this.layer.pixelSizeY})};c.prototype.processResult=function(a,b){a.image=document.createElement("canvas");a.pixelData=b.pixelData;var d=a.image;b=d.getContext("2d");a=this.layer.applyFilter(a.pixelData).pixelBlock;d.width=a.width;d.height=a.height;d=b.createImageData(a.width,
a.height);a=a.getAsRGBA();d.data.set(a);b.putImageData(d,0,0)};c.prototype.updateImage=function(a){if(a&&a.pixelData){var b=a.image,d=b.getContext("2d");a=this.layer.applyFilter(a.pixelData).pixelBlock;var c=d.createImageData(a.width,a.height),e=a.getAsRGBA();b.width=a.width;b.height=a.height;c.data.set(e);d.putImageData(c,0,0);return!0}return!1};g([e.property()],c.prototype,"layer",void 0);return c=g([e.subclass("esri.views.3d.layers.ImageryLayerView3D")],c)}(e.declared(l))});