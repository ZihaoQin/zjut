// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.8/esri/copyright.txt for details.
//>>built
define("require exports ../../../symbols ../../../core/numberUtils ../../../symbols/support/symbolUtils ./utils".split(" "),function(L,n,w,p,u,C){function D(a,b){var c=null,e=null;if("simple"===a.type)c=a.symbol;else if("unique-value"===a.type||"class-breaks"===a.type)c=(c=(a=a.classBreakInfos||a.uniqueValueInfos)&&a[0])&&c.symbol,e=1<a.length;if(!c||E(c))return null;c=c.clone();if(b||e)-1<c.type.indexOf("3d")?F(c):(b=c,-1!==b.type.indexOf("line")?b.color=t:(b.color=z,"simple-marker"===b.type&&(b.outline=
{color:t,width:1.5})));return c}function E(a){if(a)return w.isSymbol3D(a)?a.symbolLayers?a.symbolLayers.some(function(a){return a&&"fill"===a.type}):!1:-1!==a.type.indexOf("fill")}function F(a){u.isVolumetricSymbol(a)||("line-3d"===a.type?a.symbolLayers.forEach(function(a){a.material={color:t}}):a.symbolLayers.forEach(function(a){"icon"!==a.type||a.resource&&a.resource.href?a.material={color:G}:(a.material={color:z},a.outline={color:t,size:1.5})}))}function H(a,b,c,e){var f=a.getSizeRangeAtScale(b,
e),k=f&&I(f);if(f||k){for(var d=k.map(function(a){var c=f.minSize,e=f.maxSize,d=b.minDataValue,g=b.maxDataValue;return a<=c?d:a>=e?g:(a-c)/(e-c)*(g-d)+d}),d=p.round(d),l=1;l<d.length-1;l++){var g=J(a,b,c,d[l],d[l-1],e);g&&(d[l]=g[0],k[l]=g[1])}return d}}function I(a){var b=a.minSize;a=(a.maxSize-b)/4;for(var c=[],e=0;5>e;e++)c.push(b+a*e);return c}function J(a,b,c,e,f,k){var d,l=v(a,b,c,e,k);f=v(a,b,c,f,k);var g=p.numDigits(e),q=g.fractional,h=g.integer,r=g=null;0<e&&1>e&&(g=Math.pow(10,q),e*=g,h=
p.numDigits(e).integer);for(q=h-1;0<=q;q--){var m=Math.pow(10,q),h=Math.floor(e/m)*m,m=Math.ceil(e/m)*m;null!=g&&(h/=g,m/=g);d=(h+m)/2;d=p.round([h,d,m],{indexes:[1]});d=d[1];var A=v(a,b,c,h,k),B=v(a,b,c,m,k),n=v(a,b,c,d,k),t=p.percentChange(l,A,f,null),u=p.percentChange(l,B,f,null),w=p.percentChange(l,n,f,null),x=20>=t.previous,y=20>=u.previous;x&&y&&(t.previous<=u.previous?(x=!0,y=!1):(y=!0,x=!1));x?r=[h,A]:y?r=[m,B]:20>=w.previous&&(r=[d,n]);if(r)break}return r}function v(a,b,c,e,f){return a.getSize(e,
{sizeInfo:b,scale:f,shape:-1!==c.type.indexOf("marker-symbol")?c.style:null})}function K(a,b){a=a.clone();if(w.isSymbol3D(a))u.isVolumetricSymbol(a)||a.symbolLayers.forEach(function(a){"fill"!==a.type&&(a.size=b)});else if("esri.symbols.SimpleMarkerSymbol"===a.declaredClass)a.size=b;else if("esri.symbols.PictureMarkerSymbol"===a.declaredClass){var c=a.width,e=a.height;a.height=b;a.width=c/e*b}else"esri.symbols.SimpleLineSymbol"===a.declaredClass?a.width=b:"esri.symbols.TextSymbol"===a.declaredClass&&
a.font&&(a.font.size=b);return a}Object.defineProperty(n,"__esModule",{value:!0});n.REAL_WORLD_MAX_SIZE=30;n.REAL_WORLD_MIN_SIZE=12;var z=[255,255,255],G=[200,200,200],t=[128,128,128];n.getRampStops=function(a,b,c,e){var f=b.legendOptions,f=f&&f.customValues,k=D(a,c);c=null!=b.minSize&&null!=b.maxSize;var d=b.stops&&1<b.stops.length,l=!!b.target;if(k&&(f||c||d&&!l)){var g=u.isVolumetricSymbol(k),q=null,h=null,r=null,h=g&&!d?[b.minDataValue,b.maxDataValue]:f||H(a,b,k,e);!h&&d&&(h=b.stops.map(function(a){return a.value}),
(q=b.stops.some(function(a){return!!a.label}))&&(r=b.stops.map(function(a){return a.label})));f=!g||h&&2===h.length;if(!h||!f)return null;var m=[n.REAL_WORLD_MIN_SIZE,n.REAL_WORLD_MAX_SIZE];return h.map(function(c,d){var f=g?m[d]:v(a,b,k,c,e),l=K(k,f);d=q?r[d]:C.getLabelPrefix(d,h.length-1)+p.format(c);return{value:c,symbol:l,label:d,size:f}}).reverse()}}});