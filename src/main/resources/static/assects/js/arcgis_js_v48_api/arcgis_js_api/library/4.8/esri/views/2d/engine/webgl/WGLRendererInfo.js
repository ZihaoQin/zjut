// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.8/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/screenUtils ../../../../geometry/support/scaleUtils ../../../../renderers/support/utils ./color ./Utils".split(" "),function(u,v,g,q,r,t,n){function p(e,a){var d=a.length;if(e<a[0].value||1===d)return a[0].size;for(var b=1;b<d;b++)if(e<a[b].value)return a[b-1].size+(e-a[b-1].value)/(a[b].value-a[b-1].value)*(a[b].size-a[b-1].size);return a[d-1].size}return function(){function e(){this.symbolLevels=[];this.vvColorValues=new Float32Array(8);this.vvColors=new Float32Array(32);
this.vvOpacityValues=new Float32Array(8);this.vvOpacities=new Float32Array(8);this.vvSizeMinMaxValue=new Float32Array(4);this.vvSizeFieldStopsValues=new Float32Array(6);this.vvSizeFieldStopsSizes=new Float32Array(6);this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1};this.symbolLevels.push(0)}Object.defineProperty(e.prototype,"vvMaterialParameters",{get:function(){return this._vvMaterialParameters},enumerable:!0,configurable:!0});
Object.defineProperty(e.prototype,"heatmapParameters",{get:function(){return this._heatmapParameters},enumerable:!0,configurable:!0});e.prototype.updateHeatmapParameters=function(a){var d=a.blurRadius,b=Math.round(4.5*a.blurRadius),f=2*b+1;this._heatmapParameters||(this._heatmapParameters={radius:d,blurRadius:b,kernelSize:f,refreshIntensityKernel:!0,intensityKernel:null,color:null,maxPixelIntensity:a.maxPixelIntensity,minPixelIntensity:a.minPixelIntensity});for(var c=this._heatmapParameters,e=a.colorStops,
h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m,g=0;16>g;g++){var k=e[Math.min(g,e.length-1)];h[g]=k.ratio;m=4*g;l[m+0]=k.color[0]/255;l[m+1]=k.color[1]/255;l[m+2]=k.color[2]/255;l[m+3]=1<k.color[3]?k.color[3]/255:k.color[3];t.premultiplyAlpha(l,m,!0)}c.color={values:h,colors:l,refreshColorRamp:!0};1E-6<Math.abs(c.radius-a.radius)&&(c.radius=d,c.blurRadius=b,c.kernelSize=f,c.refreshIntensityKernel=
!0);c.maxPixelIntensity=a.maxPixelIntensity;c.minPixelIntensity=a.minPixelIntensity};e.prototype.updateVisualVariables=function(a,d){var b=this._vvMaterialParameters;b.vvOpacityEnabled=!1;b.vvSizeEnabled=!1;b.vvColorEnabled=!1;b.vvRotationEnabled=!1;if(a){var f=a.size;if(f){b.vvSizeEnabled=!0;if(f.minMaxValue){var c=f.minMaxValue,e=void 0,h=void 0;n.isDefined(c.minSize)&&n.isDefined(c.maxSize)&&(n.isNumber(c.minSize)&&n.isNumber(c.maxSize)?(e=g.pt2px(c.minSize),h=g.pt2px(c.maxSize)):(h=d.scale,e=
g.pt2px(p(h,c.minSize.stops)),h=g.pt2px(p(h,c.maxSize.stops))));this.vvSizeMinMaxValue.set([c.minDataValue,c.maxDataValue,e,h])}f.scaleStops&&(this.vvSizeScaleStopsValue=g.pt2px(p(d.scale,f.scaleStops.stops)));f.unitValue&&(this.vvSizeUnitValueToPixelsRatio=q.getMetersPerUnitForSR(d.spatialReference)/r.meterIn[f.unitValue.unit]/d.resolution);f.fieldStops&&(this.vvSizeFieldStopsValues.set(f.fieldStops.values),this.vvSizeFieldStopsSizes.set(f.fieldStops.sizes))}if(d=a.color)b.vvColorEnabled=!0,this.vvColorValues.set(d.values),
this.vvColors.set(d.colors);if(d=a.opacity)b.vvOpacityEnabled=!0,this.vvOpacityValues.set(d.values),this.vvOpacities.set(d.opacities);if(a=a.rotation)b.vvRotationEnabled=!0,b.vvRotationType=a.type}};return e}()});