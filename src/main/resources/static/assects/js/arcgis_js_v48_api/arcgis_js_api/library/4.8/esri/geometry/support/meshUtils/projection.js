// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.8/esri/copyright.txt for details.
//>>built
define(["require","exports","../../../core/Logger","../../../views/3d/lib/glMatrix","../../../views/3d/support/projectionUtils"],function(v,h,u,g,k){function q(p,f,d,e,c,h){if(f){c=c.isWGS84;for(var l=0;l<f.length;l+=3){for(var b=0;3>b;b++)m[b]=e[l+b],n[b]=f[l+b];k.computeLinearTransformation(k.SphericalECEFSpatialReference,m,r,k.SphericalECEFSpatialReference);g.mat4d.toMat3(r,a);c?g.mat3d.multiplyVec3(a,n):(b=k.webMercator.y2lat(d[l+1]),b=Math.cos(b),0===p&&(b=1/b),a[0]*=b,a[1]*=b,a[2]*=b,a[3]*=
b,a[4]*=b,a[5]*=b,1===p&&g.mat3d.transpose(a),g.mat3d.multiplyVec3(a,n),g.vec3d.normalize(n));for(b=0;3>b;b++)h[l+b]=n[b]}return h}}Object.defineProperty(h,"__esModule",{value:!0});var t=u.getLogger("esri.geometry.support.meshUtils.normalProjection");h.projectNormalToECEF=function(p,a,d,e,c){return e.isWebMercator||e.isWGS84?q(0,p,a,d,e,c):(t.error("Cannot convert PCS spatial reference buffer to ECEF"),c)};h.projectNormalFromECEF=function(a,f,d,e,c){return e.isWebMercator||e.isWGS84?q(1,a,f,d,e,c):
(t.error("Cannot convert to PCS spatial reference buffer from ECEF"),c)};h.projectToECEF=function(a,f,d){k.bufferToBuffer(a,f,0,d,k.SphericalECEFSpatialReference,0,a.length/3);return d};h.projectFromECEF=function(a,f,d){k.bufferToBuffer(a,k.SphericalECEFSpatialReference,0,f,d,0,a.length/3);return f};h.transformBufferInPlace=function(a,f,d){void 0===d&&(d=!1);if(a)for(var e=0;e<a.length;e+=3){for(var c=0;3>c;c++)m[c]=a[e+c];g.mat4d.multiplyVec3(f,m);d&&g.vec3d.normalize(m);for(c=0;3>c;c++)a[e+c]=m[c]}};
var m=g.vec3d.create(),n=g.vec3d.create(),r=g.mat4d.create(),a=g.mat3d.create()});