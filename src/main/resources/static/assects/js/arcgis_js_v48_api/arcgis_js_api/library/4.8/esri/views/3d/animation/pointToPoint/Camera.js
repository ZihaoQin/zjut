// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.8/esri/copyright.txt for details.
//>>built
define(["require","exports","../../lib/glMatrix","../../support/mathUtils"],function(v,w,x,r){Object.defineProperty(w,"__esModule",{value:!0});var t=r.angle,u=r.lerp,A=r.slerp,c=x.vec3d,k=x.mat3d,g=c.create(),l=c.create(),h=c.create(),d=c.create(),m=c.create(),p=c.create(),n=c.createFrom(0,0,1),y=c.createFrom(0,1,0),q=c.createFrom(1,0,0),z=k.create();v=function(){function f(a){void 0===a&&(a="global");this.viewingMode=a;this.center=c.create();this.distance=this.yaw=this.pitch=0;this.lookAtDirection=
c.create(y)}f.prototype.pixelsPerPanAtZoom=function(a){return this.size/2/(this._zoomToPanScale*a)};f.prototype.zoomAtPixelsPerPan=function(a){return this.size/2/(this._zoomToPanScale*a)};f.prototype.pixelsPerRotateAtZoom=function(a){return this.size/2/Math.max(Math.cos(Math.abs(this.pitch)),.5)};f.prototype.compareTo=function(a,b){b||(b={pan:0,rotate:0,sourceZoom:0,targetZoom:0});if("global"===this.viewingMode){var e=c.length(this.center),d=c.length(a.center),e=(e+d)/2;b.pan=t(this.center,a.center)*
e}else b.pan=c.dist(this.center,a.center);e=Math.abs(a.yaw-this.yaw);e>=Math.PI&&(e=2*Math.PI-e);b.rotate=Math.max(e,Math.abs(a.pitch-this.pitch));b.sourceZoom=this.distance;b.targetZoom=a.distance;return b};f.prototype.interpolate=function(a,b,e){"global"===this.viewingMode?A(a.center,b.center,e.pan,this.center):c.lerp(a.center,b.center,e.pan,this.center);this.distance=u(a.distance,b.distance,e.zoom);this.pitch=u(a.pitch,b.pitch,e.rotate);a=a.yaw;b=b.yaw;Math.abs(b-a)>=Math.PI&&(a+=2*(a<b?1:-1)*
Math.PI);this.yaw=u(a,b,e.rotate)};f.prototype.copyFrom=function(a){c.set(a.center,this.center);this.pitch=a.pitch;this.yaw=a.yaw;this.distance=a.distance;c.set(a.lookAtDirection,this.lookAtDirection);this.size=a.size;this.copyFromCommon(a);this.viewingMode=a.viewingMode};f.prototype.copyFromRenderCamera=function(a){var b=this._lookAtOrientation(a.center,z);c.set(a.center,this.center);k.multiplyVec3(b,c.subtract(a.center,a.eye,d));k.multiplyVec3(b,a.up,m);this.distance=c.length(d);d[0]/=this.distance;
d[1]/=this.distance;d[2]/=this.distance;this.pitch=this._eyeUpToPitch(d,m);this.yaw=this._eyeUpToYaw(d,m);this.size=Math.sqrt(a.width*a.width+a.height*a.height);this.copyFromCommon(a)};f.prototype.copyFromCommon=function(a){this.fov=a.fov;this._zoomToPanScale=Math.atan(.5*this.fov)};f.prototype.copyToRenderCamera=function(a){var b=this._lookAtOrientation(this.center,z);k.transpose(b);this._axisAngleVec3(q,this.pitch-Math.PI/2,y,d);this._axisAngleVec3(n,this.yaw,d);this._axisAngleVec3(q,this.pitch-
Math.PI/2,n,m);this._axisAngleVec3(n,this.yaw,m);c.scale(d,this.distance);k.multiplyVec3(b,d);k.multiplyVec3(b,m);a.center=this.center;a.eye=c.subtract(this.center,d,d);a.up=m};f.prototype._axisAngleVec3=function(a,b,e,d){void 0===d&&(d=e);var f=Math.cos(b);b=Math.sin(b);c.scale(e,f,g);c.scale(c.cross(a,e,l),b);c.scale(a,(1-f)*c.dot(a,e),h);return c.add(c.add(g,l,d),h,d)};f.prototype._lookAtOrientation=function(a,b){this._upAtLookAt(a,h);c.normalize(c.cross(this.lookAtDirection,h,g));0===g[0]&&0===
g[1]&&0===g[2]&&c.set(q,g);c.normalize(c.cross(h,g,l));b||(b=k.create());b[0]=g[0];b[1]=l[0];b[2]=h[0];b[3]=g[1];b[4]=l[1];b[5]=h[1];b[6]=g[2];b[7]=l[2];b[8]=h[2];return b};f.prototype._upAtLookAt=function(a,b){return"local"===this.viewingMode?c.set(n,b):c.normalize(a,b)};f.prototype._eyeUpToPitch=function(a,b){return Math.PI-t(n,a)};f.prototype._eyeUpToYaw=function(a,b){.5>Math.abs(b[2])?(c.set(b,p),0<a[2]&&c.scale(p,-1)):c.set(a,p);return t(q,c.normalize(c.cross(p,n,l)),n)};return f}();w.default=
v});