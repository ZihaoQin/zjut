// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.8/esri/copyright.txt for details.
//>>built
define("require exports ../../../geometry/Point ../../../geometry/support/aaBoundingRect ../lib/glMatrix ../support/earthUtils ../webgl-engine/lib/Selector".split(" "),function(y,l,v,w,f,n,x){function m(a,d){return a.renderCoordsHelper.fromRenderCoords(d,p,a.basemapTerrain.spatialReference)?a.basemapTerrain.getElevation(p)||0:0}function q(a,d,e,c){void 0===c&&(c=f.vec3d.create());var b=r[a.viewingMode];b||(b=new x(a.viewingMode),b.enableBackfacesTerrain=!a.state.isGlobal,b.enableInvisibleTerrain=
!0,r[a.viewingMode]=b);a._stage.pickRay(d,e,null,null,null,null,b);if((b=b.getMinResult())&&b.getIntersectionPoint(c))return c;var b=f.vec3d.direction(e,d,h),g="global"===a.viewingMode;a.renderCoordsHelper.intersectManifold(d,b,0,c)?g&&0>a.renderCoordsHelper.getAltitude(d)&&(b=m(a,d),g=a.stateManager.constraintsManager.nearFarHeuristic.compute(d,c,a.dataExtent,b),a=g.distance,b=g.maxFarNearRatio,g=g.minNearDistance,a=a/b>g?a:g*b,f.vec3d.dist2(d,c)>a&&t(d,e,!0,c)):g?t(d,e,!1,c):e!==c&&f.vec3d.set(e,
c);return c}function t(a,d,e,c){var b=f.vec3d.dot(a,a)-n.earthRadius*n.earthRadius;e&&(b=Math.abs(b));e=0<b?Math.sqrt(b)/3:1;f.vec3d.subtract(d,a,c);f.vec3d.scale(c,e/f.vec3d.length(c),c);f.vec3d.add(c,a)}Object.defineProperty(l,"__esModule",{value:!0});l.eyeWithinExtent=function(a,d,e,c){return a.renderCoordsHelper.fromRenderCoords(d.eye,u,c)&&w.containsPoint(e,u)};l.surfaceElevationBelowEye=function(a,d){return m(a,d.eye)};l.surfaceElevationBelowRenderPoint=m;l.cameraOnContentAlongViewDirection=
function(a,d,e,c){var b=a.state.camera.copy();d&&(b.eye=d);e&&(b.center=e);c&&(b.up=c);q(a,b.eye,b.center,k);e=a.state.constraints;c=e.minimumPoiDistance;f.vec3d.dist2(b.eye,k)<c&&(d=e.collision.enabled,f.vec3d.set(b.viewForward,h),f.vec3d.scale(h,c),d?f.vec3d.subtract(k,h,b.eye):f.vec3d.add(b.eye,h,k),a=a.renderCoordsHelper,c=a.getAltitude(b.eye),e=e.collision.elevationMargin,d&&c<e&&(f.vec3d.subtract(k,b.eye,h),a.setAltitude(e,b.eye),f.vec3d.add(b.eye,h,k)));b.center=k;return b};l.contentAlongViewDirection=
q;var r={},u=f.vec3d.create(),k=f.vec3d.create(),p=new v,h=f.vec3d.create()});