// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.8/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/Logger ./projection ../../../views/3d/lib/glMatrix ../../../views/3d/support/projectionUtils".split(" "),function(A,g,w,p,e,h){function q(b,d,a){void 0===a&&(a=x);if(b)for(e.mat4d.identity(m),e.mat4d.rotate(m,d[3],d),d=0;d<b.length;d+=3){for(var c=0;3>c;c++)r[c]=b[d+c]-a[c];e.mat4d.multiplyVec3(m,r);for(c=0;3>c;c++)b[d+c]=r[c]+a[c]}}Object.defineProperty(g,"__esModule",{value:!0});var y=w.getLogger("esri.geometry.support.meshUtils.rotate");g.rotate=function(b,
d,a){if(b.vertexAttributes&&b.vertexAttributes.position&&0!==d[3]){var c=b.spatialReference,f=a&&a.origin||b.extent.center;if(c.isWGS84||c.isWebMercator&&(!a||!1!==a.geographic)){a=b.spatialReference;c=t;h.pointToVector(f,c,h.SphericalECEFSpatialReference)||h.pointToVector(b.extent.center,c,h.SphericalECEFSpatialReference);var f=b.vertexAttributes.position,l=b.vertexAttributes.normal,n=new Float64Array(f.length),g=new Float32Array(l?l.length:0);h.computeLinearTransformation(h.SphericalECEFSpatialReference,
c,m,h.SphericalECEFSpatialReference);e.mat4d.toMat3(m,u);var k=e.mat3d.multiplyVec3(u,d,z);k[3]=d[3];p.projectToECEF(f,a,n);l&&p.projectNormalToECEF(l,f,n,a,g);q(n,k,c);p.projectFromECEF(n,f,a);l&&(q(g,k),p.projectNormalFromECEF(g,f,n,a,l))}else a=t,h.pointToVector(f,a,b.spatialReference)||(c=b.extent.center,a[0]=c.x,a[1]=c.y,a[2]=c.z,y.error("Failed to project specified origin (wkid:"+f.spatialReference.wkid+") to mesh spatial reference (wkid:"+b.spatialReference.wkid+"). Using mesh extent.center instead")),
q(b.vertexAttributes.position,d,a),q(b.vertexAttributes.normal,d);b.clearCache()}};g.axisAngleFrom=function(b,d,a){e.vec3d.set(b,a);a[3]=d;return a};g.axisAngleMultiply=function(b,d,a){e.quat4d.fromAngleAxis(b[3],b,k);e.quat4d.fromAngleAxis(d[3],d,v);e.quat4d.multiply(v,k,k);e.quat4d.toAngleAxis(k,a);return a};var r=e.vec3d.create(),z=e.vec4d.create(),k=e.quat4d.create(),v=e.quat4d.create(),m=e.mat4d.create(),u=e.mat3d.create(),x=[0,0,0],t=[0,0,0]});