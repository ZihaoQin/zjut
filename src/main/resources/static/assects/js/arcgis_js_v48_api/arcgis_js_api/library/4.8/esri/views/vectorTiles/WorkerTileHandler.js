// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.8/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/2d/tiling/enums":function(){define(["require","exports"],function(n,a){Object.defineProperty(a,"__esModule",{value:!0});n=a.TileStatus||(a.TileStatus={});n[n.INITIALIZED=0]="INITIALIZED";n[n.NO_DATA=1]="NO_DATA";n[n.READY=2]="READY";n[n.MODIFIED=3]="MODIFIED";n[n.INVALID=4]="INVALID"})},"esri/views/vectorTiles/WorkerTile":function(){define("require exports dojo/Deferred ../../core/executeAsync ../../core/ObjectPool ../../core/promiseUtils ../2d/tiling/enums ./BackgroundBucket ./CircleBucket ./FillBucket ./GeometryUtils ./IndexMemoryBuffer ./LineBucket ./Placement ./SymbolBucket ./TileParser ./VertexMemoryBuffer".split(" "),
function(n,a,c,q,g,e,m,b,f,l,d,p,t,A,F,u,w){return function(){function a(){this.rotation=0;this.status=m.TileStatus.INITIALIZED;this._symbolBuckets=[];this.placementEngine=new A.PlacementEngine;this.fillVertexBuffer=new w.FillVertexBuffer(!1);this.fillDDVertexBuffer=new w.FillVertexBuffer(!0);this.fillIndexBuffer=new p.TriangleIndexBuffer;this.outlineVertexBuffer=new w.OutlineVertexBuffer(!1);this.outlineDDVertexBuffer=new w.OutlineVertexBuffer(!0);this.outlineIndexBuffer=new p.TriangleIndexBuffer;
this.lineVertexBuffer=new w.LineVertexBuffer(!1);this.lineDDVertexBuffer=new w.LineVertexBuffer(!0);this.lineIndexBuffer=new p.TriangleIndexBuffer;this.iconVertexBuffer=new w.SymbolVertexBuffer(!1);this.iconDDVertexBuffer=new w.SymbolVertexBuffer(!0);this.iconIndexBuffer=new p.TriangleIndexBuffer;this.textVertexBuffer=new w.SymbolVertexBuffer(!1);this.textDDVertexBuffer=new w.SymbolVertexBuffer(!0);this.textIndexBuffer=new p.TriangleIndexBuffer;this.circleVertexBuffer=new w.CircleVertexBuffer;this.circleIndexBuffer=
new p.TriangleIndexBuffer}a.prototype.initialize=function(b,a,f,l){void 0===l&&(l=0);this.tileKey=b;this.refKey=a;this._workerTileHandler=f;this.rotation=l;this.placementEngine.setAngle(d.C_DEG_TO_RAD*l)};a.prototype.release=function(){this.tileKey=this.refKey="";this.status=m.TileStatus.INITIALIZED;this.rotation=0;this.fillVertexBuffer.reset();this.fillDDVertexBuffer.reset();this.fillIndexBuffer.reset();this.outlineVertexBuffer.reset();this.outlineDDVertexBuffer.reset();this.outlineIndexBuffer.reset();
this.lineVertexBuffer.reset();this.lineDDVertexBuffer.reset();this.lineIndexBuffer.reset();this.iconVertexBuffer.reset();this.iconDDVertexBuffer.reset();this.iconIndexBuffer.reset();this.textVertexBuffer.reset();this.textDDVertexBuffer.reset();this.textIndexBuffer.reset();this.circleVertexBuffer.reset();this.circleIndexBuffer.reset();this.placementEngine.reset();this._symbolBuckets.length=0;this._workerTileHandler=null};a.prototype.setDataAndParse=function(d,a){var p=this,g=new c(function(d){p.status=
m.TileStatus.INVALID});this._parse(d,a).then(function(d){p.status=m.TileStatus.READY;for(var a=new Uint32Array([1,p.fillVertexBuffer.sizeInBytes,2,p.fillDDVertexBuffer.sizeInBytes,3,p.fillIndexBuffer.sizeInBytes,4,p.outlineVertexBuffer.sizeInBytes,5,p.outlineDDVertexBuffer.sizeInBytes,6,p.outlineIndexBuffer.sizeInBytes,7,p.lineVertexBuffer.sizeInBytes,8,p.lineDDVertexBuffer.sizeInBytes,9,p.lineIndexBuffer.sizeInBytes,10,p.iconVertexBuffer.sizeInBytes,11,p.iconDDVertexBuffer.sizeInBytes,12,p.iconIndexBuffer.sizeInBytes,
13,p.textVertexBuffer.sizeInBytes,14,p.textDDVertexBuffer.sizeInBytes,15,p.textIndexBuffer.sizeInBytes,16,p.circleVertexBuffer.sizeInBytes,17,p.circleIndexBuffer.sizeInBytes]),e=[],x=d.length,u=0;u<x;u++){var c=d[u];if(c instanceof l)e.push(c.layerIndex),e.push(1),e.push(c.fillIndexStart),e.push(c.fillIndexCount),e.push(c.outlineIndexStart),e.push(c.outlineIndexCount);else if(c instanceof t)e.push(c.layerIndex),e.push(2),e.push(c.lineIndexStart),e.push(c.lineIndexCount);else if(c instanceof F){e.push(c.layerIndex);
e.push(3);e.push(c.sdfMarker?1:0);var q=c.markerPageMap;e.push(q.size);q.forEach(function(d,b){e.push(b);e.push(d[0]);e.push(d[1])});c=c.glyphsPageMap;e.push(c.size);c.forEach(function(d,b){e.push(b);e.push(d[0]);e.push(d[1])})}else c instanceof f?(e.push(c.layerIndex),e.push(4),e.push(c.circleIndexStart),e.push(c.circleIndexCount)):c instanceof b&&(e.push(c.layerIndex),e.push(0))}d=new Uint32Array(e);var x=p.fillVertexBuffer.toBuffer(),u=p.fillDDVertexBuffer.toBuffer(),c=p.fillIndexBuffer.toBuffer(),
q=p.outlineVertexBuffer.toBuffer(),A=p.outlineDDVertexBuffer.toBuffer(),w=p.outlineIndexBuffer.toBuffer(),z=p.lineVertexBuffer.toBuffer(),y=p.lineDDVertexBuffer.toBuffer(),I=p.lineIndexBuffer.toBuffer(),H=p.iconVertexBuffer.toBuffer(),v=p.iconDDVertexBuffer.toBuffer(),E=p.iconIndexBuffer.toBuffer(),C=p.textVertexBuffer.toBuffer(),D=p.textDDVertexBuffer.toBuffer(),n=p.textIndexBuffer.toBuffer(),W=p.circleVertexBuffer.toBuffer(),fa=p.circleIndexBuffer.toBuffer();g.resolve({result:{bufferDataInfo:a.buffer,
bucketDataInfo:d.buffer,bufferData:[x,u,c,q,A,w,z,y,I,H,v,E,C,D,n,W,fa]},transferList:[x,u,c,q,A,w,z,y,I,H,v,E,C,D,n,W,fa,a.buffer,d.buffer]})});return g.promise};a.prototype.addBucket=function(d){this._symbolBuckets.push(d)};a.prototype.updateSymbols=function(b){var a=this,f=this._symbolBuckets;if(!f||0===f.length)return e.resolve();this.rotation=b;var l=this.placementEngine;l.reset();l.setAngle(b/256*360*d.C_DEG_TO_RAD);var p=this.iconVertexBuffer;p.reset();var g=this.iconDDVertexBuffer;g.reset();
var c=this.iconIndexBuffer;c.reset();var u=this.textVertexBuffer;u.reset();var t=this.textDDVertexBuffer;t.reset();var F=this.textIndexBuffer;F.reset();var A=[],w=f.length,E=0;return q(function(){if(a.status===m.TileStatus.INVALID||a.status===m.TileStatus.INITIALIZED)return!0;if(E<w){var d=f[E++],b=d.layer;if(d=d.copy(b.hasDataDrivenIcon?g:p,c,b.hasDataDrivenText?t:u,F,l))A.push(d),d.updateSymbols()}return E>=w}).then(function(){if(a.status===m.TileStatus.INVALID||a.status===m.TileStatus.INITIALIZED||
0===p.sizeInBytes&&0===g.sizeInBytes&&0===c.sizeInBytes&&0===u.sizeInBytes&&0===t.sizeInBytes&&0===F.sizeInBytes)return{result:null,transferList:null};var d=new Uint32Array([10,p.sizeInBytes,11,g.sizeInBytes,12,c.sizeInBytes,13,u.sizeInBytes,14,t.sizeInBytes,15,F.sizeInBytes]),b=[];w=A.length;for(var f=0;f<w;f++){var l=A[f];b.push(l.layerIndex);b.push(3);b.push(l.sdfMarker?1:0);var e=l.markerPageMap;b.push(e.size);e.forEach(function(d,a){b.push(a);b.push(d[0]);b.push(d[1])});l=l.glyphsPageMap;b.push(l.size);
l.forEach(function(d,a){b.push(a);b.push(d[0]);b.push(d[1])})}var f=new Uint32Array(b),l=p.toBuffer(),e=g.toBuffer(),x=c.toBuffer(),q=u.toBuffer(),z=t.toBuffer(),v=F.toBuffer();return{result:{bufferDataInfo:d.buffer,bucketDataInfo:f.buffer,bufferData:[l,e,x,q,z,v]},transferList:[l,e,x,q,z,v,d.buffer,f.buffer]}}).catch(function(){return null})};a.prototype.setObsolete=function(){this.status=m.TileStatus.INVALID};a.prototype.getLayers=function(){return this._workerTileHandler.getLayers()};a.prototype.getWorkerTileHandler=
function(){return this._workerTileHandler};a.prototype._parse=function(d,b){if(!d||0===d.byteLength)return e.resolve([]);this.status=m.TileStatus.MODIFIED;return(new u(d,this,b)).parse()};a.pool=new g(a);return a}()})},"esri/core/executeAsync":function(){define("require exports dojo/has ./nextTick ./now ./promiseUtils".split(" "),function(n,a,c,q,g,e){function m(){var a=0===f.length;if(!a){for(var e=g();!a&&g()-e<b;){var c=f[d];if(c){if(!0===c()){var F=l.get(c);f[d]=null;l.delete(c);F()}d=(d+1)%f.length}else f.splice(d,
1),d=(a=0===f.length)?0:d%f.length}a||q(m)}}var b=c("host-browser")?6:200,f=[],l=new Map,d=0;return function(d){return d?e.create(function(b){f.push(d);l.set(d,b);1===f.length&&q(m)},function(){f[f.indexOf(d)]=null;l.delete(d)}):e.reject(new TypeError("callback is not a function"))}})},"esri/core/nextTick":function(){define(["require","exports","./global"],function(n,a,c){function q(){if(c.postMessage&&!c.importScripts){var a=c.onmessage,g=!0;c.onmessage=function(){g=!1};c.postMessage("","*");c.onmessage=
a;return g}return!1}var g=c.MutationObserver||c.WebKitMutationObserver;return function(){var a;if(c.process&&c.process.nextTick)a=function(b){c.process.nextTick(b)};else if(c.Promise)a=function(b){c.Promise.resolve().then(b)};else if(g){var m=[],b=document.createElement("div");(new g(function(){for(;0<m.length;)m.shift()()})).observe(b,{attributes:!0});a=function(a){m.push(a);b.setAttribute("queueStatus","1")}}else if(q()){var f=[];c.addEventListener("message",function(b){if(b.source===c&&"esri-nexttick-message"===
b.data)for(b.stopPropagation();f.length;)f.shift()()},!0);a=function(b){f.push(b);c.postMessage("esri-nexttick-message","*")}}else a=c.setImmediate?function(b){return c.setImmediate(b)}:function(b){return c.setTimeout(b,0)};return a}()})},"esri/core/now":function(){define(["require","exports","./global"],function(n,a,c){return function(){var a=c.performance||{};if(a.now)return function(){return a.now()};if(a.webkitNow)return function(){return a.webkitNow()};if(a.mozNow)return function(){return a.mozNow()};
if(a.msNow)return function(){return a.msNow()};if(a.oNow)return function(){return a.oNow()};var g;g=a.timing&&a.timing.navigationStart?a.timing.navigationStart:Date.now();return function(){return Date.now()-g}}()})},"esri/core/ObjectPool":function(){define(["require","exports"],function(n,a){var c=function(){return function(){}}();return function(){function a(a,e,c,b,f){void 0===b&&(b=1);void 0===f&&(f=0);this.classConstructor=a;this.acquireFunctionOrWithConstructor=e;this.releaseFunction=c;this.growthSize=
b;!0===e?this.acquireFunction=this._constructorAcquireFunction:"function"===typeof e&&(this.acquireFunction=e);this._pool=Array(f);this._set=new Set;this._initialSize=f;for(a=0;a<f;a++)this._pool[a]=new this.classConstructor;this.growthSize=Math.max(b,1)}a.prototype.acquire=function(){for(var a=[],e=0;e<arguments.length;e++)a[e]=arguments[e];e=this.classConstructor||c;if(0===this._pool.length)for(var m=this.growthSize,b=0;b<m;b++)this._pool[b]=new e;e=this._pool.pop();this.acquireFunction?this.acquireFunction.apply(this,
[e].concat(a)):e&&e.acquire&&"function"===typeof e.acquire&&e.acquire.apply(e,a);this._set.delete(e);return e};a.prototype.release=function(a){a&&!this._set.has(a)&&(this.releaseFunction?this.releaseFunction(a):a&&a.release&&"function"===typeof a.release&&a.release(),this._pool.push(a),this._set.add(a))};a.prototype.prune=function(a){void 0===a&&(a=this._initialSize);if(!(this._pool.length<=a))for(var e;a>this._pool.length;)e=this._pool.shift(),this._set.delete(e),e.dispose&&"function"===typeof e.dispose&&
e.dispose()};a.prototype._constructorAcquireFunction=function(a){for(var e=[],g=1;g<arguments.length;g++)e[g-1]=arguments[g];var b;(b=this.classConstructor).call.apply(b,[a].concat(e))};return a}()})},"esri/views/vectorTiles/BackgroundBucket":function(){define(["require","exports","../../core/tsSupport/extendsHelper","../../core/tsSupport/decorateHelper","./Bucket"],function(n,a,c,q,g){return function(a){function g(b,f){return a.call(this,b,f)||this}c(g,a);return g}(g)})},"esri/core/tsSupport/decorateHelper":function(){define([],
function(){return function(n,a,c,q){var g=arguments.length,e=3>g?a:null===q?q=Object.getOwnPropertyDescriptor(a,c):q,m;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)e=Reflect.decorate(n,a,c,q);else for(var b=n.length-1;0<=b;b--)if(m=n[b])e=(3>g?m(e):3<g?m(a,c,e):m(a,c))||e;return 3<g&&e&&Object.defineProperty(a,c,e),e}})},"esri/views/vectorTiles/Bucket":function(){define(["require","exports"],function(n,a){return function(){function a(a,g){this.layerExtent=4096;this._features=
[];this.layer=a;this.zoom=g;this._filter=a.getFeatureFilter()}a.prototype.pushFeature=function(a){this._filter.filter(a)&&this._features.push(a)};a.prototype.hasFeatures=function(){return 0<this._features.length};a.prototype.processFeatures=function(a,g){};a.prototype.assignBufferInfo=function(a){};return a}()})},"esri/views/vectorTiles/CircleBucket":function(){define(["require","exports","../../core/tsSupport/extendsHelper","../../core/tsSupport/decorateHelper","./Bucket"],function(n,a,c,q,g){return function(a){function g(b,
f,l,d){b=a.call(this,b,f)||this;b._circleVertexBuffer=l;b._circleIndexBuffer=d;return b}c(g,a);Object.defineProperty(g.prototype,"circleIndexStart",{get:function(){return this._circleIndexStart},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"circleIndexCount",{get:function(){return this._circleIndexCount},enumerable:!0,configurable:!0});g.prototype.assignBufferInfo=function(a){a._circleIndexStart=this._circleIndexStart;a._circleIndexCount=this._circleIndexCount};g.prototype.processFeatures=
function(a,f){f=this._circleVertexBuffer;var b=this._circleIndexBuffer;this._circleIndexStart=b.index;this._circleIndexCount=0;var d=this.layer,p=this.zoom;a&&a.setExtent(this.layerExtent);for(var g=1,e=[1,1,1,1],c=1,m=0,q=1,E=[1,1,1,1],D=1,C=0,z=this._features;C<z.length;C++){var x=z[C],v=x.getGeometry(a);if(v)for(d.hasDataDrivenRadius&&(g=d.getPaintValue("circle-radius",p,x)),d.hasDataDrivenColor&&(e=d.getPaintValue("circle-color",p,x)),d.hasDataDrivenOpacity&&(c=d.getPaintValue("circle-opacity",
p,x)),d.hasDataDrivenStrokeWidth&&(q=d.getPaintValue("circle-stroke-width",p,x)),d.hasDataDrivenStrokeColor&&(E=d.getPaintValue("circle-stroke-color",p,x)),d.hasDataDrivenStrokeOpacity&&(D=d.getPaintValue("circle-stroke-opacity",p,x)),d.hasDataDrivenBlur&&(m=d.getPaintValue("circle-blur",p,x)),x=0;x<v.length;x++){var B=v[x];if(B)for(var J=0;J<B.length;J++){var M=B[J],P=f.index;f.add(M.x,M.y,0,0,g,e,c,m,q,E,D);f.add(M.x,M.y,0,1,g,e,c,m,q,E,D);f.add(M.x,M.y,1,0,g,e,c,m,q,E,D);f.add(M.x,M.y,1,1,g,e,
c,m,q,E,D);b.add(P+0,P+1,P+2);b.add(P+1,P+2,P+3);this._circleIndexCount+=6}}}};return g}(g)})},"esri/views/vectorTiles/FillBucket":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper ../../core/ArrayPool ../../core/libs/earcut/earcut ../2d/engine/webgl/Geometry ./Bucket".split(" "),function(n,a,c,q,g,e,m,b){return function(a){function b(b,f,l,g,e,c){f=a.call(this,b,f)||this;if(b.hasDataDrivenFill!==l.isDataDriven())throw Error("incompatible fill buffer");
if(b.hasDataDrivenOutline!==e.isDataDriven())throw Error("incompatible outline buffer");f._fillVertexBuffer=l;f._fillIndexBuffer=g;f._outlineVertexBuffer=e;f._outlineIndexBuffer=c;return f}c(b,a);Object.defineProperty(b.prototype,"fillIndexStart",{get:function(){return this._fillIndexStart},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"fillIndexCount",{get:function(){return this._fillIndexCount},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"outlineIndexStart",
{get:function(){return this._outlineIndexStart},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"outlineIndexCount",{get:function(){return this._outlineIndexCount},enumerable:!0,configurable:!0});b.prototype.assignBufferInfo=function(a){a._fillIndexStart=this._fillIndexStart;a._fillIndexCount=this._fillIndexCount;a.layer.getPaintProperty("fill-outline-color")?(a._outlineIndexStart=this._outlineIndexStart,a._outlineIndexCount=this._outlineIndexCount):(a._outlineIndexStart=0,a._outlineIndexCount=
0)};b.prototype.processFeatures=function(a,b){this._fillIndexStart=this._fillIndexBuffer.index;this._fillIndexCount=0;this._outlineIndexStart=this._outlineIndexBuffer.index;this._outlineIndexCount=0;b=this.layer;var d=this.zoom,f=b.hasDataDrivenFill,l=b.hasDataDrivenOutline;a&&a.setExtent(this.layerExtent);var p=b.getPaintValue("fill-pattern",d),g=b.getPaintValue("fill-antialias",d)&&void 0===p,e=[1,1,1,1],c=[1,1,1,1],m=1;if(b.outlineUsesFillColor){if(g&&!b.hasDataDrivenOpacity){var q=b.getPaintValue("fill-opacity",
d),x=b.getPaintValue("fill-opacity",d+1);1>q&&1>x&&(g=!1)}g&&!b.hasDataDrivenColor&&(q=b.getPaintValue("fill-color",d),x=b.getPaintValue("fill-color",d+1),1>q[3]&&1>x[3]&&(g=!1))}q=0;for(x=this._features;q<x.length;q++){var v=x[q];!p&&b.hasDataDrivenColor&&(e=b.getPaintValue("fill-color",d,v));b.hasDataDrivenOpacity&&(m=b.getPaintValue("fill-opacity",d,v));!p&&b.hasDataDrivenOutlineColor&&(c=b.getPaintValue("fill-outline-color",d,v));var B=void 0;f&&(B={color:e,opacity:m});var J=void 0;l&&(J={color:b.outlineUsesFillColor?
e:c,opacity:m});v=v.getGeometry(a);this._processFeature(v,g,b.outlineUsesFillColor,B,J)}};b.prototype._processFeature=function(a,f,l,g,e){if(a){var d=a.length;if(f&&(!l||!e||1===e.color[3]*e.opacity))for(f=0;f<d;f++)this._processOutline(a[f],e);var p;for(f=0;f<d;f++)e=b._area(a[f]),128<e?(void 0!==p&&this._processFill(a,p,g),p=[f]):-128>e&&void 0!==p&&p.push(f);void 0!==p&&this._processFill(a,p,g)}};b.prototype._processOutline=function(a,b){var d=this._outlineVertexBuffer,f=this._outlineIndexBuffer,
l=f.index,g,p,e,c=new m.Point(0,0),q=new m.Point(0,0),z=new m.Point(0,0),x=-1,v=-1,B=-1,J=-1,M=-1,P=!1,Q=a.length;if(!(2>Q)){var n=a[0];for(g=a[Q-1];Q&&g.isEqual(n);)--Q,g=a[Q-1];if(!(2>Q-0)){for(n=0;n<Q;++n){0===n?(g=a[Q-1],p=a[0],e=a[1],c.assignSub(p,g),c.normalize(),c.rightPerpendicular()):(g=p,p=e,e=n!==Q-1?a[n+1]:a[0],c.assign(q));g=this._isClipEdge(g,p);-1===J&&(P=g);q.assignSub(e,p);q.normalize();q.rightPerpendicular();B=c.x*q.y-c.y*q.x;z.assignAdd(c,q);z.normalize();var L=-z.x*-c.x+-z.y*-c.y,
L=Math.abs(0!==L?1/L:1);8<L&&(L=8);0<=B?(B=d.add(p.x,p.y,c.x,c.y,0,1,b),-1===J&&(J=B),0<=x&&0<=v&&0<=B&&!g&&f.add(x,v,B),v=d.add(p.x,p.y,L*-z.x,L*-z.y,0,-1,b),-1===M&&(M=v),0<=x&&0<=v&&0<=B&&!g&&f.add(x,v,B),x=v,v=B,B=d.add(p.x,p.y,z.x,z.y,0,1,b),0<=x&&0<=v&&0<=B&&!g&&f.add(x,v,B),v=d.add(p.x,p.y,q.x,q.y,0,1,b)):(B=d.add(p.x,p.y,L*z.x,L*z.y,0,1,b),-1===J&&(J=B),0<=x&&0<=v&&0<=B&&!g&&f.add(x,v,B),v=d.add(p.x,p.y,-c.x,-c.y,0,-1,b),-1===M&&(M=v),0<=x&&0<=v&&0<=B&&!g&&f.add(x,v,B),x=v,v=B,B=d.add(p.x,
p.y,-z.x,-z.y,0,-1,b),0<=x&&0<=v&&0<=B&&!g&&f.add(x,v,B),x=d.add(p.x,p.y,-q.x,-q.y,0,-1,b));0<=x&&0<=v&&0<=B&&!g&&f.add(x,v,B)}0<=x&&0<=v&&0<=J&&!P&&f.add(x,v,J);0<=x&&0<=J&&0<=M&&!P&&f.add(x,M,J);this._outlineIndexCount+=3*(f.index-l)}}};b.prototype._processFill=function(a,b,f){var d;1<b.length&&(d=[]);for(var l=0,p=0;p<b.length;p++){var c=b[p];0!==l&&d.push(l);l+=a[c].length}for(var p=2*l,l=g.acquire(),m=0;m<b.length;m++)for(var c=b[m],c=a[c],q=c.length,t=0;t<q;++t)l.push(c[t].x),l.push(c[t].y);
a=e(l,d,2);b=a.length;if(0<b){d=this._fillVertexBuffer.index;for(m=0;m<p;)this._fillVertexBuffer.add(l[m++],l[m++],f);for(f=0;f<b;)this._fillIndexBuffer.add(d+a[f++],d+a[f++],d+a[f++]);this._fillIndexCount+=b}g.release(l)};b.prototype._isClipEdge=function(a,b){return a.x===b.x?-64>=a.x||4160<=a.x:a.y===b.y?-64>=a.y||4160<=a.y:!1};b._area=function(a){for(var b=0,d=a.length-1,f=0;f<d;f++)b+=(a[f].x-a[f+1].x)*(a[f].y+a[f+1].y);b+=(a[d].x-a[0].x)*(a[d].y+a[0].y);return.5*b};return b}(b)})},"esri/core/ArrayPool":function(){define(["require",
"exports","./ObjectPool"],function(n,a,c){function q(a){a.length=0}var g=Array.prototype.splice;n=function(){function a(a,f){void 0===a&&(a=50);void 0===f&&(f=50);this._pool=new c(Array,!1,q,f,a)}a.prototype.acquire=function(){return this._pool.acquire()};a.prototype.copy=function(a){var b=this.acquire();a.unshift(0,0);g.apply(b,a);a.splice(0,2);return b};a.prototype.release=function(a){this._pool.release(a)};a.acquire=function(){return e.acquire()};a.copy=function(a){return e.copy(a)};a.release=
function(a){return e.release(a)};return a}();var e=new n(100);return n})},"esri/core/libs/earcut/earcut":function(){define([],function(){function n(b,d,l){l=l||2;C=b.length/l+(d?2*d.length:0);z=!1;var g=d&&d.length,p=g?d[0]*l:b.length,x=a(b,0,p,l,!0),u=[];if(!x)return u;var t,A,v,w;if(g)a:{var y=l,g=[],I,H,E;w=0;for(I=d.length;w<I;w++)H=d[w]*y,E=w<I-1?d[w+1]*y:b.length,H=a(b,H,E,y,!1),H===H.next&&(H.steiner=!0),g.push(f(H));g.sort(e);for(w=0;w<g.length;w++){if(!x){x=null;break a}d=g[w];y=x;if(y=m(d,
y))d=F(y,d),c(d,d.next);x=c(x,x.next)}}if(z)return u;if(b.length>80*l){t=v=b[0];A=g=b[1];for(y=l;y<p;y+=l)w=b[y],d=b[y+1],w<t&&(t=w),d<A&&(A=d),w>v&&(v=w),d>g&&(g=d);v=Math.max(v-t,g-A)}q(x,u,l,t,A,v);return u}function a(a,b,d,f,l){var g;if(l===0<D(a,b,d,f))for(l=b;l<d;l+=f)g=u(l,a[l],a[l+1],g);else for(l=d-f;l>=b;l-=f)g=u(l,a[l],a[l+1],g);g&&p(g,g.next)&&(w(g),g=g.next);return g}function c(a,b){if(!a)return a;b||(b=a);var f,l=0,g=C*C/2;do{f=!1;if(a.steiner||!p(a,a.next)&&0!==d(a.prev,a,a.next))a=
a.next;else{w(a);a=b=a.prev;if(a===a.next)return null;f=!0}if(l++>g)return z=!0,null}while(f||a!==b);return b}function q(a,f,e,m,u,E,C){if(a){if(!C&&E){var x=a,v=x;do null===v.z&&(v.z=b(v.x,v.y,m,u,E)),v.prevZ=v.prev,v=v.nextZ=v.next;while(v!==x);v.prevZ.nextZ=null;v.prevZ=null;var x=v,B,G,y,I,H,D,J=1;do{v=x;y=x=null;for(I=0;v;){I++;G=v;for(B=H=0;B<J&&(H++,G=G.nextZ,G);B++);for(D=J;0<H||0<D&&G;)0===H?(B=G,G=G.nextZ,D--):0!==D&&G?v.z<=G.z?(B=v,v=v.nextZ,H--):(B=G,G=G.nextZ,D--):(B=v,v=v.nextZ,H--),
y?y.nextZ=B:x=B,B.prevZ=y,y=B;v=G}y.nextZ=null;J*=2}while(1<I)}for(x=a;a.prev!==a.next;){v=a.prev;G=a.next;if(E)a:{y=a;D=m;var K=u,U=E;I=y.prev;H=y;J=y.next;if(0<=d(I,H,J))y=!1;else{var M=I.x>H.x?I.x>J.x?I.x:J.x:H.x>J.x?H.x:J.x,n=I.y>H.y?I.y>J.y?I.y:J.y:H.y>J.y?H.y:J.y;B=b(I.x<H.x?I.x<J.x?I.x:J.x:H.x<J.x?H.x:J.x,I.y<H.y?I.y<J.y?I.y:J.y:H.y<J.y?H.y:J.y,D,K,U);D=b(M,n,D,K,U);for(K=y.nextZ;K&&K.z<=D;){if(K!==y.prev&&K!==y.next&&l(I.x,I.y,H.x,H.y,J.x,J.y,K.x,K.y)&&0<=d(K.prev,K,K.next)){y=!1;break a}K=
K.nextZ}for(K=y.prevZ;K&&K.z>=B;){if(K!==y.prev&&K!==y.next&&l(I.x,I.y,H.x,H.y,J.x,J.y,K.x,K.y)&&0<=d(K.prev,K,K.next)){y=!1;break a}K=K.prevZ}y=!0}}else y=g(a);if(y)f.push(v.i/e),f.push(a.i/e),f.push(G.i/e),w(a),x=a=G.next;else{if(z)break;a=G;if(a===x){if(!C)q(c(a),f,e,m,u,E,1);else if(1===C){C=f;x=e;v=a;do G=v.prev,y=v.next.next,!p(G,y)&&t(G,v,v.next,y)&&A(G,y)&&A(y,G)&&(C.push(G.i/x),C.push(v.i/x),C.push(y.i/x),w(v),w(v.next),v=a=y),v=v.next;while(v!==a);a=v;q(a,f,e,m,u,E,2)}else if(2===C)a:{C=
a;do{for(x=C.next.next;x!==C.prev;){if(v=C.i!==x.i){v=C;G=x;y=void 0;if(y=v.next.i!==G.i&&v.prev.i!==G.i){y=void 0;b:{y=v;do{if(y.i!==v.i&&y.next.i!==v.i&&y.i!==G.i&&y.next.i!==G.i&&t(y,y.next,v,G)){y=!0;break b}y=y.next}while(y!==v);y=!1}y=!y}I=void 0;if(I=y&&A(v,G)&&A(G,v)){y=v;I=!1;H=(v.x+G.x)/2;G=(v.y+G.y)/2;do y.y>G!==y.next.y>G&&H<(y.next.x-y.x)*(G-y.y)/(y.next.y-y.y)+y.x&&(I=!I),y=y.next;while(y!==v)}v=I}if(v){a=F(C,x);C=c(C,C.next);a=c(a,a.next);q(C,f,e,m,u,E);q(a,f,e,m,u,E);break a}x=x.next}C=
C.next}while(C!==a)}break}}}}}function g(a){var b=a.prev,f=a.next;if(0<=d(b,a,f))return!1;for(var g=a.next.next,p=0;g!==a.prev;){if(l(b.x,b.y,a.x,a.y,f.x,f.y,g.x,g.y)&&0<=d(g.prev,g,g.next))return!1;g=g.next;if(p++>C)return z=!0,!1}return!0}function e(a,b){return a.x-b.x}function m(a,b){var d=b,f=a.x,g=a.y,p=-Infinity,e;do{if(!d)return null;if(g<=d.y&&g>=d.next.y){var c=d.x+(g-d.y)*(d.next.x-d.x)/(d.next.y-d.y);if(c<=f&&c>p){p=c;if(c===f){if(g===d.y)return d;if(g===d.next.y)return d.next}e=d.x<d.next.x?
d:d.next}}d=d.next}while(d!==b);if(!e)return null;if(f===p)return e.prev;b=e;for(var c=e.x,m=e.y,u=Infinity,x,d=e.next;d!==b;)f>=d.x&&d.x>=c&&l(g<m?f:p,g,c,m,g<m?p:f,g,d.x,d.y)&&(x=Math.abs(g-d.y)/(f-d.x),(x<u||x===u&&d.x>e.x)&&A(d,a)&&(e=d,u=x)),d=d.next;return e}function b(a,b,d,f,l){a=32767*(a-d)/l;b=32767*(b-f)/l;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;b=(b|b<<8)&16711935;b=(b|b<<4)&252645135;b=(b|b<<2)&858993459;return(a|a<<1)&1431655765|((b|b<<1)&1431655765)<<1}function f(a){var b=
a,d=a;do b.x<d.x&&(d=b),b=b.next;while(b!==a);return d}function l(a,b,d,f,l,g,e,p){return 0<=(l-e)*(b-p)-(a-e)*(g-p)&&0<=(a-e)*(f-p)-(d-e)*(b-p)&&0<=(d-e)*(g-p)-(l-e)*(f-p)}function d(a,b,d){return(b.y-a.y)*(d.x-b.x)-(b.x-a.x)*(d.y-b.y)}function p(a,b){return a.x===b.x&&a.y===b.y}function t(a,b,f,l){return p(a,b)&&p(f,l)||p(a,l)&&p(f,b)?!0:0<d(a,b,f)!==0<d(a,b,l)&&0<d(f,l,a)!==0<d(f,l,b)}function A(a,b){return 0>d(a.prev,a,a.next)?0<=d(a,b,a.next)&&0<=d(a,a.prev,b):0>d(a,b,a.prev)||0>d(a,a.next,b)}
function F(a,b){var d=new E(a.i,a.x,a.y),f=new E(b.i,b.x,b.y),l=a.next,g=b.prev;a.next=b;b.prev=a;d.next=l;l.prev=d;f.next=d;d.prev=f;g.next=f;f.prev=g;return f}function u(a,b,d,f){a=new E(a,b,d);f?(a.next=f.next,a.prev=f,f.next.prev=a,f.next=a):(a.prev=a,a.next=a);return a}function w(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function E(a,b,d){this.i=a;this.x=b;this.y=d;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=
!1}function D(a,b,d,f){for(var l=0,g=d-f;b<d;b+=f)l+=(a[g]-a[b])*(a[b+1]+a[g+1]),g=b;return l}var C,z;n.deviation=function(a,b,d,f){var l=b&&b.length,g=Math.abs(D(a,0,l?b[0]*d:a.length,d));if(l)for(var l=0,e=b.length;l<e;l++)g-=Math.abs(D(a,b[l]*d,l<e-1?b[l+1]*d:a.length,d));for(l=b=0;l<f.length;l+=3){var e=f[l]*d,p=f[l+1]*d,c=f[l+2]*d;b+=Math.abs((a[e]-a[c])*(a[p+1]-a[e+1])-(a[e]-a[p])*(a[c+1]-a[e+1]))}return 0===g&&0===b?0:Math.abs((b-g)/g)};n.flatten=function(a){for(var b=a[0][0].length,d={vertices:[],
holes:[],dimensions:b},f=0,l=0;l<a.length;l++){for(var g=0;g<a[l].length;g++)for(var e=0;e<b;e++)d.vertices.push(a[l][g][e]);0<l&&(f+=a[l-1].length,d.holes.push(f))}return d};return n})},"esri/views/2d/engine/webgl/Geometry":function(){define(["require","exports"],function(n,a){Object.defineProperty(a,"__esModule",{value:!0});n=function(){function a(a,g){this.x=a;this.y=g}a.prototype.clone=function(){return new a(this.x,this.y)};a.prototype.equals=function(a,g){return a===this.x&&g===this.y};a.prototype.isEqual=
function(a){return a.x===this.x&&a.y===this.y};a.prototype.setCoords=function(a,g){this.x=a;this.y=g};a.prototype.normalize=function(){var a=this.x,g=this.y,a=Math.sqrt(a*a+g*g);this.x/=a;this.y/=a};a.prototype.rightPerpendicular=function(){var a=this.x;this.x=this.y;this.y=-a};a.prototype.move=function(a,g){this.x+=a;this.y+=g};a.prototype.assign=function(a){this.x=a.x;this.y=a.y};a.prototype.assignAdd=function(a,g){this.x=a.x+g.x;this.y=a.y+g.y};a.prototype.assignSub=function(a,g){this.x=a.x-g.x;
this.y=a.y-g.y};a.prototype.rotate=function(a,g){var e=this.x,c=this.y;this.x=e*a-c*g;this.y=e*g+c*a};a.prototype.scale=function(a){this.x*=a;this.y*=a};a.prototype.length=function(){var a=this.x,g=this.y;return Math.sqrt(a*a+g*g)};a.distance=function(a,g){var e=g.x-a.x;a=g.y-a.y;return Math.sqrt(e*e+a*a)};a.add=function(c,g){return new a(c.x+g.x,c.y+g.y)};a.sub=function(c,g){return new a(c.x-g.x,c.y-g.y)};return a}();a.Point=n})},"esri/views/vectorTiles/GeometryUtils":function(){define(["require",
"exports"],function(n,a){function c(a,e){a%=e;return 0<=a?a:a+e}Object.defineProperty(a,"__esModule",{value:!0});a.C_INFINITY=Number.POSITIVE_INFINITY;a.C_PI=Math.PI;a.C_2PI=2*a.C_PI;a.C_PI_BY_2=a.C_PI/2;a.C_RAD_TO_256=128/a.C_PI;a.C_256_TO_RAD=a.C_PI/128;a.C_DEG_TO_256=256/360;a.C_DEG_TO_RAD=a.C_PI/180;a.C_SQRT2=1.414213562;a.C_SQRT2_INV=1/a.C_SQRT2;var q=1/Math.LN2;a.positiveMod=c;a.radToByte=function(g){return c(g*a.C_RAD_TO_256,256)};a.degToByte=function(g){return c(g*a.C_DEG_TO_256,256)};a.log2=
function(a){return Math.log(a)*q};a.sqr=function(a){return a*a};a.clamp=function(a,e,c){return Math.min(Math.max(a,e),c)};a.interpolate=function(a,e,c){return a*(1-c)+e*c};a.between=function(a,e,c){return a>=e&&a<=c||a>=c&&a<=e}})},"esri/views/vectorTiles/IndexMemoryBuffer":function(){define(["require","exports","../../core/tsSupport/extendsHelper","../../core/tsSupport/decorateHelper","./MemoryBuffer"],function(n,a,c,q,g){Object.defineProperty(a,"__esModule",{value:!0});n=function(a){function g(){return a.call(this,
12)||this}c(g,a);g.prototype.add=function(a,f,l){var b=this.array;b.push(a);b.push(f);b.push(l)};return g}(g);a.TriangleIndexBuffer=n;g=function(a){function g(){return a.call(this,4)||this}c(g,a);g.prototype.add=function(a){this.array.push(a)};return g}(g);a.PointElementMemoryBuffer=g})},"esri/views/vectorTiles/MemoryBuffer":function(){define(["require","exports"],function(n,a){return function(){function a(a){this._array=[];0>=a&&console.error("strideInBytes must be positive!");this._stride=a}Object.defineProperty(a.prototype,
"array",{get:function(){return this._array},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"index",{get:function(){return 4*this._array.length/this._stride},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"itemSize",{get:function(){return this._stride},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"sizeInBytes",{get:function(){return 4*this._array.length},enumerable:!0,configurable:!0});a.prototype.reset=function(){this.array.length=0};a.prototype.toBuffer=
function(){return(new Uint32Array(this._array)).buffer};a.i1616to32=function(a,g){return 65535&a|g<<16};a.i8888to32=function(a,g,e,c){return a&255|(g&255)<<8|(e&255)<<16|c<<24};a.i8816to32=function(a,g,e){return a&255|(g&255)<<8|e<<16};return a}()})},"esri/views/vectorTiles/LineBucket":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper ../2d/engine/webgl/LineTess ./Bucket ./style/StyleLayer".split(" "),function(n,a,c,q,g,e,m){var b=new g.Tessellator({distanceAlongCorrection:!0});
return function(a){function f(b,f,l,e){f=a.call(this,b,f)||this;f.extrudeVectorsDoubleBuffer=[g.allocExtrudeVectors(),g.allocExtrudeVectors()];f.firstExtrudeVectors=g.allocExtrudeVectors();f.recycledTriangleBridge=g.allocTriangles(20);f.recycledTrianglePie=g.allocTriangles(20);if(b.hasDataDrivenLine!==l.isDataDriven())throw Error("incompatible line buffer");f._lineVertexBuffer=l;f._lineIndexBuffer=e;return f}c(f,a);Object.defineProperty(f.prototype,"lineIndexStart",{get:function(){return this._lineIndexStart},
enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"lineIndexCount",{get:function(){return this._lineIndexCount},enumerable:!0,configurable:!0});f.prototype.assignBufferInfo=function(a){a._lineIndexStart=this._lineIndexStart;a._lineIndexCount=this._lineIndexCount};f.prototype.processFeatures=function(a,b){this._lineIndexStart=this._lineIndexBuffer.index;this._lineIndexCount=0;b=this.layer;var d=this.zoom,f=b.hasDataDrivenLine;a&&a.setExtent(this.layerExtent);for(var l=b.getPaintValue("line-pattern",
d),g=[1,1,1,1],e=1,p=1,c=0,q=this._features;c<q.length;c++){var z=q[c],x=new m.LineLayout(b,d,z);!l&&b.hasDataDrivenColor&&(g=b.getPaintValue("line-color",d,z));b.hasDataDrivenOpacity&&(e=b.getPaintValue("line-opacity",d,z));b.hasDataDrivenWidth&&(p=b.getPaintValue("line-width",d,z));var v=void 0;if(f&&(v={color:g,opacity:e,size:Math.max(Math.min(p,256),0)},0>=v.size||0>=v.opacity||0>=v.color[3]))continue;z=z.getGeometry(a);this._processFeature(x,z,v)}};f.prototype._processFeature=function(a,b,f){if(b)for(var d=
b.length,l=0;l<d;l++)this._processGeometry(b[l],a,f)};f.prototype._processGeometry=function(a,b,f){if(!(2>a.length)){for(var d=a[0],l=a[a.length-1],e=l.x-d.x,l=l.y-d.y,d=1E-6>e*e+l*l,p=a[0],c=1;c<a.length;)e=a[c].x-p.x,l=a[c].y-p.y,1E-6>e*e+l*l?a.splice(c,1):(p=a[c],++c);if(!(2>a.length)){this.vertices=a;this.verticesLen=a.length;this.isClosed=d;this.cap=b.cap;this.join=b.join;this.almostParallelRads=.05;this.veryShallowRads=.1;this.miterSafeRads=g.MITER_SAFE_RADS;this.miterLimitMag=Math.min(b.miterLimit,
g.SYSTEM_MAG_LIMIT);this.roundLimitRads=Math.min(b.roundLimit,.5);this.newRoundJoinsSafeRads=2.3;b=this._lineIndexBuffer.index;for(var e=0,m=void 0,l=this.verticesLen,p=0;p<l;++p){var c=a[p],t=a[(p+l-1)%l],q=d&&this._isClipEdge(t,c),t=m===this.extrudeVectorsDoubleBuffer[p%2]?this.extrudeVectorsDoubleBuffer[(p+1)%2]:this.extrudeVectorsDoubleBuffer[p%2];p<l-1||!d||this.hasPattern?(this._computeExtrudeVectors(t,p),this._writeGPUVertices(c.x,c.y,e,t,f),!t.capCenter||d&&p===l-1||this._writeGPUPieElements(t,
q),d&&0===p&&!this.hasPattern&&g.copyExtrudeVectors(this.firstExtrudeVectors,t)):g.copyExtrudeVectors(t,this.firstExtrudeVectors);m&&this._writeGPUBridgeElements(m,t,q);p<l-1&&(m=a[p+1],c=g.length([m.x-c.x,m.y-c.y]),e+=c);m=t}this._lineIndexCount+=3*(this._lineIndexBuffer.index-b)}}};f.prototype._computeExtrudeVectors=function(a,b){var d=this.vertices,f=this.verticesLen,l=this.isClosed,e=d[b],c=[void 0,void 0],p=[void 0,void 0];if(0<b&&b<f-1){var m=d[(b+f-1)%f],q=d[(b+1)%f];g.normalize(c,[e.x-m.x,
e.y-m.y]);g.normalize(p,[q.x-e.x,q.y-e.y])}else if(0===b)q=d[(b+1)%f],g.normalize(p,[q.x-e.x,q.y-e.y]),l?(d=d[f-2],g.normalize(c,[e.x-d.x,e.y-d.y])):c=p;else if(b===f-1)m=d[(b+f-1)%f],g.normalize(c,[e.x-m.x,e.y-m.y]),l?(d=d[1],g.normalize(p,[d.x-e.x,d.y-e.y])):p=c;else{console.error("Vertex index 'i' out of range.");return}l||0!==b?l||b!==f-1?this._computeJoinExtrudeVectors(a,c,p):this._computeCapExtrudeVectors(a,c,p,g.CapPosition.END):this._computeCapExtrudeVectors(a,c,p,g.CapPosition.START)};f.prototype._computeCapExtrudeVectors=
function(a,f,l,e){0===this.cap?b.buttCap(a,f,l):1===this.cap?b.roundCap(a,f,l,e,g.getNumberOfSlices(Math.PI),e===g.CapPosition.START?-1:1):2===this.cap?b.squareCap(a,f,l,e):b.buttCap(a,f,l)};f.prototype._computeJoinExtrudeVectors=function(a,f,l){var d=g.getRads(f,l);if(d>Math.PI-this.almostParallelRads)b.rectJoin(a,f,l);else if(0===this.join&&d>=this.veryShallowRads)b.bevelJoin(a,f,l,1);else if(1===this.join&&d>=this.veryShallowRads){var e=g.getNumberOfSlices(d);d<this.newRoundJoinsSafeRads?2>e||
d<this.roundLimitRads?b.bevelJoin(a,f,l,1):b.roundJoin(a,f,l,e):b.unitRoundJoin(a,f,l,e)}else d<this.almostParallelRads?b.fastMiterJoin(a,f,l):d<this.miterSafeRads?b.miterJoin(a,f,l):b.bevelJoin(a,f,l,this.miterLimitMag)};f.prototype._writeGPUVertices=function(a,b,f,l,g){for(var d=0;d<l.vectors.count;++d){var e=l.vectors.items[d].vector[0],c=l.vectors.items[d].vector[1],p=l.vectors.items[d].texCoords[0],m=l.vectors.items[d].texCoords[1];l.vectors.items[d].base=this._lineVertexBuffer.index;this._lineVertexBuffer.add(a,
b,e,c,p,m,f,g)}};f.prototype._writeGPUBridgeElements=function(a,f,l){b.bridge(this.recycledTriangleBridge,a,f);if(!l)for(a=0;a<this.recycledTriangleBridge.count;++a)f=this.recycledTriangleBridge.items[a],this._lineIndexBuffer.add(f.v1.base,f.v2.base,f.v3.base)};f.prototype._writeGPUPieElements=function(a,f){b.pie(this.recycledTrianglePie,a);if(!f)for(a=0;a<this.recycledTrianglePie.count;++a)f=this.recycledTrianglePie.items[a],this._lineIndexBuffer.add(f.v1.base,f.v2.base,f.v3.base)};f.prototype._isClipEdge=
function(a,b){return a.x===b.x?-64>=a.x||4160<=a.x:a.y===b.y?-64>=a.y||4160<=a.y:!1};return f}(e)})},"esri/views/2d/engine/webgl/LineTess":function(){define(["require","exports"],function(n,a){function c(a){var b={items:[],count:0},d;for(d=0;d<a;++d)b.items.push(void 0);return b}function q(a,b){C.vector[0]=a.vector[0];C.vector[1]=a.vector[1];C.texCoords[0]=a.texCoords[0];C.texCoords[1]=a.texCoords[1];C.direction[0]=a.direction[0];C.direction[1]=a.direction[1];C.base=a.base;a.vector[0]=b.vector[0];
a.vector[1]=b.vector[1];a.texCoords[0]=b.texCoords[0];a.texCoords[1]=b.texCoords[1];a.direction[0]=b.direction[0];a.direction[1]=b.direction[1];a.base=b.base;b.vector[0]=C.vector[0];b.vector[1]=C.vector[1];b.texCoords[0]=C.texCoords[0];b.texCoords[1]=C.texCoords[1];b.direction[0]=C.direction[0];b.direction[1]=C.direction[1];b.base=C.base}function g(a,b){return a[0]*b[0]+a[1]*b[1]}function e(a){return Math.sqrt(g(a,a))}function m(a,b){var d=e(b);a[0]=b[0]/d;a[1]=b[1]/d;return a}function b(a,b){a[0]=
-b[1];a[1]=b[0];return a}function f(a,b){return a[0]*b[1]-a[1]*b[0]}function l(a,b){a[0]=-b[0];a[1]=-b[1];return a}function d(a,b,d){a[0]=b[0]*d;a[1]=b[1]*d;return a}function p(a,b,d){a[0]=b[0]+d[0];a[1]=b[1]+d[1];return a}function t(a,b){a=g(a,b);return.999<a?0:-.999>a?Math.PI:Math.acos(a)}function A(a,b,f,l,g){if(0===l)a.count=0;else{var c=e(b),p=d(z[0],b,1/c);f=d(z[1],f,1/c);p=t(p,f);p=(g?-1:1)*p/l;g=Math.cos(p);p=Math.sin(p);f=b[0];var m=b[1];for(b=0;b<l-1;++b)c=f,f=g*c-p*m,m=p*c+g*m,a.items[b][0]=
f,a.items[b][1]=m;a.count=l-1}}function F(a){var b=a.count,d=Math.floor(b/2),f;for(f=0;f<d;++f){var l=a.items[f];a.items[f]=a.items[b-f-1];a.items[b-f-1]=l}}Object.defineProperty(a,"__esModule",{value:!0});var u;(function(a){a[a.ENTRY=1]="ENTRY";a[a.EXIT=2]="EXIT";a[a.CAP=3]="CAP"})(u=a.VectorRole||(a.VectorRole={}));var w;(function(a){a[a.START=1]="START";a[a.END=2]="END"})(w=a.CapPosition||(a.CapPosition={}));a.SYSTEM_MAG_LIMIT=3.8;a.MITER_SAFE_RADS=2*Math.acos(1/a.SYSTEM_MAG_LIMIT);var E=a.SYSTEM_MAG_LIMIT*
a.SYSTEM_MAG_LIMIT,D=16/(2*Math.PI);a.allocTriangles=function(a){var b={items:[],count:0},d;for(d=0;d<a;++d)b.items.push({v1:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]},v2:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]},v3:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]}});return b};a.allocExtrudeVectors=function(){var a={items:[],count:0},b;for(b=0;30>b;++b)a.items.push({vector:[void 0,void 0],texCoords:[void 0,
void 0],direction:[void 0,void 0]});b={};b[u.ENTRY]=c(20);b[u.EXIT]=c(20);b[u.CAP]=c(20);return{vectors:a,lists:b}};a.copyExtrudeVectors=function(a,b){var d;for(d=0;d<b.vectors.count;++d)a.vectors.items[d].vector[0]=b.vectors.items[d].vector[0],a.vectors.items[d].vector[1]=b.vectors.items[d].vector[1],a.vectors.items[d].texCoords[0]=b.vectors.items[d].texCoords[0],a.vectors.items[d].texCoords[1]=b.vectors.items[d].texCoords[1],a.vectors.items[d].direction[0]=b.vectors.items[d].direction[0],a.vectors.items[d].direction[1]=
b.vectors.items[d].direction[1],a.vectors.items[d].base=b.vectors.items[d].base;a.vectors.count=b.vectors.count;var f=b.lists[u.ENTRY],l=a.lists[u.ENTRY],g=b.lists[u.EXIT],e=a.lists[u.EXIT],c=b.lists[u.CAP],p=a.lists[u.CAP];for(d=0;d<f.count;++d)l.items[d]=f.items[d];l.count=f.count;for(d=0;d<g.count;++d)e.items[d]=g.items[d];e.count=g.count;for(d=0;d<c.count;++d)p.items[d]=c.items[d];p.count=c.count;a.capCenter=b.capCenter};var C={vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,
void 0],base:void 0};a.swapExtrudeVectors=q;var z=[];for(n=0;32>n;++n)z.push([void 0,void 0]);var x=function(a){var b={items:[],count:0},d;for(d=0;d<a;++d)b.items.push([void 0,void 0]);return b}(16);a.length=e;a.normalize=m;a.getNumberOfSlices=function(a){return Math.max(Math.round(a*D),1)};a.getRads=t;a.reverse=F;var v=[void 0,void 0],B=[void 0,void 0],J=[0,0],M=[0,0],P=[0,0],Q=[0,0],V=Math.cos(Math.PI/4),L=Math.sin(Math.PI/4),R=Math.sqrt(2);n=function(){function a(a){this._distanceAlongCorrection=
a.distanceAlongCorrection}a.prototype.bridge=function(a,b,d){var f=b.vectors;b=b.lists[u.EXIT];var l=d.vectors,g=d.lists[u.ENTRY],e,c;if(b.count===g.count+1)d=b.items,e=f.items,c=g.items,l=l.items;else if(g.count===b.count+1)d=g.items,e=l.items,c=b.items,l=f.items;else if(b.count===g.count)d=g.items,e=l.items,c=b.items,l=f.items;else{console.error("Cannot bridge "+b.count+" to "+g.count+".");a.count=0;return}f=b.count+g.count-2;a.count=f;v[0]=d;v[1]=c;B[0]=e;B[1]=l;for(b=0;b<f;++b)d=a.items[b],e=
(b+0)%2,e=B[e][v[e][Math.floor((b+0)/2)]],d.v1.vector[0]=e.vector[0],d.v1.vector[1]=e.vector[1],d.v1.texCoords[0]=e.texCoords[0],d.v1.texCoords[1]=e.texCoords[1],d.v1.direction[0]=e.direction[0],d.v1.direction[1]=e.direction[1],d.v1.base=e.base,e=(b+1)%2,e=B[e][v[e][Math.floor((b+1)/2)]],d.v2.vector[0]=e.vector[0],d.v2.vector[1]=e.vector[1],d.v2.texCoords[0]=e.texCoords[0],d.v2.texCoords[1]=e.texCoords[1],d.v2.direction[0]=e.direction[0],d.v2.direction[1]=e.direction[1],d.v2.base=e.base,e=(b+2)%2,
e=B[e][v[e][Math.floor((b+2)/2)]],d.v3.vector[0]=e.vector[0],d.v3.vector[1]=e.vector[1],d.v3.texCoords[0]=e.texCoords[0],d.v3.texCoords[1]=e.texCoords[1],d.v3.direction[0]=e.direction[0],d.v3.direction[1]=e.direction[1],d.v3.base=e.base,e=d.v1.base&&d.v1.base.point||J,c=d.v2.base&&d.v2.base.point||J,l=d.v3.base&&d.v3.base.point||J,M[0]=e[0]+d.v1.vector[0],M[1]=e[1]+d.v1.vector[1],P[0]=c[0]+d.v2.vector[0],P[1]=c[1]+d.v2.vector[1],Q[0]=l[0]+d.v3.vector[0],Q[1]=l[1]+d.v3.vector[1],0>(P[0]-M[0])*(Q[1]-
M[1])-(Q[0]-M[0])*(P[1]-M[1])||q(d.v2,d.v3)};a.prototype.pie=function(a,b){if(0===b.lists[u.CAP].count)a.count=0;else if(1===b.lists[u.CAP].count)console.error("A single vector is not enough to define a pie."),a.count=0;else{a.count=b.lists[u.CAP].count-1;var d;for(d=0;d<a.count;++d){var f=a.items[d],l=b.vectors.items[b.lists[u.CAP].items[d]];f.v1.vector[0]=l.vector[0];f.v1.vector[1]=l.vector[1];f.v1.texCoords[0]=l.texCoords[0];f.v1.texCoords[1]=l.texCoords[1];f.v1.direction[0]=l.direction[0];f.v1.direction[1]=
l.direction[1];f.v1.base=l.base;l=b.vectors.items[b.lists[u.CAP].items[d+1]];f.v2.vector[0]=l.vector[0];f.v2.vector[1]=l.vector[1];f.v2.texCoords[0]=l.texCoords[0];f.v2.texCoords[1]=l.texCoords[1];f.v2.direction[0]=l.direction[0];f.v2.direction[1]=l.direction[1];f.v2.base=l.base;l=b.vectors.items[b.capCenter];f.v3.vector[0]=l.vector[0];f.v3.vector[1]=l.vector[1];f.v3.texCoords[0]=l.texCoords[0];f.v3.texCoords[1]=l.texCoords[1];f.v3.direction[0]=l.direction[0];f.v3.direction[1]=l.direction[1];f.v3.base=
l.base;var l=f.v1.base&&f.v1.base.point||J,e=f.v2.base&&f.v2.base.point||J,g=f.v3.base&&f.v3.base.point||J;M[0]=l[0]+f.v1.vector[0];M[1]=l[1]+f.v1.vector[1];P[0]=e[0]+f.v2.vector[0];P[1]=e[1]+f.v2.vector[1];Q[0]=g[0]+f.v3.vector[0];Q[1]=g[1]+f.v3.vector[1];0>(P[0]-M[0])*(Q[1]-M[1])-(Q[0]-M[0])*(P[1]-M[1])||q(f.v2,f.v3)}}};a.prototype.buttCap=function(a,b,d){this.fastMiterJoin(a,b,d)};a.prototype.roundCap=function(a,b,d,f,l,e){void 0===e&&(e=0);this.fastMiterJoin(a,b,d);d=f===w.START?0:1;f=f===w.START?
1:0;a.capCenter=a.vectors.count;b=a.vectors.items[a.capCenter];b.vector[0]=0;b.vector[1]=0;b.texCoords[0]=0;b.texCoords[1]=0;b.direction[0]=0;b.direction[1]=0;++a.vectors.count;A(x,a.vectors.items[d].vector,a.vectors.items[f].vector,l,!1);l=a.vectors.count;b=a.lists[u.CAP];b.items[0]=d;d=a.vectors.items[d].texCoords[1];var g=a.vectors.items[f].texCoords[1],c;for(c=0;c<x.count;++c){var p=e*(1-Math.abs(x.count/2-c)/(x.count/2)),m=d+c/(x.count-1)*(g-d),t=x.items[c],q=a.vectors.items[l+c];q.vector[0]=
t[0];q.vector[1]=t[1];q.texCoords[0]=p;q.texCoords[1]=m;q.direction[0]=0;q.direction[1]=0;b.items[c+1]=l+c}b.items[x.count+1]=f;b.count=x.count+2;a.vectors.count=l+x.count};a.prototype.squareCap=function(a,b,f,l){this.fastMiterJoin(a,b,f);b=l===w.START?0:1;f=l===w.START?1:0;var e=z[0],g=z[1],c=z[2],p=z[3];l=z[4];var m=a.vectors.items[b].vector;e[0]=V*m[0]-L*m[1];e[1]=L*m[0]+V*m[1];d(p,e,R);g[0]=V*e[0]-L*e[1];g[1]=L*e[0]+V*e[1];c[0]=V*g[0]-L*g[1];c[1]=L*g[0]+V*g[1];d(l,c,R);b=a.vectors.items[b];b.vector[0]=
p[0];b.vector[1]=p[1];a=a.vectors.items[f];a.vector[0]=l[0];a.vector[1]=l[1]};a.prototype.fastMiterJoin=function(a,d,f){f=b(z[0],f);d=l(z[1],f);var e=a.vectors.items[0];e.vector[0]=f[0];e.vector[1]=f[1];e.texCoords[0]=0;e.texCoords[1]=-1;e.direction[0]=0;e.direction[1]=0;f=a.vectors.items[1];f.vector[0]=d[0];f.vector[1]=d[1];f.texCoords[0]=0;f.texCoords[1]=1;f.direction[0]=0;f.direction[1]=0;a.vectors.count=2;d=a.lists[u.ENTRY];d.items[0]=0;d.items[1]=1;d.count=2;d=a.lists[u.EXIT];d.items[0]=0;d.items[1]=
1;d.count=2;a.lists[u.CAP].count=0;a.capCenter=void 0};a.prototype.miterJoin=function(a,f,e){var c=b(z[0],f),p=b(z[1],e),t=z[2];t[0]=c[0]+p[0];t[1]=c[1]+p[1];p=m(z[3],t);c=g(p,c);p=d(z[4],p,1/c);c=l(z[5],p);this._distanceAlongCorrection?(t=a.vectors.items[0],t.vector[0]=p[0],t.vector[1]=p[1],t.texCoords[0]=0,t.texCoords[1]=-1,t.direction[0]=f[0],t.direction[1]=f[1],t=a.vectors.items[1],t.vector[0]=c[0],t.vector[1]=c[1],t.texCoords[0]=0,t.texCoords[1]=1,t.direction[0]=f[0],t.direction[1]=f[1],f=a.vectors.items[2],
f.vector[0]=p[0],f.vector[1]=p[1],f.texCoords[0]=0,f.texCoords[1]=-1,f.direction[0]=e[0],f.direction[1]=e[1],f=a.vectors.items[3],f.vector[0]=c[0],f.vector[1]=c[1],f.texCoords[0]=0,f.texCoords[1]=1,f.direction[0]=e[0],f.direction[1]=e[1],a.vectors.count=4,e=a.lists[u.ENTRY],e.items[0]=0,e.items[1]=1,e.count=2,e=a.lists[u.EXIT],e.items[0]=2,e.items[1]=3):(t=a.vectors.items[0],t.vector[0]=p[0],t.vector[1]=p[1],t.texCoords[0]=0,t.texCoords[1]=-1,t.direction[0]=0,t.direction[1]=0,t=a.vectors.items[1],
t.vector[0]=c[0],t.vector[1]=c[1],t.texCoords[0]=0,t.texCoords[1]=1,t.direction[0]=0,t.direction[1]=0,a.vectors.count=2,e=a.lists[u.ENTRY],e.items[0]=0,e.items[1]=1,e.count=2,e=a.lists[u.EXIT],e.items[0]=0,e.items[1]=1);e.count=2;a.lists[u.CAP].count=0;a.capCenter=void 0};a.prototype.bevelJoin=function(a,e,c,t){var q=t*t;t=f(e,c);var x=0<t?[-1,1]:[1,-1],w=x[0],x=x[1],A=0<t?l(z[0],b(z[1],e)):b(z[2],e),v=0<t?l(z[3],b(z[4],c)):b(z[5],c),C=z[6];C[0]=A[0]+v[0];C[1]=A[1]+v[1];var y=m(z[7],C),D=l(z[8],y),
B=g(y,A),C=f(y,A),J=Math.abs(C/B),C=1+J*J,n=C<E?[J,this._distanceAlongCorrection]:[Math.sqrt(E-1),!0],H=n[0],n=n[1],I=C<q?[J,this._distanceAlongCorrection]:[Math.sqrt(q-1),!0],J=I[0];(I=I[1])&&n?(n=a.vectors.items[0],p(n.vector,l(z[9],A),d(z[10],l(z[11],e),H)),n.texCoords[0]=0,n.texCoords[1]=w,n.direction[0]=this._distanceAlongCorrection?e[0]:0,n.direction[1]=this._distanceAlongCorrection?e[1]:0,D=a.vectors.items[1],p(D.vector,l(z[12],v),d(z[13],c,H)),D.texCoords[0]=0,D.texCoords[1]=w,D.direction[0]=
this._distanceAlongCorrection?c[0]:0,D.direction[1]=this._distanceAlongCorrection?c[1]:0,w=a.vectors.items[2],w.vector[0]=0,w.vector[1]=0,w.texCoords[0]=0,w.texCoords[1]=0,w.direction[0]=0,w.direction[1]=0,w=a.vectors.items[3],p(w.vector,A,d(z[14],e,J)),w.texCoords[0]=0,w.texCoords[1]=x,w.direction[0]=this._distanceAlongCorrection?e[0]:0,w.direction[1]=this._distanceAlongCorrection?e[1]:0,e=a.vectors.items[4],p(e.vector,v,d(z[15],l(z[16],c),J)),e.texCoords[0]=0,e.texCoords[1]=x,e.direction[0]=this._distanceAlongCorrection?
c[0]:0,e.direction[1]=this._distanceAlongCorrection?c[1]:0,a.vectors.count=5,c=a.lists[u.ENTRY],c.items[0]=0,c.items[1]=2,c.items[2]=3,c.count=3,c=a.lists[u.EXIT],c.items[0]=1,c.items[1]=2,c.items[2]=4,c.count=3,C<q?(q=a.lists[u.CAP],q.count=0,a.capCenter=void 0):(q=a.lists[u.CAP],q.items[0]=3,q.items[1]=4,q.count=2,a.capCenter=2)):!I&&n?(n=a.vectors.items[0],p(n.vector,l(z[9],A),d(z[10],l(z[11],e),H)),n.texCoords[0]=0,n.texCoords[1]=w,n.direction[0]=this._distanceAlongCorrection?e[0]:0,n.direction[1]=
this._distanceAlongCorrection?e[1]:0,D=a.vectors.items[1],p(D.vector,l(z[12],v),d(z[13],c,H)),D.texCoords[0]=0,D.texCoords[1]=w,D.direction[0]=this._distanceAlongCorrection?c[0]:0,D.direction[1]=this._distanceAlongCorrection?c[1]:0,w=a.vectors.items[2],w.vector[0]=0,w.vector[1]=0,w.texCoords[0]=0,w.texCoords[1]=0,w.direction[0]=0,w.direction[1]=0,w=a.vectors.items[3],d(w.vector,y,1/B),w.texCoords[0]=0,w.texCoords[1]=x,w.direction[0]=0,w.direction[1]=0,a.vectors.count=4,c=a.lists[u.ENTRY],c.items[0]=
0,c.items[1]=2,c.items[2]=3,c.count=3,c=a.lists[u.EXIT],c.items[0]=1,c.items[1]=2,c.items[2]=3,c.count=3,a.lists[u.CAP].count=0,a.capCenter=void 0):I&&!n?(n=a.vectors.items[0],d(n.vector,D,1/B),n.texCoords[0]=0,n.texCoords[1]=w,n.direction[0]=0,n.direction[1]=0,D=a.vectors.items[1],D.vector[0]=0,D.vector[1]=0,D.texCoords[0]=0,D.texCoords[1]=0,D.direction[0]=0,D.direction[1]=0,w=a.vectors.items[2],p(w.vector,A,d(z[9],e,J)),w.texCoords[0]=0,w.texCoords[1]=x,w.direction[0]=this._distanceAlongCorrection?
e[0]:0,w.direction[1]=this._distanceAlongCorrection?e[1]:0,w=a.vectors.items[3],p(w.vector,v,d(z[10],l(z[11],c),J)),w.texCoords[0]=0,w.texCoords[1]=x,w.direction[0]=this._distanceAlongCorrection?c[0]:0,w.direction[1]=this._distanceAlongCorrection?c[1]:0,a.vectors.count=4,c=a.lists[u.ENTRY],c.items[0]=0,c.items[1]=1,c.items[2]=2,c.count=3,c=a.lists[u.EXIT],c.items[0]=0,c.items[1]=1,c.items[2]=3,c.count=3,C<q?(q=a.lists[u.CAP],q.count=0,a.capCenter=void 0):(q=a.lists[u.CAP],q.items[0]=2,q.items[1]=
3,q.count=2,a.capCenter=1)):I||n||(n=a.vectors.items[0],d(n.vector,D,1/B),n.texCoords[0]=0,n.texCoords[1]=w,n.direction[0]=0,n.direction[1]=0,D=a.vectors.items[1],d(D.vector,y,1/B),D.texCoords[0]=0,D.texCoords[1]=x,D.direction[0]=0,D.direction[1]=0,a.vectors.count=2,c=a.lists[u.ENTRY],c.items[0]=0,c.items[1]=1,c.count=2,c=a.lists[u.EXIT],c.items[0]=0,c.items[1]=1,c.count=2,a.lists[u.CAP].count=0,a.capCenter=void 0);0>t&&(F(a.lists[u.ENTRY]),F(a.lists[u.EXIT]))};a.prototype.roundJoin=function(a,e,
c,t){var q=f(e,c),w=0<q?[-1,1]:[1,-1],v=w[0],w=w[1],C=0<q?l(z[0],b(z[1],e)):b(z[2],e),D=0<q?l(z[3],b(z[4],c)):b(z[5],c),n=z[6];n[0]=C[0]+D[0];n[1]=C[1]+D[1];var y=m(z[7],n),n=l(z[8],y),J=g(y,C),y=f(y,C),y=Math.abs(y/J),B=1+y*y<E?[y,this._distanceAlongCorrection]:[Math.sqrt(E-1),!0],y=B[0];B[1]?(B=a.vectors.items[0],B.vector[0]=C[0],B.vector[1]=C[1],B.texCoords[0]=0,B.texCoords[1]=w,B.direction[0]=0,B.direction[1]=0,B=a.vectors.items[1],B.vector[0]=D[0],B.vector[1]=D[1],B.texCoords[0]=0,B.texCoords[1]=
w,B.direction[0]=0,B.direction[1]=0,B=a.vectors.items[2],p(B.vector,l(z[9],C),d(z[10],l(z[11],e),y)),B.texCoords[0]=0,B.texCoords[1]=v,B.direction[0]=this._distanceAlongCorrection?e[0]:0,B.direction[1]=this._distanceAlongCorrection?e[1]:0,e=a.vectors.items[3],p(e.vector,l(z[12],D),d(z[13],c,y)),e.texCoords[0]=0,e.texCoords[1]=v,e.direction[0]=this._distanceAlongCorrection?c[0]:0,e.direction[1]=this._distanceAlongCorrection?c[1]:0,c=a.vectors.items[4],c.vector[0]=0,c.vector[1]=0,c.texCoords[0]=0,c.texCoords[1]=
0,c.direction[0]=0,c.direction[1]=0,a.vectors.count=5,c=a.lists[u.ENTRY],c.items[0]=2,c.items[1]=4,c.items[2]=0,c.count=3,c=a.lists[u.EXIT],c.items[0]=3,c.items[1]=4,c.items[2]=1,c.count=3,a.capCenter=4):(B=a.vectors.items[0],B.vector[0]=C[0],B.vector[1]=C[1],B.texCoords[0]=0,B.texCoords[1]=w,B.direction[0]=0,B.direction[1]=0,B=a.vectors.items[1],B.vector[0]=D[0],B.vector[1]=D[1],B.texCoords[0]=0,B.texCoords[1]=w,B.direction[0]=0,B.direction[1]=0,B=a.vectors.items[2],d(B.vector,n,1/J),B.texCoords[0]=
0,B.texCoords[1]=v,B.direction[0]=0,B.direction[1]=0,e=a.vectors.items[3],e.vector[0]=0,e.vector[1]=0,e.texCoords[0]=0,e.texCoords[1]=0,e.direction[0]=0,e.direction[1]=0,a.vectors.count=4,c=a.lists[u.ENTRY],c.items[0]=2,c.items[1]=3,c.items[2]=0,c.count=3,c=a.lists[u.EXIT],c.items[0]=2,c.items[1]=3,c.items[2]=1,c.count=3,a.capCenter=3);A(x,C,D,t,0>q);t=a.vectors.count;C=a.lists[u.CAP];for(D=C.items[0]=0;D<x.count;++D)c=x.items[D],v=a.vectors.items[t+D],v.vector[0]=c[0],v.vector[1]=c[1],v.texCoords[0]=
0,v.texCoords[1]=w,v.direction[0]=0,v.direction[1]=0,C.items[D+1]=t+D;C.items[x.count+1]=1;C.count=x.count+2;a.vectors.count=t+x.count;0>q&&(F(a.lists[u.ENTRY]),F(a.lists[u.EXIT]))};a.prototype.unitRoundJoin=function(a,d,e,c){var g=f(d,e),p=0<g?[-1,1]:[1,-1],m=p[0],p=p[1];d=0<g?l(z[0],b(z[1],d)):b(z[2],d);e=0<g?l(z[3],b(z[4],e)):b(z[5],e);var t=a.vectors.items[0];t.vector[0]=d[0];t.vector[1]=d[1];t.texCoords[0]=0;t.texCoords[1]=p;t.direction[0]=0;t.direction[1]=0;t=a.vectors.items[1];t.vector[0]=
e[0];t.vector[1]=e[1];t.texCoords[0]=0;t.texCoords[1]=p;t.direction[0]=0;t.direction[1]=0;t=a.vectors.items[2];l(t.vector,d);t.texCoords[0]=0;t.texCoords[1]=m;t.direction[0]=0;t.direction[1]=0;t=a.vectors.items[3];l(t.vector,e);t.texCoords[0]=0;t.texCoords[1]=m;t.direction[0]=0;t.direction[1]=0;m=a.vectors.items[4];m.vector[0]=0;m.vector[1]=0;m.texCoords[0]=0;m.texCoords[1]=0;m.direction[0]=0;m.direction[1]=0;a.vectors.count=5;m=a.lists[u.ENTRY];m.items[0]=2;m.items[1]=0;m.count=2;m=a.lists[u.EXIT];
m.items[0]=3;m.items[1]=1;m.count=2;a.capCenter=4;A(x,d,e,c,0>g);c=a.vectors.count;d=a.lists[u.CAP];for(m=d.items[0]=0;m<x.count;++m)e=x.items[m],t=a.vectors.items[c+m],t.vector[0]=e[0],t.vector[1]=e[1],t.texCoords[0]=0,t.texCoords[1]=p,t.direction[0]=0,t.direction[1]=0,d.items[m+1]=c+m;d.items[x.count+1]=1;d.count=x.count+2;a.vectors.count=c+x.count;0>g&&(F(a.lists[u.ENTRY]),F(a.lists[u.EXIT]))};a.prototype.rectJoin=function(a,d,f){d=b(z[0],d);f=b(z[1],f);var e=a.vectors.items[0];e.vector[0]=d[0];
e.vector[1]=d[1];e.texCoords[0]=0;e.texCoords[1]=-1;e.direction[0]=0;e.direction[1]=0;e=a.vectors.items[1];e.vector[0]=f[0];e.vector[1]=f[1];e.texCoords[0]=0;e.texCoords[1]=-1;e.direction[0]=0;e.direction[1]=0;e=a.vectors.items[2];l(e.vector,d);e.texCoords[0]=0;e.texCoords[1]=1;e.direction[0]=0;e.direction[1]=0;d=a.vectors.items[3];l(d.vector,f);d.texCoords[0]=0;d.texCoords[1]=1;d.direction[0]=0;d.direction[1]=0;a.vectors.count=4;d=a.lists[u.ENTRY];d.items[0]=0;d.items[1]=2;d.count=2;d=a.lists[u.EXIT];
d.items[0]=1;d.items[1]=3;d.count=2;a.capCenter=void 0};return a}();a.Tessellator=n})},"esri/views/vectorTiles/style/StyleLayer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ./Filter ./StyleDefinition ./StyleProperty".split(" "),function(n,a,c,q,g,e,m){Object.defineProperty(a,"__esModule",{value:!0});n=function(){function a(a,b,d){this.type=a;this.id=b.id;this.source=b.source;this.sourceLayer=b["source-layer"];this.minzoom=b.minzoom;
this.maxzoom=b.maxzoom;this.filter=b.filter;this.layout=b.layout;this.paint=b.paint;this.z=d;switch(a){case 0:this._layoutDefinition=e.StyleDefinition.backgroundLayoutDefinition;this._paintDefinition=e.StyleDefinition.backgroundPaintDefinition;break;case 1:this._layoutDefinition=e.StyleDefinition.fillLayoutDefinition;this._paintDefinition=e.StyleDefinition.fillPaintDefinition;break;case 2:this._layoutDefinition=e.StyleDefinition.lineLayoutDefinition;this._paintDefinition=e.StyleDefinition.linePaintDefinition;
break;case 3:this._layoutDefinition=e.StyleDefinition.symbolLayoutDefinition;this._paintDefinition=e.StyleDefinition.symbolPaintDefinition;break;case 4:this._layoutDefinition=e.StyleDefinition.circleLayoutDefinition,this._paintDefinition=e.StyleDefinition.circlePaintDefinition}this._layoutProperties=this._parseLayout(this.layout);this._paintProperties=this._parsePaint(this.paint)}a.prototype.getFeatureFilter=function(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=g.createFilter(this.filter)};
a.prototype.getLayoutProperty=function(a){var b=this._layoutProperties;if(b)return b[a]};a.prototype.getPaintProperty=function(a){var b=this._paintProperties;if(b)return b[a]};a.prototype.getLayoutValue=function(a,b,d){var f,e=this._layoutProperties;e&&(e=e[a])&&(f=e.getValue(b,d));a=this._layoutDefinition[a];void 0===f&&(f=a["default"]);"enum"===a.type&&(f=a.values.indexOf(f));return f};a.prototype.getPaintValue=function(a,b,d){var f,e=this._paintProperties;e&&(e=e[a])&&(f=e.getValue(b,d));a=this._paintDefinition[a];
void 0===f&&(f=a["default"]);"enum"===a.type&&(f=a.values.indexOf(f));return f};a.prototype._parseLayout=function(a){var b={},d;for(d in a){var f=this._layoutDefinition[d];f&&(b[d]=new m(d,f,a[d]))}return b};a.prototype._parsePaint=function(a){var b={},d;for(d in a){var f=this._paintDefinition[d];f&&(b[d]=new m(d,f,a[d]))}return b};return a}();a.StyleLayer=n;q=function(a){function b(b,d,f){return a.call(this,b,d,f)||this}c(b,a);return b}(n);a.BackgroundStyleLayer=q;q=function(a){function b(b,d,f){b=
a.call(this,b,d,f)||this;d=b.getPaintProperty("fill-color");b.hasDataDrivenColor=d?d.isDataDriven:!1;d=b.getPaintProperty("fill-opacity");b.hasDataDrivenOpacity=d?d.isDataDriven:!1;b.hasDataDrivenFill=b.hasDataDrivenColor||b.hasDataDrivenOpacity;d=b.getPaintProperty("fill-outline-color");b.outlineUsesFillColor=!d;b.hasDataDrivenOutlineColor=d?d.isDataDriven:!1;b.hasDataDrivenOutline=(d?b.hasDataDrivenOutlineColor:b.hasDataDrivenColor)||b.hasDataDrivenOpacity;return b}c(b,a);return b}(n);a.FillStyleLayer=
q;q=function(a){function b(b,d,f){b=a.call(this,b,d,f)||this;d=b.getPaintProperty("line-color");b.hasDataDrivenColor=d?d.isDataDriven:!1;d=b.getPaintProperty("line-opacity");b.hasDataDrivenOpacity=d?d.isDataDriven:!1;d=b.getPaintProperty("line-width");b.hasDataDrivenWidth=d?d.isDataDriven:!1;b.hasDataDrivenLine=b.hasDataDrivenColor||b.hasDataDrivenOpacity||b.hasDataDrivenWidth;return b}c(b,a);return b}(n);a.LineStyleLayer=q;q=function(a){function b(b,d,f){b=a.call(this,b,d,f)||this;d=b.getPaintProperty("icon-color");
b.hasDataDrivenIconColor=d?d.isDataDriven:!1;d=b.getPaintProperty("icon-opacity");b.hasDataDrivenIconOpacity=d?d.isDataDriven:!1;d=b.getLayoutProperty("icon-size");b.hasDataDrivenIconSize=d?d.isDataDriven:!1;b.hasDataDrivenIcon=b.hasDataDrivenIconColor||b.hasDataDrivenIconOpacity||b.hasDataDrivenIconSize;d=b.getPaintProperty("text-color");b.hasDataDrivenTextColor=d?d.isDataDriven:!1;d=b.getPaintProperty("text-opacity");b.hasDataDrivenTextOpacity=d?d.isDataDriven:!1;d=b.getLayoutProperty("text-size");
b.hasDataDrivenTextSize=d?d.isDataDriven:!1;b.hasDataDrivenText=b.hasDataDrivenTextColor||b.hasDataDrivenTextOpacity||b.hasDataDrivenTextSize;return b}c(b,a);return b}(n);a.SymbolStyleLayer=q;n=function(a){function b(b,d,f){b=a.call(this,b,d,f)||this;d=b.getPaintProperty("circle-radius");b.hasDataDrivenRadius=d?d.isDataDriven:!1;d=b.getPaintProperty("circle-color");b.hasDataDrivenColor=d?d.isDataDriven:!1;d=b.getPaintProperty("circle-opacity");b.hasDataDrivenOpacity=d?d.isDataDriven:!1;d=b.getPaintProperty("circle-stroke-width");
b.hasDataDrivenStrokeWidth=d?d.isDataDriven:!1;d=b.getPaintProperty("circle-stroke-color");b.hasDataDrivenStrokeColor=d?d.isDataDriven:!1;d=b.getPaintProperty("circle-stroke-opacity");b.hasDataDrivenStrokeOpacity=d?d.isDataDriven:!1;d=b.getPaintProperty("circle-blur");b.hasDataDrivenBlur=d?d.isDataDriven:!1;return b}c(b,a);return b}(n);a.CircleStyleLayer=n;n=function(){return function(a,f,e){this.cap=a.getLayoutValue("line-cap",f,e);this.join=a.getLayoutValue("line-join",f,e);this.miterLimit=a.getLayoutValue("line-miter-limit",
f,e);this.roundLimit=a.getLayoutValue("line-round-limit",f,e)}}();a.LineLayout=n;n=function(){return function(a,f,e,d){this.allowOverlap=a.getLayoutValue("icon-allow-overlap",f,d);this.ignorePlacement=a.getLayoutValue("icon-ignore-placement",f,d);this.optional=a.getLayoutValue("icon-optional",f,d);this.rotationAlignment=a.getLayoutValue("icon-rotation-alignment",f,d);this.size=a.getLayoutValue("icon-size",f,d);this.rotate=a.getLayoutValue("icon-rotate",f,d);this.padding=a.getLayoutValue("icon-padding",
f,d);this.keepUpright=a.getLayoutValue("icon-keep-upright",f,d);this.offset=a.getLayoutValue("icon-offset",f,d);2===this.rotationAlignment&&(this.rotationAlignment=e?0:1)}}();a.IconLayout=n;n=function(){return function(a,f,e,d){this.allowOverlap=a.getLayoutValue("text-allow-overlap",f,d);this.ignorePlacement=a.getLayoutValue("text-ignore-placement",f,d);this.optional=a.getLayoutValue("text-optional",f,d);this.rotationAlignment=a.getLayoutValue("text-rotation-alignment",f,d);this.fontArray=a.getLayoutValue("text-font",
f,d);this.maxWidth=a.getLayoutValue("text-max-width",f,d);this.lineHeight=a.getLayoutValue("text-line-height",f,d);this.letterSpacing=a.getLayoutValue("text-letter-spacing",f,d);this.justify=a.getLayoutValue("text-justify",f,d);this.anchor=a.getLayoutValue("text-anchor",f,d);this.maxAngle=a.getLayoutValue("text-max-angle",f,d);this.size=a.getLayoutValue("text-size",f,d);this.rotate=a.getLayoutValue("text-rotate",f,d);this.padding=a.getLayoutValue("text-padding",f,d);this.keepUpright=a.getLayoutValue("text-keep-upright",
f,d);this.transform=a.getLayoutValue("text-transform",f,d);this.offset=a.getLayoutValue("text-offset",f,d);2===this.rotationAlignment&&(this.rotationAlignment=e?0:1)}}();a.TextLayout=n})},"esri/views/vectorTiles/style/Filter":function(){define(["require","exports"],function(n,a){return function(){function a(c,g,e){this._op=c;"$type"===g?(this._val=e instanceof Array?e.map(function(e){return a._types.indexOf(e)}):a._types.indexOf(e),this._op+=11):(this._key=g,this._val=e)}a.prototype.filter=function(a){switch(this._op){case 0:return this._val;
case 1:return a.values[this._key]===this._val;case 2:return a.values[this._key]!==this._val;case 3:return a.values[this._key]<this._val;case 4:return a.values[this._key]>this._val;case 5:return a.values[this._key]<=this._val;case 6:return a.values[this._key]>=this._val;case 7:return-1!==this._val.indexOf(a.values[this._key]);case 8:return-1===this._val.indexOf(a.values[this._key]);case 9:for(var c=0,e=this._val;c<e.length;c++){var m=e[c];if(m.filter(a))return!0}return!1;case 10:c=0;for(e=this._val;c<
e.length;c++)if(m=e[c],!m.filter(a))return!1;return!0;case 11:c=0;for(e=this._val;c<e.length;c++)if(m=e[c],m.filter(a))return!1;return!0;case 12:return a.type===this._val;case 13:return a.type!==this._val;case 14:return a.type<this._val;case 15:return a.type>this._val;case 16:return a.type>=this._val;case 17:return a.type<=this._val;case 18:return-1!==this._val.indexOf(a.type);case 19:return-1===this._val.indexOf(a.type)}};a.createFilter=function(c){if(!c)return new a(0,void 0,!0);var g=c[0];if(1>=
c.length)return new a(0,void 0,"any"!==g);switch(g){case "\x3d\x3d":return new a(1,c[1],c[2]);case "!\x3d":return new a(2,c[1],c[2]);case "\x3e":return new a(4,c[1],c[2]);case "\x3c":return new a(3,c[1],c[2]);case "\x3e\x3d":return new a(6,c[1],c[2]);case "\x3c\x3d":return new a(5,c[1],c[2]);case "in":return new a(7,c[1],c.slice(2));case "!in":return new a(8,c[1],c.slice(2));case "any":return new a(9,void 0,c.slice(1).map(a.createFilter.bind(this)));case "all":return new a(10,void 0,c.slice(1).map(a.createFilter.bind(this)));
case "none":return new a(11,void 0,c.slice(1).map(a.createFilter.bind(this)));default:throw Error("invalid operator: "+g);}};a._types=["Unknown","Point","LineString","Polygon"];return a}()})},"esri/views/vectorTiles/style/StyleDefinition":function(){define(["require","exports"],function(n,a){Object.defineProperty(a,"__esModule",{value:!0});n=function(){function a(){}a.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"}};a.fillLayoutDefinition={visibility:{type:"enum",
values:["visible","none"],default:"visible"}};a.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"},"line-cap":{type:"enum",values:["butt","round","square"],default:"butt"},"line-join":{type:"enum",values:["bevel","round","miter"],default:"miter"},"line-miter-limit":{type:"number",default:2},"line-round-limit":{type:"number",default:1.05}};a.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"},"symbol-placement":{type:"enum",
values:["point","line"],default:"point"},"symbol-spacing":{type:"number",minimum:1,default:250},"symbol-avoid-edges":{type:"boolean",default:!1},"icon-image":{type:"string"},"icon-allow-overlap":{type:"boolean",default:!1},"icon-ignore-placement":{type:"boolean",default:!1},"icon-optional":{type:"boolean",default:!1},"icon-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:"auto"},"icon-size":{type:"number",minimum:0,default:1},"icon-rotate":{type:"number",default:0},"icon-padding":{type:"number",
minimum:0,default:2},"icon-keep-upright":{type:"boolean",default:!1},"icon-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-field":{type:"string"},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:"auto"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"]},"text-size":{type:"number",minimum:0,default:16},"text-max-width":{type:"number",minimum:0,default:10},"text-line-height":{type:"number",default:1.2},
"text-letter-spacing":{type:"number",default:0},"text-justify":{type:"enum",values:["left","center","right"],default:"center"},"text-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),default:"center"},"text-max-angle":{type:"number",minimum:0,default:45},"text-rotate":{type:"number",default:0},"text-padding":{type:"number",minimum:0,default:2},"text-keep-upright":{type:"boolean",default:!0},"text-transform":{type:"enum",values:["none",
"uppercase","lowercase"],default:"none"},"text-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-allow-overlap":{type:"boolean",default:!1},"text-ignore-placement":{type:"boolean",default:!1},"text-optional":{type:"boolean",default:!1}};a.circleLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"}};a.backgroundPaintDefinition={"background-opacity":{type:"number",minimum:0,maximum:1,default:1},"background-color":{type:"color",default:[0,0,0,1]},"background-pattern":{type:"string"}};
a.fillPaintDefinition={"fill-opacity":{type:"number",minimum:0,maximum:1,default:1},"fill-antialias":{type:"boolean",default:!0},"fill-color":{type:"color",default:[0,0,0,1]},"fill-outline-color":{type:"color",default:[0,0,0,0]},"fill-translate":{type:"array",value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"},"fill-pattern":{type:"string"}};a.linePaintDefinition={"line-opacity":{type:"number",minimum:0,maximum:1,default:1},"line-color":{type:"color",
default:[0,0,0,1]},"line-translate":{type:"array",value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"},"line-width":{type:"number",minimum:0,default:1},"line-gap-width":{type:"number",minimum:0,default:0},"line-offset":{type:"number",default:0},"line-blur":{type:"number",minimum:0,default:0},"line-dasharray":{type:"array",value:"number",default:[]},"line-pattern":{type:"string"}};a.symbolPaintDefinition={"icon-opacity":{type:"number",
minimum:0,maximum:1,default:1},"icon-color":{type:"color",default:[0,0,0,1]},"icon-halo-color":{type:"color",default:[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,default:0},"icon-halo-blur":{type:"number",minimum:0,default:0},"icon-translate":{type:"array",value:"number",length:2,default:[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"},"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-color":{type:"color",
default:[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,default:0},"text-halo-blur":{type:"number",minimum:0,default:0},"text-translate":{type:"array",value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"}};a.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",
minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",minimum:-1,maximum:1,default:0},"raster-contrast":{type:"number",minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}};a.circlePaintDefinition={"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",minimum:0,default:5},"circle-color":{type:"color",default:[0,0,0,1]},"circle-blur":{type:"number",minimum:0,default:0},"circle-translate":{type:"array",value:"number",
length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"},"circle-stroke-width":{type:"number",minimum:0,default:0},"circle-stroke-color":{type:"color",default:[0,0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,maximum:1,default:1}};return a}();a.StyleDefinition=n})},"esri/views/vectorTiles/style/StyleProperty":function(){define(["require","exports","../../../Color","../GeometryUtils"],function(n,a,c,q){return function(){function a(e,c,b){this.isDataDriven=
!1;switch(c.type){case "number":e=!0;break;case "color":e=!0;b=a._parseColor(b);break;case "array":e="number"===c.value;break;default:e=!1}null==b&&(b=c.default);e&&"interval"===b.type&&(e=!1);var f=b&&b.stops&&0<b.stops.length;if(f)for(var l=0,d=b.stops;l<d.length;l++){var g=d[l];g[1]=this._validate(g[1],c)}if(this.isDataDriven=b?!!b.property:!1)if(void 0!==b.default&&(b.default=this._validate(b.default,c)),f)switch(b.type){case "identity":this.getValue=this._buildIdentity(b,c);break;case "categorical":this.getValue=
this._buildCategorical(b,c);break;default:this.getValue=e?this._buildInterpolate(b,c):this._buildInterval(b,c)}else this.getValue=this._buildIdentity(b,c);else f?this.getValue=e?this._buildZoomInterpolate(b):this._buildZoomInterval(b):(b=this._validate(b,c),this.getValue=this._buildSimple(b))}a.prototype._validate=function(a,c){if("number"===c.type){if(a<c.minimum)return c.minimum;if(a>c.maximum)return c.maximum}return a};a.prototype._buildSimple=function(a){return function(){return a}};a.prototype._buildIdentity=
function(e,c){var b=this;return function(f,l){var d;l&&(d=l.values[e.property],"color"===c.type&&(d=a._parseColor(d)));void 0===d&&(d=e.default);return void 0!==d?b._validate(d,c):c.default}};a.prototype._buildCategorical=function(a,c){var b=this;return function(f,e){var d;e&&(d=e.values[a.property]);d=b._categorical(d,a.stops);return void 0!==d?d:void 0!==a.default?a.default:c.default}};a.prototype._buildInterval=function(a,c){var b=this;return function(f,e){var d;e&&(d=e.values[a.property]);return"number"===
typeof d?b._interval(d,a.stops):void 0!==a.default?a.default:c.default}};a.prototype._buildInterpolate=function(a,c){var b=this;return function(f,e){var d;e&&(d=e.values[a.property]);return"number"===typeof d?b._interpolate(d,a.stops,a.base||1):void 0!==a.default?a.default:c.default}};a.prototype._buildZoomInterpolate=function(a){var e=this;return function(b){return e._interpolate(b,a.stops,a.base||1)}};a.prototype._buildZoomInterval=function(a){var e=this;return function(b){return e._interval(b,
a.stops)}};a.prototype._categorical=function(a,c){for(var b=c.length,f=0;f<b;f++)if(c[f][0]===a)return c[f][1]};a.prototype._interval=function(a,c){for(var b=c.length,f=0,e=0;e<b;e++)if(c[e][0]<=a)f=e;else break;return c[f][1]};a.prototype._interpolate=function(a,c,b){for(var f,e,d=c.length,g=0;g<d;g++){var m=c[g];if(m[0]<=a)f=m;else{e=m;break}}if(f&&e){g=e[0]-f[0];a-=f[0];b=1===b?a/g:(Math.pow(b,a)-1)/(Math.pow(b,g)-1);if(Array.isArray(f[1])){f=f[1];e=e[1];a=[];for(g=0;g<f.length;g++)a.push(q.interpolate(f[g],
e[g],b));return a}return q.interpolate(f[1],e[1],b)}if(f)return f[1];if(e)return e[1]};a._isEmpty=function(a){for(var e in a)if(a.hasOwnProperty(e))return!1;return!0};a._parseColor=function(e){if(Array.isArray(e))return e;if("string"===typeof e){if(e=new c(e),!this._isEmpty(e))return c.toUnitRGBA(e)}else return e&&e.default&&(e.default=a._parseColor(e.default)),e&&e.stops&&(e.stops=e.stops.map(function(e){return[e[0],a._parseColor(e[1])]})),e};return a}()})},"esri/Color":function(){define(["./core/declare",
"./core/accessorSupport/ensureType","dojo/colors"],function(n,a,c){function q(e){return Math.max(0,Math.min(a.ensureInteger(e),255))}var g=n([c],{declaredClass:"esri.Color",toJSON:function(){return[q(this.r),q(this.g),q(this.b),1<this.a?this.a:q(255*this.a)]},clone:function(){return new g(this.toRgba())}});g.toJSON=function(a){return a&&[q(a.r),q(a.g),q(a.b),1<a.a?a.a:q(255*a.a)]};g.fromJSON=function(a){return a&&new g([a[0],a[1],a[2],a[3]/255])};g.toUnitRGB=function(a){return[a.r/255,a.g/255,a.b/
255]};g.toUnitRGBA=function(a){return[a.r/255,a.g/255,a.b/255,null!=a.a?a.a:1]};var e="named blendColors fromRgb fromHex fromArray fromString".split(" ");for(n=0;n<e.length;n++)g[e[n]]=c[e[n]];g.named.rebeccapurple=[102,51,153];return g})},"esri/core/declare":function(){define(["require","exports","dojo/_base/declare"],function(n,a,c){function q(a,f){a&&!Array.isArray(a)&&"function"!==typeof a&&(f=a,a=null);a=a||[];f=f||{};return g([this].concat(a),f)}function g(a,f){a&&!Array.isArray(a)&&"function"!==
typeof a&&(f=a,a=null);"function"===typeof a?a=[a]:a||(a=[]);f=f||{};var b,d;b=0;for(d=e.length;b<d;b++)e[b](a,f);a=c(a,f);a.createSubclass=q;b=0;for(d=m.length;b<d;b++)m[b](a);return a}var e=[],m=[];(function(a){a.hasMixin=function(a,b){a=Array.isArray(a)?a.reduce(function(a,b){return b._meta?a.concat(b._meta.bases):a},[]):a._meta?a._meta.bases:a;if(!a)return!1;if("string"===typeof b)for(var d=a.length-1;0<=d;d--)if(a[d].prototype.declaredClass===b)return!0;return-1!==a.indexOf(b)};a.safeMixin=function(a,
b){return c.safeMixin(a,b)};a.before=function(a){e.push(a)};a.after=function(a){m.push(a)}})(g||(g={}));return g})},"esri/core/accessorSupport/ensureType":function(){define(["require","exports","../Logger"],function(n,a,c){function q(a,b){return b.isInstanceOf?b.isInstanceOf(a):b instanceof a}function g(a){return null==a?a:new Date(a)}function e(a){return null==a?a:!!a}function m(a){return null==a?a:a.toString()}function b(a){return null==a?a:parseFloat(a)}function f(a){return null==a?a:Math.round(parseFloat(a))}
function l(a){return a&&a.constructor&&void 0!==a.constructor._meta}function d(a,b){return null!=b&&a&&!q(a,b)}function p(a,b){d(a,b)&&(l(b)?D.error("Accessor#set","Assigning an instance of '"+(b.declaredClass||"unknown")+"' which is not a subclass of '"+(a&&a.prototype&&a.prototype.declaredClass||"unknown")+"'"):b=new a(b));return b}function t(a){switch(a){case Number:return b;case C:return f;case Boolean:return e;case String:return m;case Date:return g;default:return p.bind(null,a)}}function A(a,
b){var d=t(a);return 1===arguments.length?d:d(b)}function F(a,b){return 1===arguments.length?F.bind(null,a):b?Array.isArray(b)?b.map(a):[a(b)]:b}function u(a,b,d){return 0!==b&&Array.isArray(d)?d.map(function(d){return u(a,b-1,d)}):a(d)}function w(a,b,d){if(2===arguments.length)return w.bind(null,a,b);if(!d)return d;d=u(a,b,d);for(var f=b,e=d;0<f&&Array.isArray(e);)f--,e=e[0];if(void 0!==e)for(e=0;e<f;e++)d=[d];return d}function E(a,b){if(2===arguments.length)return E(a).call(null,b);var f={},e=[],
c=[],g;for(g in a.typeMap){var p=a.typeMap[g];f[g]=A(p);e.push(p&&p.prototype&&p.prototype.declaredClass||"unknown");c.push(g)}var m="string"===typeof a.key?function(b){return b[a.key]}:a.key;return function(b){if(a.base&&!d(a.base,b))return b;var g=m(b)||a.defaultKeyValue,p=f[g];if(!p)return D.error("Accessor#set","Invalid property value, value needs to be one of "+("'"+e.join("', '")+"'")+", or a plain object that can autocast (having .type \x3d "+("'"+c.join("', '")+"'")+")"),null;if(!d(a.typeMap[g],
b))return b;if("string"!==typeof a.key||l(b))return p(b);var g={},t;for(t in b)t!==a.key&&(g[t]=b[t]);return p(g)}}Object.defineProperty(a,"__esModule",{value:!0});var D=c.getLogger("esri.core.Accessor");a.isInstanceOf=q;a.ensureDate=g;a.ensureBoolean=e;a.ensureString=m;a.ensureNumber=b;a.ensureInteger=f;a.isClassedType=l;a.requiresType=d;a.ensureClass=p;a.ensureType=A;a.ensureArrayTyped=F;a.ensureArray=function(a,b){return 1===arguments.length?F(A.bind(null,a)):F(A.bind(null,a),b)};a.ensureNArrayTyped=
w;a.ensureNArray=function(a,b,d){return 2===arguments.length?w(A.bind(null,a),b):w(A.bind(null,a),b,d)};a.ensureOneOfType=E;var C=function(){return function(){}}();a.Integer=C;a.default=A})},"esri/core/Logger":function(){define(["require","exports","dojo/has"],function(n,a,c){var q={info:0,warn:1,error:2};n=function(){function a(e){void 0===e&&(e={});this.module=e.module||"";this.writer=e.writer||null;this.level=e.level||null;null!=e.enabled&&(this.enabled=!!e.enabled);a._loggers[this.module]=this;
e=this.module.lastIndexOf(".");-1!==e&&(this.parent=a.getLogger(this.module.slice(0,e)))}a.prototype.log=function(a){for(var e=[],b=1;b<arguments.length;b++)e[b-1]=arguments[b];this._isEnabled()&&this._matchLevel(a)&&(b=this._inheritedWriter())&&b.apply(void 0,[a,this.module].concat(e))};a.prototype.error=function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];this.log.apply(this,["error"].concat(a))};a.prototype.warn=function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];
this.log.apply(this,["warn"].concat(a))};a.prototype.info=function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];this.log.apply(this,["info"].concat(a))};a.prototype.getLogger=function(e){return a.getLogger(this.module+"."+e)};a.getLogger=function(e){var c=a._loggers[e];c||(c=new a({module:e}));return c};a.prototype._parentWithMember=function(a,c){for(var b=this;b&&null==b[a];)b=b.parent;return b?b[a]:c};a.prototype._inheritedWriter=function(){return this._parentWithMember("writer",
this._consoleWriter)};a.prototype._consoleWriter=function(a,c){for(var b=[],f=2;f<arguments.length;f++)b[f-2]=arguments[f];console[a].apply(console,["["+c+"]"].concat(b))};a.prototype._matchLevel=function(a){return q[this._parentWithMember("level","error")]<=q[a]};a.prototype._isEnabled=function(){return this._parentWithMember("enabled",!0)};a._loggers={};return a}();n.getLogger("esri").level="warn";return n})},"dojo/colors":function(){define(["./_base/kernel","./_base/lang","./_base/Color","./_base/array"],
function(n,a,c,q){var g={};a.setObject("dojo.colors",g);var e=function(a,f,e){0>e&&++e;1<e&&--e;var b=6*e;return 1>b?a+(f-a)*b:1>2*e?f:2>3*e?a+(f-a)*(2/3-e)*6:a};n.colorFromRgb=c.fromRgb=function(a,f){var b=a.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(b){a=b[2].split(/\s*,\s*/);var d=a.length,b=b[1];if("rgb"==b&&3==d||"rgba"==b&&4==d)return b=a[0],"%"==b.charAt(b.length-1)?(b=q.map(a,function(a){return 2.56*parseFloat(a)}),4==d&&(b[3]=a[3]),c.fromArray(b,f)):c.fromArray(a,f);if("hsl"==
b&&3==d||"hsla"==b&&4==d){var b=(parseFloat(a[0])%360+360)%360/360,g=parseFloat(a[1])/100,t=parseFloat(a[2])/100,g=.5>=t?t*(g+1):t+g-t*g,t=2*t-g,b=[256*e(t,g,b+1/3),256*e(t,g,b),256*e(t,g,b-1/3),1];4==d&&(b[3]=a[3]);return c.fromArray(b,f)}}return null};var m=function(a,f,e){a=Number(a);return isNaN(a)?e:a<f?f:a>e?e:a};c.prototype.sanitize=function(){this.r=Math.round(m(this.r,0,255));this.g=Math.round(m(this.g,0,255));this.b=Math.round(m(this.b,0,255));this.a=m(this.a,0,1);return this};g.makeGrey=
c.makeGrey=function(a,f){return c.fromArray([a,a,a,f])};a.mixin(c.named,{aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],
darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,
105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,
128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,
112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,
239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,191,216],tomato:[255,
99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]});return c})},"esri/views/vectorTiles/Placement":function(){define(["require","exports","../2d/engine/webgl/Geometry","./Conflict","./GeometryUtils"],function(n,a,c,q,g){Object.defineProperty(a,"__esModule",{value:!0});n=function(){return function(a,b,e,c,g){void 0===e&&(e=0);void 0===c&&(c=-1);void 0===g&&(g=f);this.x=a;this.y=b;this.angle=e;this.segment=c;this.minzoom=g}}();a.Anchor=
n;var e=function(){return function(a,b,e,c,m,q,u){void 0===m&&(m=!1);void 0===q&&(q=f);void 0===u&&(u=g.C_INFINITY);this.anchor=a;this.labelAngle=b;this.glyphAngle=e;this.page=c;this.upsideDown=m;this.minzoom=q;this.maxzoom=u}}(),m=function(){return function(a,b,f,e,c,g,m,w,q,D){this.tl=a;this.tr=b;this.bl=f;this.br=e;this.mosaicRect=c;this.labelAngle=g;this.anchor=m;this.minzoom=w;this.maxzoom=q;this.page=D}}();a.PlacedSymbol=m;var b=function(){return function(a,b){this.footprint=a;this.shapes=b}}();
a.Placement=b;var f=.5;n=function(){function a(){this.mapAngle=0;this._conflictEngine=new q.ConflictEngine}a.prototype.reset=function(){this._conflictEngine.reset()};a.prototype.setAngle=function(a){this.mapAngle=a;this._conflictEngine.setAngle(a)};a.prototype.getIconPlacement=function(a,e,l,A,F,u,w){var d=l.width/l.pixelRatio,p=l.height/l.pixelRatio;F=u.offset[0]-d/2;var t=u.offset[1]-p/2,d=F+d,p=t+p,z=l.rect,x=l.sdf?17:2,v=F-x,B=t-x,n=v+z.width/l.pixelRatio,M=B+z.height/l.pixelRatio;l=new c.Point(v,
B);x=new c.Point(n,M);M=new c.Point(v,M);B=new c.Point(n,B);n=u.rotate*g.C_DEG_TO_RAD;v=1===u.rotationAlignment;0<=a.segment&&!v&&(n+=a.angle);if(0!==n){var P=Math.cos(n),Q=Math.sin(n);l.rotate(P,Q);x.rotate(P,Q);M.rotate(P,Q);B.rotate(P,Q)}P=8*u.padding;Q=new c.Point(a.x,a.y);a=new q.Footprint(this.mapAngle,P,v);a.addBox(Q,new q.Box(F,t,d,p),A,n,e,f,g.C_INFINITY);e=new m(l,B,M,x,z,0,Q,f,g.C_INFINITY,0);e=new b(a,[e]);A=f;u.allowOverlap||(A=this._conflictEngine.getMinZoom(e.footprint,A,w,v));a.minzoom=
A;return e};a.prototype.getTextPlacement=function(a,l,t,A,F,u,w,E){for(var d=new c.Point(a.x,a.y),p=w.rotate*g.C_DEG_TO_RAD,z=0===w.rotationAlignment,x=w.keepUpright,v=f,n=!z,J=n?0:a.angle,M=0<=a.segment&&z,P=new q.Footprint(this.mapAngle,8*w.padding,n),Q=[],V=!M,L=Number.POSITIVE_INFINITY,R=Number.NEGATIVE_INFINITY,G=L,y=R,I=M?x:z&&x,H,T=0;T<A.length;T++){var S=A[T],K=S.glyphMosaicItem;if(K&&!K.rect.isEmpty){var U=K.rect,Z=K.metrics,W=K.page;V&&(H&&H!==S.y&&(P.addBox(d,new q.Box(L,G,R,y),F,p,l,f,
g.C_INFINITY),L=Number.POSITIVE_INFINITY,R=Number.NEGATIVE_INFINITY,G=L,y=R),H=S.y);var fa=[];if(M){if(K=(t.x+S.x+Z.left-4+.5*K.metrics.width)*F,v=this._placeGlyph(a,v,K,u,a.segment,1,W,fa),x&&(v=this._placeGlyph(a,v,K,u,a.segment,-1,W,fa)),2<=v)break}else fa.push(new e(d,J,J,W)),z&&x&&fa.push(new e(d,J+g.C_PI,J+g.C_PI,W,!0));for(var W=S.x+t.x+Z.left,S=S.y+t.y-Z.top,K=W+Z.width,Z=S+Z.height,ba=new c.Point(W-4,S-4),ga=new c.Point(ba.x+U.width,ba.y+U.height),ca=new c.Point(ba.x,ga.y),ha=new c.Point(ga.x,
ba.y),Y=0;Y<fa.length;Y++){var aa=fa[Y],ka=ba.clone(),la=ca.clone(),ma=ha.clone(),na=ga.clone(),ja=S,oa=Z,da=aa.glyphAngle+p;if(0!==da){var N=Math.cos(da),X=Math.sin(da);ka.rotate(N,X);na.rotate(N,X);la.rotate(N,X);ma.rotate(N,X)}Q.push(new m(ka,ma,la,na,U,aa.labelAngle,aa.anchor,aa.minzoom,aa.maxzoom,aa.page));if(!I||this._legible(aa.labelAngle))V?(W<L&&(L=W),ja<G&&(G=ja),K>R&&(R=K),oa>y&&(y=oa)):2>aa.minzoom&&P.addBox(aa.anchor,new q.Box(W,ja,K,oa),F,da,l,aa.minzoom,aa.maxzoom)}}}if(2<=v)return null;
V&&P.addBox(d,new q.Box(L,G,R,y),F,p,l,f,g.C_INFINITY);a=new b(P,Q);w.allowOverlap||(v=this._conflictEngine.getMinZoom(a.footprint,v,E,n));P.minzoom=v;return a};a.prototype.add=function(a){this._conflictEngine.add(a.footprint)};a.prototype._legible=function(a){a=g.radToByte(a);return 65>a||193<=a};a.prototype._placeGlyph=function(a,b,f,l,m,u,w,q){var d=0>u?g.positiveMod(a.angle+g.C_PI,g.C_2PI):a.angle,p=this._legible(d),t=0;0>f&&(u*=-1,f*=-1,t=g.C_PI);0<u&&++m;a=new c.Point(a.x,a.y);var F=l[m],E=
g.C_INFINITY;if(l.length<=m)return E;for(;;){var A=F.x-a.x,n=F.y-a.y,M=Math.sqrt(A*A+n*n),P=Math.max(f/M,b),A=g.positiveMod(Math.atan2(n/M,A/M)+t,g.C_2PI);q.push(new e(a,d,A,w,p,P,E));if(P<=b)return P;a=F.clone();do{m+=u;if(l.length<=m||0>m)return P;F=l[m]}while(a.isEqual(F));E=F.x-a.x;A=F.y-a.y;n=Math.sqrt(E*E+A*A);E*=M/n;A*=M/n;a.x-=E;a.y-=A;E=P}};return a}();a.PlacementEngine=n})},"esri/views/vectorTiles/Conflict":function(){define(["require","exports","../2d/engine/webgl/Geometry","./GeometryUtils"],
function(n,a,c,q){Object.defineProperty(a,"__esModule",{value:!0});n=function(){function a(a,f,e,d){this.left=a;this.top=f;this.right=e;this.bottom=d}a.prototype.clone=function(){return new a(this.left,this.top,this.right,this.bottom)};a.prototype.move=function(a,f){this.left+=a;this.top+=f;this.right+=a;this.bottom+=f};a.prototype.rotate=function(a,f){var b=this.left,d=this.right,e=this.top,c=this.bottom,g=b*a-e*f,m=b*f+e*a,u=d*a-e*f,e=d*f+e*a,w=b*a-c*f,b=b*f+c*a,q=d*a-c*f;a=d*f+c*a;this.left=Math.min(g,
u,w,q);this.top=Math.min(m,e,b,a);this.right=Math.max(g,u,w,q);this.bottom=Math.max(m,e,b,a)};a.overlaps=function(a,f){return a.right>f.left&&a.left<f.right&&a.bottom>f.top&&a.top<f.bottom};return a}();a.Box=n;var g=function(){function a(a,f,e,d){this.anchor=a;this.corners=f;this.minzoom=e;this.maxzoom=d}a.prototype.left=function(){return this.corners[0].x};a.prototype.right=function(){return this.corners[2].x};a.prototype.top=function(){return this.corners[1].y};a.prototype.bottom=function(){return this.corners[3].y};
return a}();a.Obstacle=g;n=function(){function a(a,f,c){this.obstacles=[];this.mapAngle=a;this.padding=f;this.isScreenAligned=c;this.minzoom=e}a.prototype.addBox=function(a,f,e,d,p,t,m){var b=f.left*e-this.padding,l=f.top*e-this.padding,w=f.right*e+this.padding;f=f.bottom*e+this.padding;b=[new c.Point(b,l),new c.Point(w,l),new c.Point(w,f),new c.Point(b,f)];0!==this.mapAngle&&(l=Math.cos(this.mapAngle),w=Math.sin(this.mapAngle),a=a.clone(),a.rotate(l,w));this.isScreenAligned||(d+=this.mapAngle);if(0!==
d){l=Math.cos(d);w=Math.sin(d);b[0].rotate(l,w);b[1].rotate(l,w);b[2].rotate(l,w);b[3].rotate(l,w);d=0;for(l=1;4>l;l++)b[l].x<b[d].x?d=l:b[l].x===b[d].x&&b[l].y<b[d].y&&(d=l);if(d){w=[];for(l=0;4>l;l++)w.push(b[(l+d)%4]);b=w}}if(p)for(d=0,l=b;d<l.length;d++)l[d].move(p[0],p[1]);this.obstacles.push(new g(a,b,t,m))};return a}();a.Footprint=n;var e=.5;n=function(){function a(){this._grid=[]}a.prototype.setAngle=function(a){};a.prototype.reset=function(){this._grid=[]};a.prototype.add=function(b){var f=
this._grid,e=0;for(b=b.obstacles;e<b.length;e++)for(var d=b[e],c=d.anchor,g=a._gridClamp(Math.min(d.left()+c.x,c.x)),m=a._gridClamp(Math.max(d.right()+c.x,c.x)),q=a._gridClamp(Math.min(d.top()+c.y,c.y)),c=a._gridClamp(Math.max(d.bottom()+c.y,c.y));q<=c;q++)for(var u=g;u<=m;u++){var w=f[16*q+u];w||(w=f[16*q+u]=[]);w.push(d)}};a.prototype.getMinZoom=function(b,f,e,d){if(0===b.obstacles.length)return q.C_INFINITY;e=this._grid;d=0;for(b=b.obstacles;d<b.length;d++)for(var c=b[d],g=c.anchor,l=a._gridClamp(Math.min(c.left()+
g.x,g.x)),m=a._gridClamp(Math.max(c.right()+g.x,g.x)),u=a._gridClamp(Math.min(c.top()+g.y,g.y)),g=a._gridClamp(Math.max(c.bottom()+g.y,g.y));u<=g;u++)for(var w=l;w<=m;w++){var E=e[16*u+w];if(E)for(var n=0;n<E.length;n++){var C=E[n];if(!(c.minzoom>=C.maxzoom||C.minzoom>=c.maxzoom)&&(f=a._calcPlacementZoom(c,C,f),2<=f))return q.C_INFINITY}}return 2>f?f:q.C_INFINITY};a._gridClamp=function(a){return q.clamp(a>>9,-7,8)};a._calcPlacementZoom=function(b,f,e){var d=f.anchor.x-b.anchor.x;if(0===d&&(b.right()<
f.left()||f.right()<b.left()))return e;var c=f.anchor.y-b.anchor.y;if(0===c&&(b.bottom()<f.top()||f.bottom()<b.top()))return e;var g=q.C_INFINITY;if(0!==d){var l=(0<d?b.right()-f.left():b.left()-f.right())/d;l<g&&(g=l);d=0<d?a._calcExtZoomX(b,f,l):a._calcExtZoomX(f,b,l);d<g&&(g=d)}0!==c&&(d=(0<c?b.bottom()-f.top():b.top()-f.bottom())/c,d<g&&(g=d),c=0<c?a._calcExtZoomY(b,f,d):a._calcExtZoomY(f,b,d),c<g&&(g=c));if(g<b.minzoom||g<f.minzoom)return e;g=Math.min(g,b.maxzoom,f.maxzoom);g<e&&(g=e);return g};
a._calcExtZoomX=function(a,f,e){var b,c,g;if(a.anchor.y+a.corners[2].y/e<f.anchor.y+f.corners[0].y/e){b=a.corners[2].x-a.corners[3].x;g=a.corners[2].y-a.corners[3].y;var l=f.corners[1].x-f.corners[0].x;c=f.corners[1].y-f.corners[0].y;0<=b*c-g*l?a.anchor.y+a.corners[3].y/e<f.anchor.y+f.corners[0].y/e?(e=a.corners[3],b=f.corners[0],c=f.corners[1],g=1):(e=f.corners[0],b=a.corners[3],c=a.corners[2],g=-1):a.anchor.y+a.corners[2].y/e>f.anchor.y+f.corners[1].y/e?(e=a.corners[2],b=f.corners[0],c=f.corners[1],
g=1):(e=f.corners[1],b=a.corners[3],c=a.corners[2],g=-1)}else b=a.corners[2].x-a.corners[1].x,g=a.corners[2].y-a.corners[1].y,l=f.corners[3].x-f.corners[0].x,c=f.corners[3].y-f.corners[0].y,0>b*c-g*l?a.anchor.y+a.corners[1].y/e>f.anchor.y+f.corners[0].y/e?(e=a.corners[1],b=f.corners[0],c=f.corners[3],g=1):(e=f.corners[0],b=a.corners[1],c=a.corners[2],g=-1):a.anchor.y+a.corners[2].y/e<f.anchor.y+f.corners[3].y/e?(e=a.corners[2],b=f.corners[0],c=f.corners[3],g=1):(e=f.corners[3],b=a.corners[1],c=a.corners[2],
g=-1);l=c.x-b.x;c=c.y-b.y;return g*((e.y-b.y)*l-(e.x-b.x)*c)/((a.anchor.x-f.anchor.x)*c-(a.anchor.y-f.anchor.y)*l)};a._calcExtZoomY=function(a,f,e){var b,c,g;if(a.anchor.x+a.corners[3].x/e<f.anchor.x+f.corners[1].x/e){b=a.corners[3].x-a.corners[2].x;g=a.corners[3].y-a.corners[2].y;var l=f.corners[0].x-f.corners[1].x;c=f.corners[0].y-f.corners[1].y;0>b*c-g*l?a.anchor.x+a.corners[2].x/e<f.anchor.x+f.corners[1].x/e?(e=a.corners[2],b=f.corners[1],c=f.corners[0],g=1):(e=f.corners[1],b=a.corners[2],c=a.corners[3],
g=-1):a.anchor.x+a.corners[3].x/e>f.anchor.x+f.corners[0].x/e?(e=a.corners[3],b=f.corners[1],c=f.corners[0],g=1):(e=f.corners[0],b=a.corners[2],c=a.corners[3],g=-1)}else b=a.corners[3].x-a.corners[0].x,g=a.corners[3].y-a.corners[0].y,l=f.corners[2].x-f.corners[1].x,c=f.corners[2].y-f.corners[1].y,0<b*c-g*l?a.anchor.x+a.corners[0].x/e>f.anchor.x+f.corners[1].x/e?(e=a.corners[0],b=f.corners[1],c=f.corners[2],g=1):(e=f.corners[1],b=a.corners[0],c=a.corners[3],g=-1):a.anchor.x+a.corners[3].x/e<f.anchor.x+
f.corners[2].x/e?(e=a.corners[3],b=f.corners[1],c=f.corners[2],g=1):(e=f.corners[2],b=a.corners[0],c=a.corners[3],g=-1);l=c.x-b.x;c=c.y-b.y;return g*((e.y-b.y)*l-(e.x-b.x)*c)/((a.anchor.x-f.anchor.x)*c-(a.anchor.y-f.anchor.y)*l)};return a}();a.ConflictEngine=n})},"esri/views/vectorTiles/SymbolBucket":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper dojox/string/BidiEngine ../2d/engine/webgl/Geometry ../2d/engine/webgl/TextShaping ./Bucket ./GeometryUtils ./Placement ./style/StyleLayer".split(" "),
function(n,a,c,q,g,e,m,b,f,l,d){function p(a,b){if(a.iconMosaicItem&&b.iconMosaicItem){if(a.iconMosaicItem.page!==b.iconMosaicItem.page)return a.iconMosaicItem.page<b.iconMosaicItem.page?-1:1}else{if(a.iconMosaicItem&&!b.iconMosaicItem)return 1;if(!a.iconMosaicItem&&b.iconMosaicItem)return-1}return 0}(function(){return function(){}})();return function(a){function b(b,d,f,e,c,g,l,p){d=a.call(this,b,d)||this;d._markerMap=new Map;d._glyphMap=new Map;d._glyphBufferDataStorage=new Map;d._sdfMarkers=!1;
if(b.hasDataDrivenIcon!==f.isDataDriven())throw Error("incompatible icon buffer");if(b.hasDataDrivenText!==c.isDataDriven())throw Error("incompatible text buffer");d._iconVertexBuffer=f;d._iconIndexBuffer=e;d._textVertexBuffer=c;d._textIndexBuffer=g;d._placementEngine=l;d._workerTileHandler=p;return d}c(b,a);Object.defineProperty(b.prototype,"markerPageMap",{get:function(){return this._markerMap},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"glyphsPageMap",{get:function(){return this._glyphMap},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"sdfMarker",{get:function(){return this._sdfMarkers},enumerable:!0,configurable:!0});b.prototype.copy=function(a,d,f,e,c){a=new b(this.layer,this.zoom,a,d,f,e,c,this._workerTileHandler);a.layerIndex=this.layerIndex;a.layerExtent=this.layerExtent;a._iconIndexStart=d.index;a._textIndexStart=e.index;a._iconIndexCount=0;a._textIndexCount=0;a._symbolInstances=this._symbolInstances;a._workerTileHandler=this._workerTileHandler;a._fontArray=
this._fontArray;a._textLayout=this._textLayout;a._iconLayout=this._iconLayout;a._isLinePlacement=this._isLinePlacement;a._avoidEdges=this._avoidEdges;return a};b.prototype.getResources=function(a,d,f){var e=this.layer,c=this.zoom,g=e.hasDataDrivenIcon,l=e.hasDataDrivenText;a&&a.setExtent(this.layerExtent);for(var p=e.getLayoutProperty("icon-image"),m=e.getLayoutProperty("text-field"),q=e.getLayoutValue("text-font",c),u=e.getLayoutValue("text-transform",c),w=[],t=[1,1,1,1],F=1,n=1,A=[1,1,1,1],R=1,
G=1,y=0,I=this._features;y<I.length;y++){var H=I[y],T=H.getGeometry(a);if(T&&0!==T.length){var S=void 0;p&&(S=e.getLayoutValue("icon-image",c,H),p.isDataDriven||(S=this._replaceKeys(S,H.values)),S&&d.add(S));var K=void 0,U=!1;if(m&&(K=e.getLayoutValue("text-field",c,H),m.isDataDriven||(K=this._replaceKeys(K,H.values)),K=K.replace(/\\n/g,"\n"))){switch(u){case 2:K=K.toLowerCase();break;case 1:K=K.toUpperCase()}b._bidiEngine.hasBidiChar(K)&&(U=void 0,U="rtl"===b._bidiEngine.checkContextual(K)?"IDNNN":
"ICNNN",K=b._bidiEngine.bidiTransform(K,U,"VLYSN"),U=!0);var Z=K.length;if(0<Z)for(var W=0,fa=q;W<fa.length;W++){var ba=fa[W],ga=f[ba];ga||(ga=f[ba]=new Set);for(ba=0;ba<Z;ba++){var ca=K.charCodeAt(ba);ga.add(ca)}}}if(S||K)Z=e.getLayoutValue("icon-size",c,H),W=e.getLayoutValue("text-size",c,H),e.hasDataDrivenIconColor&&(t=e.getPaintValue("icon-color",c,H)),e.hasDataDrivenIconOpacity&&(F=e.getPaintValue("icon-opacity",c,H)),e.hasDataDrivenIconSize&&(n=Z),e.hasDataDrivenTextColor&&(A=e.getPaintValue("text-color",
c,H)),e.hasDataDrivenTextOpacity&&(R=e.getPaintValue("text-opacity",c,H)),e.hasDataDrivenTextSize&&(G=W),H={sprite:S,label:K,rtl:U,type:H.type,geometry:T,iconSize:Z,iconRotate:e.getLayoutValue("icon-rotate",c,H),ddIconValues:g?{color:t,opacity:F,size:n}:null,textSize:W,textRotate:e.getLayoutValue("text-rotate",c,H),ddTextValues:l?{color:A,opacity:R,size:G}:null},w.push(H)}}this._symbolFeatures=w};b.prototype.processFeatures=function(a,e){a&&a.setExtent(this.layerExtent);var c=this.layer,g=this.zoom;
e=this._isLinePlacement=1===c.getLayoutValue("symbol-placement",g);a=this._avoidEdges=c.getLayoutValue("symbol-avoid-edges",g)&&!e;var q=8*c.getLayoutValue("symbol-spacing",g),t=c.getLayoutProperty("icon-image"),u=c.getLayoutProperty("text-field"),F=this._workerTileHandler,v,n;t&&(this._iconLayout=new d.IconLayout(c,g,e),v=F.getSpriteItems(),n=this._getTranslate(!0));var A,M,P;if(u){A=this._textLayout=new d.TextLayout(c,g,e);this._fontArray=A.fontArray;P=.5;switch(A.anchor){case 5:case 1:case 7:P=
0;break;case 6:case 2:case 8:P=1}M=.5;switch(A.anchor){case 5:case 3:case 6:M=0;break;case 7:case 4:case 8:M=1}c=.5;switch(A.justify){case 0:c=0;break;case 2:c=1}var g=24*A.letterSpacing,t=e?0:24*A.maxWidth,u=24*A.lineHeight,Q=[24*A.offset[0],24*A.offset[1]];A=this._fontArray.map(function(a){return F.getGlyphItems(a)});M=new m(A,t,u,g,Q,P,M,c);P=this._getTranslate(!1)}this._iconIndexStart=this._iconIndexBuffer.index;this._textIndexStart=this._textIndexBuffer.index;this._textIndexCount=this._iconIndexCount=
0;this._markerMap.clear();this._glyphMap.clear();this._symbolInstances=c=[];g=this._textLayout;t=1;g&&g.size&&(t=g.size/24);u=g?g.maxAngle*f.C_DEG_TO_RAD:0;A=g?8*g.size:0;for(var Q=0,V=this._symbolFeatures;Q<V.length;Q++){var L=V[Q],R=void 0;L.sprite&&(R=v[L.sprite])&&R.sdf&&(this._sdfMarkers=!0);var G=void 0,y=L.label,I=0;if(y&&(G=M.getShaping(y,L.rtl))&&0<G.length){for(var I=1E30,y=-1E30,H=0,T=G;H<T.length;H++)var S=T[H],I=Math.min(I,S.x),y=Math.max(y,S.x);I=(y-I+48)*t*8}y=0;for(H=L.geometry;y<
H.length;y++){var T=H[y],K=void 0;e?(G&&0<G.length&&g&&g.size&&b._smoothVertices(T,8*g.size*(2+Math.min(2,4*Math.abs(g.offset[1])))),K=b._findAnchors(T,q,I)):K=3===L.type?b._findCentroid(T):[new l.Anchor(T[0].x,T[0].y)];for(S=0;S<K.length;S++){var U=K[S];0>U.x||4096<U.x||0>U.y||4096<U.y||e&&0<I&&0===g.rotationAlignment&&!b._honorsTextMaxAngle(T,U,I,u,A)||c.push({shaping:G,line:T,iconMosaicItem:R,anchor:U,iconSize:L.iconSize,iconRotate:L.iconRotate,ddIconValues:L.ddIconValues,textSize:L.textSize,textRotate:L.textRotate,
ddTextValues:L.ddTextValues})}}}c.sort(p);for(v=0;v<c.length;v++)this._processFeature(c[v],n,P,a);this._addPlacedGlyphs()};b.prototype.updateSymbols=function(){this._iconIndexStart=this._iconIndexBuffer.index;this._textIndexStart=this._textIndexBuffer.index;this._textIndexCount=this._iconIndexCount=0;this._markerMap.clear();this._glyphMap.clear();var a=this._avoidEdges,b=this.layer,d;b.getLayoutProperty("icon-image")&&(d=this._getTranslate(!0));var f;b.getLayoutProperty("text-field")&&(f=this._getTranslate(!1));
for(var b=0,e=this._symbolInstances;b<e.length;b++)this._processFeature(e[b],d,f,a);this._addPlacedGlyphs()};b.prototype._getTranslate=function(a){var b=this.layer.getPaintValue(a?"icon-translate":"text-translate",this.zoom);if(0!==b[0]||0!==b[1]){var d=this._placementEngine.mapAngle;return 0!==d&&0===this.layer.getPaintValue(a?"icon-translate-anchor":"text-translate-anchor",this.zoom)?(a=Math.sin(d),d=Math.cos(d),[8*(b[0]*d-b[1]*a),8*(b[0]*a+b[1]*d)]):[8*b[0],8*b[1]]}};b.prototype._replaceKeys=function(a,
b){return a.replace(/{([^{}]+)}/g,function(a,d){return d in b?b[d]:""})};b.prototype._processFeature=function(a,b,d,c){var g=a.line,l=a.iconMosaicItem,p=a.shaping,m=a.anchor,q=this._iconLayout,t=q&&!!l,u=!0,w=1;t&&(q.size=a.iconSize,q.rotate=a.iconRotate,w=8*q.size,u=q.optional||!l);var F=this._textLayout,n=F&&p&&0<p.length,A;A=1;var E=!0;n&&(F.size=a.textSize,F.rotate=a.textRotate,A=F.size/24,A*=8,E=F.optional||!p||0===p.length);var R=new e.Point(0,-17),G;t&&(G=this._placementEngine.getIconPlacement(m,
b,l,w,g,q,c),m.minzoom>G.footprint.minzoom&&(G.footprint.minzoom=m.minzoom),G.footprint.minzoom===f.C_INFINITY&&(G=null));if(G||u){var y;n&&(y=this._placementEngine.getTextPlacement(m,d,R,p,A,g,F,c))&&(m.minzoom>y.footprint.minzoom&&(y.footprint.minzoom=m.minzoom),y.footprint.minzoom===f.C_INFINITY&&(y=null));if(y||E)G&&y||(E||u?E||y?u||G||(y=null):G=null:y=G=null),G&&y&&!E&&!u&&(b=Math.max(G.footprint.minzoom,y.footprint.minzoom),G.footprint.minzoom=b,y.footprint.minzoom=b),y&&(F.ignorePlacement||
this._placementEngine.add(y),this._storePlacedGlyphs(y.shapes,y.footprint.minzoom,this.zoom,a.ddTextValues)),G&&(q.ignorePlacement||this._placementEngine.add(G),this._addPlacedIcons(G.shapes,G.footprint.minzoom,this.zoom,l.page,a.ddIconValues))}};b.prototype._addPlacedIcons=function(a,b,d,e,c){b=Math.max(d+f.log2(b),0);for(var g=this._iconVertexBuffer,l=this._iconIndexBuffer,p=0;p<a.length;p++){var m=a[p],q=Math.max(d+f.log2(m.minzoom),b),t=Math.min(d+f.log2(m.maxzoom),25);if(!(t<=q)){var u=m.tl,
w=m.tr,F=m.bl,A=m.br,n=m.mosaicRect,E=m.labelAngle,m=m.anchor,D=g.index,y=n.x,I=n.y,H=y+n.width,n=I+n.height;g.add(m.x,m.y,u.x,u.y,y,I,E,q,t,b,c);g.add(m.x,m.y,w.x,w.y,H,I,E,q,t,b,c);g.add(m.x,m.y,F.x,F.y,y,n,E,q,t,b,c);g.add(m.x,m.y,A.x,A.y,H,n,E,q,t,b,c);l.add(D+0,D+1,D+2);l.add(D+1,D+2,D+3);this._markerMap.has(e)?this._markerMap.get(e)[1]+=6:this._markerMap.set(e,[this._iconIndexStart+this._iconIndexCount,6]);this._iconIndexCount+=2}}};b.prototype._addPlacedGlyphs=function(){var a=this,b=this._textVertexBuffer,
d=this._textIndexBuffer;this._glyphBufferDataStorage.forEach(function(f,e){for(var c=0;c<f.length;c++){var g=f[c],l=b.index;b.add(g.glyphAnchor[0],g.glyphAnchor[1],g.tl[0],g.tl[1],g.xmin,g.ymin,g.labelAngle,g.minLod,g.maxLod,g.placementLod,g.ddValues);b.add(g.glyphAnchor[0],g.glyphAnchor[1],g.tr[0],g.tr[1],g.xmax,g.ymin,g.labelAngle,g.minLod,g.maxLod,g.placementLod,g.ddValues);b.add(g.glyphAnchor[0],g.glyphAnchor[1],g.bl[0],g.bl[1],g.xmin,g.ymax,g.labelAngle,g.minLod,g.maxLod,g.placementLod,g.ddValues);
b.add(g.glyphAnchor[0],g.glyphAnchor[1],g.br[0],g.br[1],g.xmax,g.ymax,g.labelAngle,g.minLod,g.maxLod,g.placementLod,g.ddValues);d.add(l+0,l+1,l+2);d.add(l+1,l+2,l+3);a._glyphMap.has(e)?a._glyphMap.get(e)[1]+=6:a._glyphMap.set(e,[a._textIndexStart+a._textIndexCount,6]);a._textIndexCount+=2}});this._glyphBufferDataStorage.clear()};b.prototype._storePlacedGlyphs=function(a,b,d,e){b=Math.max(d+f.log2(b),0);for(var c=0;c<a.length;c++){var g=a[c],l=Math.max(d+f.log2(g.minzoom),b),m=Math.min(d+f.log2(g.maxzoom),
25);if(!(m<=l)){var p=g.tl,q=g.tr,t=g.bl,w=g.br,u=g.labelAngle,n=g.anchor,A=g.mosaicRect;this._glyphBufferDataStorage.has(g.page)||this._glyphBufferDataStorage.set(g.page,[]);this._glyphBufferDataStorage.get(g.page).push({glyphAnchor:[n.x,n.y],tl:[p.x,p.y],tr:[q.x,q.y],bl:[t.x,t.y],br:[w.x,w.y],xmin:A.x,ymin:A.y,xmax:A.x+A.width,ymax:A.y+A.height,labelAngle:u,minLod:l,maxLod:m,placementLod:b,ddValues:e})}}};b._findAnchors=function(a,b,d){b+=d;for(var c=0,g=a.length-1,m=0;m<g;m++)c+=e.Point.distance(a[m],
a[m+1]);m=.5*(d||b);if(c<=m)return[];d=m/c;b=c/Math.max(Math.round(c/b),1);for(var c=0,g=-b/2,p=[],q=a.length-1,m=0;m<q;m++){for(var t=a[m],w=a[m+1],u=w.x-t.x,n=w.y-t.y,A=Math.sqrt(u*u+n*n),F=void 0;g+b<c+A;){var g=g+b,V=(g-c)/A,L=f.interpolate(t.x,w.x,V),V=f.interpolate(t.y,w.y,V);void 0===F&&(F=Math.atan2(n,u));p.push(new l.Anchor(L,V,F,m,d))}c+=A}return p};b._deviation=function(a,b,d){return Math.atan2((b.x-a.x)*(d.y-b.y)-(b.y-a.y)*(d.x-b.x),(b.x-a.x)*(d.x-b.x)+(b.y-a.y)*(d.y-b.y))};b._honorsTextMaxAngle=
function(a,b,d,f,c){var g=0;d/=2;for(var l=new e.Point(b.x,b.y),m=b.segment+1;g>-d;){--m;if(0>m)return!1;g-=e.Point.distance(a[m],l);l=a[m]}g+=e.Point.distance(a[m],a[m+1]);b=[];for(var l=0,p=a.length;g<d;){var q=a[m],t=void 0;do{++m;if(m===p)return!1;t=a[m]}while(t.isEqual(q));var w=m,u=void 0;do{++w;if(w===p)return!1;u=a[w]}while(u.isEqual(t));q=this._deviation(q,t,u);b.push({deviation:q,distToAnchor:g});for(l+=q;g-b[0].distToAnchor>c;)l-=b.shift().deviation;if(Math.abs(l)>f)return!1;g+=e.Point.distance(t,
u)}return!0};b._smoothVertices=function(a,b){if(!(0>=b)){var d=a.length;if(!(3>d)){var f=[],c=0;f.push(0);for(var g=1;g<d;g++)c+=e.Point.distance(a[g],a[g-1]),f.push(c);b=Math.min(b,.2*c);c=[];c.push(a[0].x);c.push(a[0].y);var l=a[d-1].x,m=a[d-1].y,g=e.Point.sub(a[0],a[1]);g.normalize();a[0].x+=b*g.x;a[0].y+=b*g.y;g.assignSub(a[d-1],a[d-2]);g.normalize();a[d-1].x+=b*g.x;a[d-1].y+=b*g.y;for(g=1;g<d;g++)f[g]+=b;f[d-1]+=b;for(var p=.5*b,g=1;g<d-1;g++){for(var q=0,t=0,u=0,n=g-1;0<=n&&!(f[n+1]<f[g]-p);n--){var A=
p+f[n+1]-f[g],F=f[n+1]-f[n],L=f[g]-f[n]<p?1:A/F;if(1E-6>Math.abs(L))break;var R=L*L,G=L*A-.5*R*F,y=L*F/b,I=a[n+1],H=a[n].x-I.x,T=a[n].y-I.y,q=q+y/G*(I.x*L*A+.5*R*(A*H-F*I.x)-R*L*F*H/3),t=t+y/G*(I.y*L*A+.5*R*(A*T-F*I.y)-R*L*F*T/3),u=u+y}for(n=g+1;n<d&&!(f[n-1]>f[g]+p);n++){A=p-f[n-1]+f[g];F=f[n]-f[n-1];L=f[n]-f[g]<p?1:A/F;if(1E-6>Math.abs(L))break;R=L*L;G=L*A-.5*R*F;y=L*F/b;I=a[n-1];H=a[n].x-I.x;T=a[n].y-I.y;q+=y/G*(I.x*L*A+.5*R*(A*H-F*I.x)-R*L*F*H/3);t+=y/G*(I.y*L*A+.5*R*(A*T-F*I.y)-R*L*F*T/3);u+=
y}c.push(q/u);c.push(t/u)}c.push(l);c.push(m);for(n=g=0;g<d;g++)a[g].x=c[n++],a[g].y=c[n++]}}};b._findCentroid=function(a){var b=a.length-1,d=0,f=0,e=0,c=a[0].x,g=a[0].y;4096<c&&(c=4096);0>c&&(c=0);4096<g&&(g=4096);0>g&&(g=0);for(var m=1;m<b;m++){var p=a[m].x,q=a[m].y,t=a[m+1].x,n=a[m+1].y;4096<p&&(p=4096);0>p&&(p=0);4096<q&&(q=4096);0>q&&(q=0);4096<t&&(t=4096);0>t&&(t=0);4096<n&&(n=4096);0>n&&(n=0);var A=(p-c)*(n-g)-(t-c)*(q-g),d=d+A*(c+p+t),f=f+A*(g+q+n),e=e+A}d/=3*e;f/=3*e;return isNaN(d)||isNaN(f)?
[]:[new l.Anchor(d,f)]};b._bidiEngine=new g;return b}(b)})},"dojox/string/BidiEngine":function(){define(["dojo/_base/lang","dojo/_base/declare","dojo/Stateful"],function(n,a,c){function q(a,d,f,c,h){var k=a;void 0===d&&(d=h.defInFormat);void 0===f&&(f=h.defOutFormat);void 0===c&&(c=h.defSwap);if(d!==f){var l,m=d.substring(0,1);l=d.substring(1,4);var p=f.substring(0,1),t=f.substring(1,4);"C"===l.charAt(0)&&(l=g(k),l="ltr"===l||"rtl"===l?l.toUpperCase():"L"===d.charAt(2)?"LTR":"RTL",d=m+l);"C"===t.charAt(0)&&
(l=g(k),"rtl"===l?t="RTL":"ltr"===l?(k=k.split(""),k.reverse(),l=g(k.join("")),t=l.toUpperCase()):t="L"===f.charAt(2)?"LTR":"RTL",f=p+t)}if(d===f)return a;p=d.substring(0,1);k=d.substring(1,4);m=f.substring(0,1);t=f.substring(1,4);h.inFormat=d;h.outFormat=f;h.swap=c;if("L"===p&&"VLTR"===f){if("LTR"===k)return h.dir=B,e(a,h);if("RTL"===k)return h.dir=J,e(a,h)}if("V"===p&&"V"===m)return h.dir="RTL"===k?J:B,b(a,h);if("L"===p&&"VRTL"===f)return h.dir="LTR"===k?B:J,a=e(a,h),b(a);if("VLTR"===d&&"LLTR"===
f)return h.dir=B,e(a,h);if("V"===p&&"L"===m&&k!==t)return a=b(a),"RTL"===k?q(a,"LLTR","VLTR",c,h):q(a,"LRTL","VRTL",c,h);if("VRTL"===d&&"LRTL"===f)return q(a,"LRTL","VRTL",c,h);if("L"===p&&"L"===m)return d=h.swap,h.swap=d.substr(0,1)+"N","RTL"===k?(h.dir=J,a=e(a,h),h.swap="N"+d.substr(1,2),h.dir=B,a=e(a,h)):(h.dir=B,a=e(a,h),h.swap="N"+d.substr(1,2),a=q(a,"VLTR","LRTL",h.swap,h)),a}function g(a){return(a=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(a))?"z">=a[0]?
"ltr":"rtl":""}function e(a,b){a=a.split("");var f=[];m(a,f,b);if(0!==b.hiLevel&&b.swap.substr(0,1)!==b.swap.substr(1,2))for(var c=0;c<a.length;c++)if(1===f[c]){var e=c,g;b:{g=a[c];for(var h=void 0,k=0,l=Q.length-1;k<=l;)if(h=Math.floor((k+l)/2),g<Q[h][0])l=h-1;else if(g>Q[h][0])k=h+1;else{g=Q[h][1];break b}}a[e]=g}d(2,a,f,b);d(1,a,f,b);C=f;return a.join("")}function m(a,b,d){var f=a.length,c=d.dir?fa:W,e=null,g=null,h=null,e=0,g=g=null,k=-1,l=g=null,m=[],t=[];d.hiLevel=d.dir;d.lastArabic=!1;d.hasUbatAl=
!1;d.hasUbatB=!1;d.hasUbatS=!1;for(g=0;g<f;g++){var l=g,h=a[g].charCodeAt(0),q=qa[h>>8];m[l]=q<da?q:ra[q-da][h&255]}for(l=0;l<f;l++){t[l]=g=p(a,m,t,l,d);e=c[e][g];g=e&240;e&=15;b[l]=h=c[e][x];if(0<g){if(16===g)for(g=k;g<l;g++)b[g]=1;k=-1}if(g=c[e][v])-1===k&&(k=l);else if(-1<k){for(g=k;g<l;g++)b[g]=h;k=-1}m[l]===aa&&(b[l]=0);d.hiLevel|=h}if(d.hasUbatS)for(a=0;a<f;a++)if(m[a]===ka)for(b[a]=d.dir,c=a-1;0<=c;c--)if(m[c]===ma)b[c]=d.dir;else break}function b(a,b){a=a.split("");if(b){var d=[];m(a,d,b);
C=d}a.reverse();E.reverse();return a.join("")}function f(a){for(var b=0;b<U.length;b++)if(a>=U[b]&&a<=Z[b])return!0;return!1}function l(a,b,d,c){for(;b*d<c&&A(a[b]);)b+=d;return b*d<c&&f(a[b])?!0:!1}function d(a,b,d,f){if(!(f.hiLevel<a))if(1!==a||f.dir!==J||f.hasUbatB){f=b.length;for(var c=0,e,g,h;c<f;){if(d[c]>=a){for(e=c+1;e<f&&d[e]>=a;)e++;for(g=e-1;c<g;c++,g--)h=b[c],b[c]=b[g],b[g]=h,h=E[c],E[c]=E[g],E[g]=h;c=e}c++}}else b.reverse(),E.reverse()}function p(a,b,d,f,c){return{UBAT_L:function(){c.lastArabic=
!1;return ba},UBAT_R:function(){c.lastArabic=!1;return ga},UBAT_ON:function(){return Y},UBAT_AN:function(){return ha},UBAT_EN:function(){return c.lastArabic?ha:ca},UBAT_AL:function(){c.lastArabic=!0;c.hasUbatAl=!0;return ga},UBAT_WS:function(){return Y},UBAT_CS:function(){var a,e;if(1>f||f+1>=b.length||(a=d[f-1])!==ca&&a!==ha||(e=b[f+1])!==ca&&e!==ha)return Y;c.lastArabic&&(e=ha);return e===a?e:Y},UBAT_ES:function(){return(0<f?d[f-1]:aa)===ca&&f+1<b.length&&b[f+1]===ca?ca:Y},UBAT_ET:function(){if(0<
f&&d[f-1]===ca)return ca;if(c.lastArabic)return Y;for(var a=f+1,e=b.length;a<e&&b[a]===na;)a++;return a<e&&b[a]===ca?ca:Y},UBAT_NSM:function(){if("VLTR"===c.inFormat){for(var e=b.length,g=f+1;g<e&&b[g]===ja;)g++;if(g<e&&(e=a[f],g=b[g],(1425<=e&&2303>=e||64286===e)&&(g===ga||g===la)))return ga}return 1>f||b[f-1]===aa?Y:d[f-1]},UBAT_B:function(){c.lastArabic=!0;c.hasUbatB=!0;return c.dir},UBAT_S:function(){c.hasUbatS=!0;return Y},UBAT_LRE:function(){c.lastArabic=!1;return Y},UBAT_RLE:function(){c.lastArabic=
!1;return Y},UBAT_LRO:function(){c.lastArabic=!1;return Y},UBAT_RLO:function(){c.lastArabic=!1;return Y},UBAT_PDF:function(){c.lastArabic=!1;return Y},UBAT_BN:function(){return Y}}[oa[b[f]]]()}function t(a,b){for(var d=0;d<G.length;d++)if(a===G[d])return b[d];return a}function A(a){return"\u064b"<=a&&"\u0655">=a?!0:!1}function F(a){if("L"===a)return"LTR";if("R"===a)return"RTL";if("C"===a)return"CLR";if("D"===a)return"CRL"}function u(a,b){for(var d=0;d<V.length;d++)if(a===V[d])return b[d];return a}
function w(a,b,d,f){for(var c=0;c<a.length;c++)if(a[c]>b||!d&&a[c]===b)a[c]+=f}n.getObject("string",!0,dojox);n=a("dojox.string.BidiEngine",c,{inputFormat:"ILYNN",outputFormat:"VLNNN",sourceToTarget:[],targetToSource:[],levels:[],bidiTransform:function(a,b,d){this.sourceToTarget=[];this.targetToSource=[];if(!a)return"";var c=this.sourceToTarget,e=this.targetToSource,g=a.length;E=[];C=[];for(var h=0;h<g;h++)c[h]=h,e[h]=h,E[h]=h;if(!this.checkParameters(b,d))return a;b=this.inputFormat;d=this.outputFormat;
var c=a,c=z,h=F(b.charAt(1)),e=F(d.charAt(1)),k="I"===b.charAt(0)?"L":b.charAt(0),g="I"===d.charAt(0)?"L":d.charAt(0),h=k+h,e=g+e,g=b.charAt(2)+d.charAt(2);c.defInFormat=h;c.defOutFormat=e;c.defSwap=g;a=q(a,h,e,g,c);c=!1;if("R"===d.charAt(1))c=!0;else if("C"===d.charAt(1)||"D"===d.charAt(1))c=this.checkContextual(a);e=this.sourceToTarget=E;g=Array(e.length);for(h=0;h<e.length;h++)g[e[h]]=h;D=this.targetToSource=g;if(b.charAt(3)===d.charAt(3))c=a;else if("S"===d.charAt(3))if(b=c,d=!0,0===a.length)c=
void 0;else{void 0===b&&(b=!0);void 0===d&&(d=!0);a=String(a);a=a.split("");var m=0,e=1,c=a.length;b||(m=a.length-1,e=-1,c=1);for(var g=c,h=d,p=0,c=[],k=0;m*e<g;m+=e)if(f(a[m])||A(a[m])){var n;if(n="\u0644"===a[m])b:{for(var r=a,x=m+e,v=e,B=g;x*v<B&&A(r[x]);)x+=v;n=" ";if(x*v<B)for(n=r[x],r=0;r<V.length;r++)if(V[r]===n){n=!0;break b}n=!1}if(n){a[m]=0===p?u(a[m+e],L):u(a[m+e],R);m+=e;p=a;n=m;r=e;for(x=g;n*r<x&&A(p[n]);)n+=r;n*r<x&&(p[n]=" ");h&&(c[k]=m,k++);p=0}else{n=a[m];if(1===p){r=m;if(l(a,m+e,
e,g))b:for(x=a[m],v=0;v<G.length;v++){if(x===G[v]){x=H[v];break b}}else x=t(a[m],I);a[r]=x}else!0===l(a,m+e,e,g)?a[m]=t(a[m],T):a[m]=t(a[m],y);A(n)||(p=1);b:{for(r=0;r<S.length;r++)if(S[r]===n){n=!0;break b}n=!1}!0===n&&(p=0)}}else p=0;e="";for(g=0;g<a.length;g++){if(h=d){b:{for(h=0;h<c.length;h++)if(c[h]===g)break b;h=-1}h=-1<h}h?(w(D,g,!b,-1),E.splice(g,1)):e+=a[g]}c=e}else if(b=a,d=c,a=!0,0===b.length)c=void 0;else for(void 0===a&&(a=!0),void 0===d&&(d=!0),b=String(b),c="",e=[],e=b.split(""),g=
0;g<b.length;g++)h=!1,"\ufe70"<=e[g]&&"\ufeff">e[g]?(k=b.charCodeAt(g),"\ufef5"<=e[g]&&"\ufefc">=e[g]?(d?(0<g&&a&&" "===e[g-1]?c=c.substring(0,c.length-1)+"\u0644":(c+="\u0644",h=!0),c+=V[(k-65269)/2]):(c+=V[(k-65269)/2],c+="\u0644",g+1<b.length&&a&&" "===e[g+1]?g++:h=!0),h&&(w(D,g,!0,1),E.splice(g,0,E[g]))):c+=K[k-65136]):c+=e[g];this.sourceToTarget=E;this.targetToSource=D;this.levels=C;return c},_inputFormatSetter:function(a){if(!M.test(a))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");
this.inputFormat=a},_outputFormatSetter:function(a){if(!M.test(a))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=a},checkParameters:function(a,b){a?this.set("inputFormat",a):a=this.inputFormat;b?this.set("outputFormat",b):b=this.outputFormat;return a===b?!1:!0},checkContextual:function(a){a=g(a);if("ltr"!==a&&"rtl"!==a){try{a=document.dir.toLowerCase()}catch(sa){}"ltr"!==a&&"rtl"!==a&&(a="ltr")}return a},hasBidiChar:function(a){return P.test(a)}});var E=
[],D=[],C=[],z={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1},x=5,v=6,B=0,J=1,M=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,P=/[\u0591-\u06ff\ufb1d-\ufefc]/,Q=[["(",")"],[")","("],["\x3c","\x3e"],["\x3e","\x3c"],["[","]"],["]","["],["{","}"],["}","{"],["\u00ab","\u00bb"],["\u00bb","\u00ab"],["\u2039","\u203a"],["\u203a","\u2039"],["\u207d","\u207e"],["\u207e","\u207d"],["\u208d","\u208e"],
["\u208e","\u208d"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232a"],["\u232a","\u2329"],["\ufe59","\ufe5a"],["\ufe5a","\ufe59"],["\ufe5b","\ufe5c"],["\ufe5c","\ufe5b"],["\ufe5d","\ufe5e"],["\ufe5e","\ufe5d"],["\ufe64","\ufe65"],["\ufe65","\ufe64"]],V=["\u0622","\u0623","\u0625","\u0627"],L=["\ufef5","\ufef7","\ufef9","\ufefb"],R=["\ufef6","\ufef8","\ufefa","\ufefc"],G="\u0627\u0628\u062a\u062b\u062c\u062d\u062e\u062f\u0630\u0631\u0632\u0633\u0634\u0635\u0636\u0637\u0638\u0639\u063a\u0641\u0642\u0643\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u06cc\u0626\u0624".split(""),
y="\ufe8d\ufe8f\ufe95\ufe99\ufe9d\ufea1\ufea5\ufea9\ufeab\ufead\ufeaf\ufeb1\ufeb5\ufeb9\ufebd\ufec1\ufec5\ufec9\ufecd\ufed1\ufed5\ufed9\ufedd\ufee1\ufee5\ufee9\ufeed\ufef1\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfc\ufe89\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe89\ufe85".split(""),I="\ufe8e\ufe90\ufe96\ufe9a\ufe9e\ufea2\ufea6\ufeaa\ufeac\ufeae\ufeb0\ufeb2\ufeb6\ufeba\ufebe\ufec2\ufec6\ufeca\ufece\ufed2\ufed6\ufeda\ufede\ufee2\ufee6\ufeea\ufeee\ufef2\ufe88\ufe84\ufe82\ufe94\ufef0\ufbfd\ufe8a\ufe86\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8a\ufe86".split(""),
H="\ufe8e\ufe92\ufe98\ufe9c\ufea0\ufea4\ufea8\ufeaa\ufeac\ufeae\ufeb0\ufeb4\ufeb8\ufebc\ufec0\ufec4\ufec8\ufecc\ufed0\ufed4\ufed8\ufedc\ufee0\ufee4\ufee8\ufeec\ufeee\ufef4\ufe88\ufe84\ufe82\ufe94\ufef0\ufbff\ufe8c\ufe86\ufe71\ufe72\ufe74\ufe77\ufe79\ufe7b\ufe7d\ufe7f\ufe80\ufe8c\ufe86".split(""),T="\ufe8d\ufe91\ufe97\ufe9b\ufe9f\ufea3\ufea7\ufea9\ufeab\ufead\ufeaf\ufeb3\ufeb7\ufebb\ufebf\ufec3\ufec7\ufecb\ufecf\ufed3\ufed7\ufedb\ufedf\ufee3\ufee7\ufeeb\ufeed\ufef3\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfe\ufe8b\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8b\ufe85".split(""),
S="\u0621\u0622\u0623\u0624\u0625\u0627\u0629\u062f\u0630\u0631\u0632\u0648\u0649".split(""),K="\u064b\u064b\u064c\u061f\u064d\u061f\u064e\u064e\u064f\u064f\u0650\u0650\u0651\u0651\u0652\u0652\u0621\u0622\u0622\u0623\u0623\u0624\u0624\u0625\u0625\u0626\u0626\u0626\u0626\u0627\u0627\u0628\u0628\u0628\u0628\u0629\u0629\u062a\u062a\u062a\u062a\u062b\u062b\u062b\u062b\u062c\u062c\u062c\u062c\u062d\u062d\u062d\u062d\u062e\u062e\u062e\u062e\u062f\u062f\u0630\u0630\u0631\u0631\u0632\u0632\u0633\u0633\u0633\u0633\u0634\u0634\u0634\u0634\u0635\u0635\u0635\u0635\u0636\u0636\u0636\u0636\u0637\u0637\u0637\u0637\u0638\u0638\u0638\u0638\u0639\u0639\u0639\u0639\u063a\u063a\u063a\u063a\u0641\u0641\u0641\u0641\u0642\u0642\u0642\u0642\u0643\u0643\u0643\u0643\u0644\u0644\u0644\u0644\u0645\u0645\u0645\u0645\u0646\u0646\u0646\u0646\u0647\u0647\u0647\u0647\u0648\u0648\u0649\u0649\u064a\u064a\u064a\u064a\ufef5\ufef6\ufef7\ufef8\ufef9\ufefa\ufefb\ufefc\u061f\u061f\u061f".split(""),
U=["\u0621","\u0641"],Z=["\u063a","\u064a"],W=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],fa=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],ba=0,ga=1,ca=2,ha=3,Y=4,aa=5,ka=6,la=7,ma=8,na=11,ja=12,oa="UBAT_L UBAT_R UBAT_EN UBAT_AN UBAT_ON UBAT_B UBAT_S UBAT_AL UBAT_WS UBAT_CS UBAT_ES UBAT_ET UBAT_NSM UBAT_LRE UBAT_RLE UBAT_PDF UBAT_LRO UBAT_RLO UBAT_BN".split(" "),da=100;a=ba;c=ga;var N=ca,X=ha,h=Y,ia=aa,pa=ka,k=la,ea=ma,
O=na,r=ja,qa=[da+0,a,a,a,a,da+1,da+2,da+3,c,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,da+4,h,h,h,a,h,a,h,a,h,h,h,a,a,h,h,a,a,a,a,a,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,a,a,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,a,a,a,a,a,a,a,a,a,a,a,a,a,a,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,a,a,h,h,a,a,h,h,a,a,h,h,h,h,h,h,h,h,h,h,h,
h,h,h,h,h,h,h,h,h,h,h,h,a,a,a,da+5,k,k,da+6,da+7],ra=[[18,18,18,18,18,18,18,18,18,pa,ia,pa,ea,ia,18,18,18,18,18,18,18,18,18,18,18,18,18,18,ia,ia,ia,pa,ea,h,h,O,O,O,h,h,h,h,h,10,9,10,9,9,N,N,N,N,N,N,N,N,N,N,9,h,h,h,h,h,h,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,h,h,h,h,h,h,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,h,h,h,h,18,18,18,18,18,18,ia,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,9,h,O,O,O,O,h,h,h,h,a,h,h,18,h,h,O,O,N,N,h,a,h,h,h,N,a,h,h,
h,h,h,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,h,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,h,a,a,a,a,a,a,a,a],[a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,h,h,h,h,h,h,h,h,h,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,h,h,a,a,a,a,a,a,a,h,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,h,a,h,h,h,h,h,h,h,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,
r,r,r,r,r,r,r,c,r,c,r,r,c,r,r,c,r,h,h,h,h,h,h,h,h,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,h,h,h,h,h,c,c,c,c,c,h,h,h,h,h,h,h,h,h,h,h],[X,X,X,X,h,h,h,h,k,O,O,k,9,k,h,h,r,r,r,r,r,r,r,r,r,r,r,k,h,h,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,X,X,X,X,X,X,X,X,X,X,O,X,X,k,k,k,r,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,
k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,r,r,r,r,r,r,r,X,h,r,r,r,r,r,r,k,k,r,r,h,r,r,r,r,k,k,N,N,N,N,N,N,N,N,N,N,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k,h,k,k,r,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,h,h,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,r,r,r,r,r,
r,r,r,r,r,r,k,h,h,h,h,h,h,h,h,h,h,h,h,h,h,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,r,r,r,r,r,r,r,r,r,c,c,h,h,h,h,c,h,h,h,h,h],[ea,ea,ea,ea,ea,ea,ea,ea,ea,ea,ea,18,18,18,a,c,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,ea,ia,13,14,15,16,17,9,O,O,O,O,O,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,9,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,ea,18,18,18,18,18,h,h,h,h,h,18,18,18,18,18,18,N,a,h,h,N,N,N,N,N,N,10,10,h,h,h,a,N,N,N,N,N,N,N,N,N,N,10,10,h,h,h,h,a,a,
a,a,a,a,a,a,a,a,a,a,a,h,h,h,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[a,a,a,a,a,a,a,h,h,h,h,h,h,h,h,h,h,h,h,a,a,a,a,a,h,h,h,h,h,c,r,c,c,c,c,c,c,c,c,c,c,10,c,c,c,c,c,c,c,c,c,c,c,c,c,h,c,c,c,c,c,h,c,h,c,c,h,c,c,h,c,c,c,c,c,c,c,c,c,c,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,
k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,r,r,r,r,r,r,r,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,9,h,9,h,h,9,h,h,h,h,h,h,h,h,h,O,h,h,10,10,h,h,h,h,h,O,O,h,h,h,h,h,k,k,k,k,k,h,k,k,k,k,k,k,k,k,k,k,k,k,k,k,
k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,h,h,18],[h,h,h,O,O,O,h,h,h,h,h,10,9,10,9,9,N,N,N,N,N,N,N,N,N,N,9,h,h,h,h,h,h,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,h,h,h,h,h,h,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,h,h,h,h,h,h,h,h,h,h,h,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,
a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,h,h,h,a,a,a,a,a,a,h,h,a,a,a,a,a,a,h,h,a,a,a,a,a,a,h,h,a,a,a,h,h,h,O,O,h,h,h,O,O,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h]];return n})},"dojo/Stateful":function(){define(["./_base/declare","./_base/lang","./_base/array","./when"],function(n,a,c,q){return n("dojo.Stateful",null,{_attrPairNames:{},_getAttrNames:function(a){var c=this._attrPairNames;return c[a]?
c[a]:c[a]={s:"_"+a+"Setter",g:"_"+a+"Getter"}},postscript:function(a){a&&this.set(a)},_get:function(a,c){return"function"===typeof this[c.g]?this[c.g]():this[a]},get:function(a){return this._get(a,this._getAttrNames(a))},set:function(a,c){if("object"===typeof a){for(var e in a)a.hasOwnProperty(e)&&"_watchCallbacks"!=e&&this.set(e,a[e]);return this}e=this._getAttrNames(a);var b=this._get(a,e);e=this[e.s];var f;"function"===typeof e?f=e.apply(this,Array.prototype.slice.call(arguments,1)):this[a]=c;
if(this._watchCallbacks){var g=this;q(f,function(){g._watchCallbacks(a,b,c)})}return this},_changeAttrValue:function(a,c){var e=this.get(a);this[a]=c;this._watchCallbacks&&this._watchCallbacks(a,e,c);return this},watch:function(a,e){var g=this._watchCallbacks;if(!g)var b=this,g=this._watchCallbacks=function(a,d,f,c){var e=function(c){if(c){c=c.slice();for(var e=0,g=c.length;e<g;e++)c[e].call(b,a,d,f)}};e(g["_"+a]);c||e(g["*"])};e||"function"!==typeof a?a="_"+a:(e=a,a="*");var f=g[a];"object"!==typeof f&&
(f=g[a]=[]);f.push(e);a={};a.unwatch=a.remove=function(){var a=c.indexOf(f,e);-1<a&&f.splice(a,1)};return a}})})},"esri/views/2d/engine/webgl/TextShaping":function(){define(["require","exports","./Rect"],function(n,a,c){return function(){function a(a,c,m,b,f,l,d,p){this._glyphItems=a;this._maxWidth=c;this._lineHeight=m;this._letterSpacing=b;this._offset=f;this._hAnchor=l;this._vAnchor=d;this._justify=p}a.prototype.getShaping=function(a,c){for(var e=this._letterSpacing,b=this._lineHeight,f=this._justify,
g=this._maxWidth,d=[],p=0,t=0,q=0,n=0,u=-1,w=0,E=-1,D=a.length,C=0;C<D;C++){var z=a.charCodeAt(C);if(10===z){if(C!==D-1){if(u>=n){var p=d[u],x=p.x+p.glyphMosaicItem.metrics.advance,w=Math.max(x,w);f&&this._applyJustification(d,n,u);n=d.length}t=c?t-b:t+b;p=0;++q}}else{for(var x=void 0,v=0,B=this._glyphItems;v<B.length&&!(x=B[v][z]);v++);if(x){d.push({codePoint:z,x:p,y:t,glyphMosaicItem:x});p+=x.metrics.advance+e;if(0<g&&p>g&&0<=E){v=E+1;x=d[v].x;w=Math.max(x,w);for(B=v;B<d.length;B++)d[B].y=c?d[B].y-
b:d[B].y+b,d[B].x-=x;f&&this._applyJustification(d,n,E);t=c?t-b:t+b;p-=x;++q;n=v;E=-1}++u;32===z&&(E=d.length-1)}}}u>=n&&(p=d[u],w=Math.max(w,p.x+p.glyphMosaicItem.metrics.advance),f&&this._applyJustification(d,n,u));if(0<d.length)for(a=(f-this._hAnchor)*w,e=(-this._vAnchor*(q+1)+.5)*b,c&&q&&(e+=q*b),a+=this._offset[0],e+=this._offset[1],c=0;c<d.length;c++)b=d[c],b.x+=a,b.y+=e;return d};a.getBox=function(a){var c=a.length;if(0!==c){for(var g=a[0].x+a[0].glyphMosaicItem.metrics.left,b=g,f=a[0].y,l=
f,d=f,p=1;p<c;p++){var q=a[p],n=q.x+q.glyphMosaicItem.metrics.left;n<g&&(g=n);n>b&&(b=n);q=q.y;q<f&&(f=q);q>l&&(l=q);q!==d&&(b=Math.max(b,a[p-1].x+a[p-1].glyphMosaicItem.metrics.left+a[p-1].glyphMosaicItem.metrics.width),d=q)}b=Math.max(b,a[c-1].x+a[c-1].glyphMosaicItem.metrics.left+a[c-1].glyphMosaicItem.metrics.width);l+=12;return{x:g,y:l,width:b-g,height:l-(f-12)}}};a.addDecoration=function(a,e){var g=a.length;if(0!==g){for(var b=a[0].x+a[0].glyphMosaicItem.metrics.left,f=a[0].y,l=1;l<g;l++){var d=
a[l];if(d.y!==f){var p=a[l-1].x+a[l-1].glyphMosaicItem.metrics.left+a[l-1].glyphMosaicItem.metrics.width;a.push({codePoint:0,x:b,y:f+e-3,glyphMosaicItem:{rect:new c(4,0,4,8),metrics:{width:p-b,height:8,left:0,top:0,advance:0},page:0}});f=d.y;b=d.x+d.glyphMosaicItem.metrics.left}}g=a[g-1].x+a[g-1].glyphMosaicItem.metrics.left+a[g-1].glyphMosaicItem.metrics.width;a.push({codePoint:0,x:b,y:f+e-3,glyphMosaicItem:{rect:new c(4,0,4,8),metrics:{width:g-b,height:8,left:0,top:0,advance:0},page:0}})}};a.prototype._applyJustification=
function(a,c,m){for(var b=a[m],b=(b.x+b.glyphMosaicItem.metrics.advance)*this._justify;c<=m;c++)a[c].x-=b};return a}()})},"esri/views/2d/engine/webgl/Rect":function(){define(["require","exports"],function(n,a){return function(){function a(a,c,e,m){void 0===a&&(a=0);void 0===c&&(c=0);void 0===e&&(e=0);void 0===m&&(m=0);this.x=a;this.y=c;this.width=e;this.height=m}Object.defineProperty(a.prototype,"isEmpty",{get:function(){return 0>=this.width||0>=this.height},enumerable:!0,configurable:!0});return a}()})},
"esri/views/vectorTiles/TileParser":function(){define("require exports dojo/promise/all ../../core/executeAsync ../../core/pbf ../../core/promiseUtils ../2d/engine/webgl/TileClipper ../2d/tiling/enums ./BackgroundBucket ./CircleBucket ./Feature ./FillBucket ./LineBucket ./SourceLayerData ./SymbolBucket".split(" "),function(n,a,c,q,g,e,m,b,f,l,d,p,t,A,F){return function(){function a(a,b,d){this._pbfTile=new g(new Uint8Array(a),new DataView(a));this._tile=b;this._connection=d;this._layers=b.getLayers();
d=b.tileKey.split("/").map(parseFloat);var c=d[0];a=d[1];d=d[2];this._level=c;b.refKey&&(b=b.refKey.split("/").map(parseFloat)[0],b=c-b,0<b&&(c=(1<<b)-1,this._tileClipper=new m.TileClipper(b,a&c,d&c)));this._tileClipper||(this._tileClipper=new m.SimpleBuilder)}a.prototype.parse=function(){for(var a=this,f=this._parseTileData(this._pbfTile),g=this._layers,l=g.length,p=this._level,m,t=[],n={},u=new Set,l=l-1;0<=l;l--)if(m=g[l],!(m.minzoom&&p<m.minzoom||m.maxzoom&&p>=m.maxzoom||m.layout&&"none"===m.layout.visibility))if(0===
m.type)m=this._createBucket(m),m.layerIndex=l,t.push(m);else{var A=m.sourceLayer,F=f[A];F&&(u.add(A),m=this._createBucket(m))&&(m.layerIndex=l,m.layerExtent=F.extent,(F=n[A])||(F=n[A]=[]),F.push(m))}var Q=10*this._level,V=10*(this._level+1),L=[],R=[],G=[],y=[],I=this._tileClipper,H=new Set,T={},S=[];u.forEach(function(a){return S.push(a)});var K=0,U=0,Z=S.length;return q(function(){if(a._tile.status===b.TileStatus.INVALID)return!0;switch(K){case 0:if(U<Z){var c=S[U++],e=f[c],g=n[c];if(g&&0!==g.length)for(c=
e.getData();c.next(2);){var l=new d(c.getMessage(),e),m=l.values;if(m){var p=m._minzoom;if(p&&p>=V)continue;if((m=m._maxzoom)&&m<=Q)continue}for(var p=0,q=g;p<q.length;p++)m=q[p],m.pushFeature(l)}}else{e=a._tile;for(c in n)for(g=n[c],l=0;l<g.length;l++)m=g[l],m.hasFeatures()&&(3===m.layer.type?(L.push(m),e.addBucket(m)):m.layer.refLayerId?G.push(m):(R.push(m),y[m.layer.id]=m));K=1;U=0;Z=L.length}break;case 1:U<Z?L[U++].getResources(I,H,T):K=2}return 2===K}).then(function(){if(a._tile.status===b.TileStatus.INVALID)return[];
var d=[],f=a._tile.getWorkerTileHandler(),g;0<H.size&&(g=f.fetchSprites(H,a._connection),d.push(g));for(var l in T)g=T[l],0<g.size&&(g=f.fetchGlyphs(a._tile.tileKey,l,g,a._connection),d.push(g));return c(d).then(function(d){if(a._tile.status===b.TileStatus.INVALID)return[];var c=0,f=0,e=R.length;return q(function(){if(a._tile.status===b.TileStatus.INVALID)return!0;switch(c){case 0:if(f<e){var d=R[f++];d.processFeatures(I,a._tile);t.push(d)}else c=1,f=0,e=G.length;break;case 1:for(var g=0;g<G.length;g++){var d=
G[g],l=y[d.layer.refLayerId];l&&(l.assignBufferInfo(d),t.push(d))}c=2;f=0;e=L.length;break;case 2:f<e?(d=L[f++],d.processFeatures(I,a._tile),t.push(d)):c=3}return 3===c}).then(function(){t.sort(function(a,b){return a.layerIndex-b.layerIndex});return t})}).catch(function(a){return e.reject(Error(a))})}).catch(function(a){return e.reject(Error(a))})};a.prototype._parseTileData=function(a){for(var b={};a.next();)switch(a.tag()){case 3:var d=new A(a.getMessage());b[d.name]=d;break;default:a.skip()}return b};
a.prototype._createBucket=function(a){switch(a.type){case 0:return this._createBackgroundBucket(a);case 1:return this._createFillBucket(a);case 2:return this._createLineBucket(a);case 4:return this._createCircleBucket(a);case 3:return this._createSymbolBucket(a)}};a.prototype._createBackgroundBucket=function(a){return new f(a,this._level)};a.prototype._createFillBucket=function(a){var b=this._tile;return new p(a,this._level,a.hasDataDrivenFill?b.fillDDVertexBuffer:b.fillVertexBuffer,b.fillIndexBuffer,
a.hasDataDrivenOutline?b.outlineDDVertexBuffer:b.outlineVertexBuffer,b.outlineIndexBuffer)};a.prototype._createLineBucket=function(a){var b=this._tile;return new t(a,this._level,a.hasDataDrivenLine?b.lineDDVertexBuffer:b.lineVertexBuffer,b.lineIndexBuffer)};a.prototype._createCircleBucket=function(a){var b=this._tile;return new l(a,this._level,b.circleVertexBuffer,b.circleIndexBuffer)};a.prototype._createSymbolBucket=function(a){var b=this._tile;return new F(a,this._level,a.hasDataDrivenIcon?b.iconDDVertexBuffer:
b.iconVertexBuffer,b.iconIndexBuffer,a.hasDataDrivenText?b.textDDVertexBuffer:b.textVertexBuffer,b.textIndexBuffer,b.placementEngine,b.getWorkerTileHandler())};return a}()})},"esri/core/pbf":function(){define(["require","exports"],function(n,a){return function(){function a(a,c,e,m){this._tag=0;this._dataType=99;this._data=a;this._dataView=c;this._pos=e||0;this._end=m||a.byteLength}a.prototype.clone=function(){return new a(this._data,this._dataView,this._pos,this._end)};a.prototype.pos=function(){return this._pos};
a.prototype.next=function(a){for(;;){if(this._pos===this._end)return!1;var c=this._decodeVarint();this._tag=c>>3;this._dataType=c&7;if(!a||a===this._tag)break;this.skip()}return!0};a.prototype.empty=function(){return this._pos>=this._end};a.prototype.tag=function(){return this._tag};a.prototype.getInt32=function(){return this._decodeVarint()};a.prototype.getInt64=function(){return this._decodeVarint()};a.prototype.getUInt32=function(){var a=4294967295,a=(this._data[this._pos]&127)>>>0;if(128>this._data[this._pos++])return a;
a=(a|(this._data[this._pos]&127)<<7)>>>0;if(128>this._data[this._pos++])return a;a=(a|(this._data[this._pos]&127)<<14)>>>0;if(128>this._data[this._pos++])return a;a=(a|(this._data[this._pos]&127)<<21)>>>0;if(128>this._data[this._pos++])return a;a=(a|(this._data[this._pos]&15)<<28)>>>0;if(128>this._data[this._pos++])return a};a.prototype.getUInt64=function(){return this._decodeVarint()};a.prototype.getSInt32=function(){var a=this.getUInt32();return a>>>1^-(a&1)|0};a.prototype.getSInt64=function(){return this._decodeSVarint()};
a.prototype.getBool=function(){var a=0!==this._data[this._pos];this._skip(1);return a};a.prototype.getEnum=function(){return this._decodeVarint()};a.prototype.getFixed64=function(){var a=this._dataView,c=this._pos,a=a.getUint32(c,!0)+4294967296*a.getUint32(c+4,!0);this._skip(8);return a};a.prototype.getSFixed64=function(){var a=this._dataView,c=this._pos,a=a.getUint32(c,!0)+4294967296*a.getInt32(c+4,!0);this._skip(8);return a};a.prototype.getDouble=function(){var a=this._dataView.getFloat64(this._pos,
!0);this._skip(8);return a};a.prototype.getFixed32=function(){var a=this._dataView.getUint32(this._pos,!0);this._skip(4);return a};a.prototype.getSFixed32=function(){var a=this._dataView.getInt32(this._pos,!0);this._skip(4);return a};a.prototype.getFloat=function(){var a=this._dataView.getFloat32(this._pos,!0);this._skip(4);return a};a.prototype.getString=function(){var a=this._getLength(),c=this._pos,c=this._toString(this._data,c,c+a);this._skip(a);return c};a.prototype.getBytes=function(){var a=
this._getLength(),c=this._pos,c=this._toBytes(this._data,c,c+a);this._skip(a);return c};a.prototype.getMessage=function(){var c=this._getLength(),g=this._pos,g=new a(this._data,this._dataView,g,g+c);this._skip(c);return g};a.prototype.skip=function(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw Error("Invalid data type!");}};a.prototype._skip=function(a){if(this._pos+a>this._end)throw Error("Attempt to skip past the end of buffer!");
this._pos+=a};a.prototype._decodeVarint=function(){var a=this._data,c=this._pos,e=0,m;if(10<=this._end-c){if(m=a[c++],e|=m&127,0!==(m&128)&&(m=a[c++],e|=(m&127)<<7,0!==(m&128)&&(m=a[c++],e|=(m&127)<<14,0!==(m&128)&&(m=a[c++],e|=(m&127)<<21,0!==(m&128)&&(m=a[c++],e+=268435456*(m&127),0!==(m&128)&&(m=a[c++],e+=34359738368*(m&127),0!==(m&128)&&(m=a[c++],e+=4398046511104*(m&127),0!==(m&128)&&(m=a[c++],e+=562949953421312*(m&127),0!==(m&128)&&(m=a[c++],e+=72057594037927936*(m&127),0!==(m&128)&&(m=a[c++],
e+=0x7fffffffffffffff*(m&127),0!==(m&128)))))))))))throw Error("Varint too long!");}else{for(var b=1;c!==this._end;){m=a[c];if(0===(m&128))break;++c;e+=(m&127)*b;b*=128}if(c===this._end)throw Error("Varint overrun!");++c;e+=m*b}this._pos=c;return e};a.prototype._decodeSVarint=function(){var a=this._decodeVarint();return a%2?-(a+1)/2:a/2};a.prototype._getLength=function(){if(2!==this._dataType)throw Error("Not a delimited data type!");return this._decodeVarint()};a.prototype._toString=function(a,c,
e){var g="",b="";for(e=Math.min(this._end,e);c<e;++c){var f=a[c];f&128?b+="%"+f.toString(16):(g+=decodeURIComponent(b)+String.fromCharCode(f),b="")}b.length&&(g+=decodeURIComponent(b));return g};a.prototype._toBytes=function(a,c,e){e=Math.min(this._end,e);return new Uint8Array(a.buffer,c,e-c)};return a}()})},"esri/views/2d/engine/webgl/TileClipper":function(){define(["require","exports","./Geometry","./GeometryUtils"],function(n,a,c,q){Object.defineProperty(a,"__esModule",{value:!0});var g=function(){return function(a,
b,c){this.ratio=a;this.x=b;this.y=c}}();n=function(){function a(a,c,e,d,g){void 0===d&&(d=8);void 0===g&&(g=8);this.lines=[];this.starts=[];this.pixelRatio=d;this.pixelMargin=g;this.tileSize=512*d;this.dz=a;this.yPos=c;this.xPos=e}a.prototype.setExtent=function(a){this.finalRatio=this.tileSize/a*(1<<this.dz);var b=this.pixelRatio*this.pixelMargin,b=b/this.finalRatio;a>>=this.dz;b>a&&(b=a);this.margin=b;this.xmin=a*this.xPos-b;this.ymin=a*this.yPos-b;this.xmax=this.xmin+a+2*b;this.ymax=this.ymin+a+
2*b};a.prototype.reset=function(a){this.type=a;this.lines=[];this.starts=[];this.line=null;this.start=0};a.prototype.moveTo=function(a,f){this._pushLine();this._prevIsIn=this._isIn(a,f);this._moveTo(a,f,this._prevIsIn);this._prevPt=new c.Point(a,f);this._firstPt=new c.Point(a,f);this._dist=0};a.prototype.lineTo=function(a,f){var b=this._isIn(a,f),d=new c.Point(a,f),e=c.Point.distance(this._prevPt,d),m,n,q;if(b)this._prevIsIn?this._lineTo(a,f,!0):(m=this._prevPt,n=d,a=this._intersect(n,m),this.start=
this._dist+e*(1-this._r),this._lineTo(a.x,a.y,!0),this._lineTo(n.x,n.y,!0));else if(this._prevIsIn)n=this._prevPt,m=d,a=this._intersect(n,m),this._lineTo(a.x,a.y,!0),this._lineTo(m.x,m.y,!1);else{var u=this._prevPt;if(!(u.x<=this.xmin&&d.x<=this.xmin||u.x>=this.xmax&&d.x>=this.xmax||u.y<=this.ymin&&d.y<=this.ymin||u.y>=this.ymax&&d.y>=this.ymax)){a=[];if(u.x<this.xmin&&d.x>this.xmin||u.x>this.xmin&&d.x<this.xmin)f=(this.xmin-u.x)/(d.x-u.x),q=u.y+f*(d.y-u.y),q<=this.ymin?n=!1:q>=this.ymax?n=!0:a.push(new g(f,
this.xmin,q));if(u.x<this.xmax&&d.x>this.xmax||u.x>this.xmax&&d.x<this.xmax)f=(this.xmax-u.x)/(d.x-u.x),q=u.y+f*(d.y-u.y),q<=this.ymin?n=!1:q>=this.ymax?n=!0:a.push(new g(f,this.xmax,q));if(u.y<this.ymin&&d.y>this.ymin||u.y>this.ymin&&d.y<this.ymin)f=(this.ymin-u.y)/(d.y-u.y),q=u.x+f*(d.x-u.x),q<=this.xmin?m=!1:q>=this.xmax?m=!0:a.push(new g(f,q,this.ymin));if(u.y<this.ymax&&d.y>this.ymax||u.y>this.ymax&&d.y<this.ymax)f=(this.ymax-u.y)/(d.y-u.y),q=u.x+f*(d.x-u.x),q<=this.xmin?m=!1:q>=this.xmax?m=
!0:a.push(new g(f,q,this.ymax));if(0===a.length)m?n?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):n?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(1<a.length&&a[0].ratio>a[1].ratio)this.start=this._dist+e*a[1].ratio,this._lineTo(a[1].x,a[1].y,!0),this._lineTo(a[0].x,a[0].y,!0);else for(this.start=this._dist+e*a[0].ratio,m=0;m<a.length;m++)this._lineTo(a[m].x,a[m].y,!0)}this._lineTo(d.x,d.y,!1)}this._dist+=e;this._prevIsIn=b;this._prevPt=
d};a.prototype.close=function(){if(2<this.line.length){var a=this._firstPt,c=this._prevPt;a.x===c.x&&a.y===c.y||this.lineTo(a.x,a.y);a=this.line;for(c=a.length;4<=c;)if(a[0].x===a[1].x&&a[0].x===a[c-2].x||a[0].y===a[1].y&&a[0].y===a[c-2].y)a.pop(),a[0].x=a[c-2].x,a[0].y=a[c-2].y,--c;else break}};a.prototype.result=function(a){void 0===a&&(a=!0);this._pushLine();if(0===this.lines.length)return null;3===this.type&&a&&e.simplify(this.tileSize,this.margin*this.finalRatio,this.lines);return this.lines};
a.prototype.resultWithStarts=function(){if(2!==this.type)throw Error("Only valid for lines");this._pushLine();var a=this.lines,c=a.length;if(0===c)return null;for(var e=[],d=0;d<c;d++)e.push({line:a[d],start:this.starts[d]||0});return e};a.prototype._isIn=function(a,c){return a>=this.xmin&&a<=this.xmax&&c>=this.ymin&&c<=this.ymax};a.prototype._intersect=function(a,f){var b,d,e;if(f.x>=this.xmin&&f.x<=this.xmax)d=f.y<=this.ymin?this.ymin:this.ymax,e=(d-a.y)/(f.y-a.y),b=a.x+e*(f.x-a.x);else if(f.y>=
this.ymin&&f.y<=this.ymax)b=f.x<=this.xmin?this.xmin:this.xmax,e=(b-a.x)/(f.x-a.x),d=a.y+e*(f.y-a.y);else{d=f.y<=this.ymin?this.ymin:this.ymax;b=f.x<=this.xmin?this.xmin:this.xmax;var g=(b-a.x)/(f.x-a.x),m=(d-a.y)/(f.y-a.y);g<m?(e=g,d=a.y+g*(f.y-a.y)):(e=m,b=a.x+m*(f.x-a.x))}this._r=e;return new c.Point(b,d)};a.prototype._pushLine=function(){this.line&&(1===this.type?0<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):2===this.type?1<this.line.length&&(this.lines.push(this.line),
this.starts.push(this.start)):3===this.type&&3<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)));this.line=[];this.start=0};a.prototype._moveTo=function(a,f,e){3!==this.type?e&&(a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),f=Math.round((f-(this.ymin+this.margin))*this.finalRatio),this.line.push(new c.Point(a,f))):(e||(a<this.xmin&&(a=this.xmin),a>this.xmax&&(a=this.xmax),f<this.ymin&&(f=this.ymin),f>this.ymax&&(f=this.ymax)),a=Math.round((a-(this.xmin+this.margin))*
this.finalRatio),f=Math.round((f-(this.ymin+this.margin))*this.finalRatio),this.line.push(new c.Point(a,f)),this._is_v=this._is_h=!1)};a.prototype._lineTo=function(a,f,e){if(3!==this.type)if(e){a=Math.round((a-(this.xmin+this.margin))*this.finalRatio);f=Math.round((f-(this.ymin+this.margin))*this.finalRatio);if(0<this.line.length&&(e=this.line[this.line.length-1],e.equals(a,f)))return;this.line.push(new c.Point(a,f))}else this.line&&0<this.line.length&&this._pushLine();else if(e||(a<this.xmin&&(a=
this.xmin),a>this.xmax&&(a=this.xmax),f<this.ymin&&(f=this.ymin),f>this.ymax&&(f=this.ymax)),a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),f=Math.round((f-(this.ymin+this.margin))*this.finalRatio),this.line&&0<this.line.length){e=this.line[this.line.length-1];var b=e.x===a,g=e.y===f;b&&g||(this._is_h&&b?(e.x=a,e.y=f,e=this.line[this.line.length-2],e.x===a&&e.y===f?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(e=this.line[this.line.length-2],this._is_h=e.x===a,this._is_v=
e.y===f)):(this._is_h=e.x===a,this._is_v=e.y===f)):this._is_v&&g?(e.x=a,e.y=f,e=this.line[this.line.length-2],e.x===a&&e.y===f?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(e=this.line[this.line.length-2],this._is_h=e.x===a,this._is_v=e.y===f)):(this._is_h=e.x===a,this._is_v=e.y===f)):(this.line.push(new c.Point(a,f)),this._is_h=b,this._is_v=g))}else this.line.push(new c.Point(a,f))};return a}();a.TileClipper=n;n=function(){function a(){}a.prototype.setExtent=function(a){this._ratio=
4096===a?1:4096/a};a.prototype.reset=function(a){this.type=a;this.lines=[];this.line=null};a.prototype.moveTo=function(a,e){this.line&&this.lines.push(this.line);this.line=[];var b=this._ratio;this.line.push(new c.Point(Math.round(a*b),Math.round(e*b)))};a.prototype.lineTo=function(a,e){var b=this._ratio;this.line.push(new c.Point(Math.round(a*b),Math.round(e*b)))};a.prototype.close=function(){var a=this.line;a&&!a[0].isEqual(a[a.length-1])&&a.push(a[0])};a.prototype.result=function(){this.line&&
this.lines.push(this.line);if(0===this.lines.length)return null;3===this.type&&1!==this._ratio&&e.simplify(4096,64,this.lines);return this.lines};return a}();a.SimpleBuilder=n;var e=function(){function a(){}a.simplify=function(b,c,e){if(e){var d=-c,f=b+c,g=-c,l=b+c;b=[];c=[];for(var m=e.length,n=0;n<m;++n){var q=e[n];if(q&&!(2>q.length))for(var E=q[0],D=void 0,C=q.length,z=1;z<C;++z)D=q[z],E.x===D.x&&(E.x<=d&&(E.y>D.y?(b.push(n),b.push(z),b.push(0),b.push(-1)):(c.push(n),c.push(z),c.push(0),c.push(-1))),
E.x>=f&&(E.y<D.y?(b.push(n),b.push(z),b.push(1),b.push(-1)):(c.push(n),c.push(z),c.push(1),c.push(-1)))),E.y===D.y&&(E.y<=g&&(E.x<D.x?(b.push(n),b.push(z),b.push(2),b.push(-1)):(c.push(n),c.push(z),c.push(2),c.push(-1))),E.y>=l&&(E.x>D.x?(b.push(n),b.push(z),b.push(3),b.push(-1)):(c.push(n),c.push(z),c.push(3),c.push(-1)))),E=D}0!==b.length&&0!==c.length&&(a.fillParent(e,c,b),a.fillParent(e,b,c),d=[],a.calcDeltas(d,c,b),a.calcDeltas(d,b,c),a.addDeltas(d,e))}};a.fillParent=function(a,c,e){for(var b=
e.length,f=c.length,g=0;g<f;g+=4){for(var l=c[g],m=c[g+1],n=c[g+2],w=a[l][m-1],l=a[l][m],m=8092,E=-1,D=0;D<b;D+=4)if(e[D+2]===n){var C=e[D],z=e[D+1],x=a[C][z-1],C=a[C][z];switch(n){case 0:case 1:q.between(w.y,x.y,C.y)&&q.between(l.y,x.y,C.y)&&(x=Math.abs(C.y-x.y),x<m&&(m=x,E=D));break;case 2:case 3:q.between(w.x,x.x,C.x)&&q.between(l.x,x.x,C.x)&&(x=Math.abs(C.x-x.x),x<m&&(m=x,E=D))}}c[g+3]=E}};a.calcDeltas=function(b,c,e){for(var d=c.length,f=0;f<d;f+=4){var g=a.calcDelta(f,c,e,[]);b.push(c[f]);b.push(c[f+
1]);b.push(c[f+2]);b.push(g)}};a.calcDelta=function(b,c,e,d){b=c[b+3];if(-1===b)return 0;var f=d.length;if(1<f&&d[f-2]===b)return 0;d.push(b);return a.calcDelta(b,e,c,d)+1};a.addDeltas=function(a,c){for(var b=a.length,d=0,e=0;e<b;e+=4){var f=a[e+3];f>d&&(d=f)}for(e=0;e<b;e+=4){var g=c[a[e]],m=a[e+1],f=d-a[e+3];switch(a[e+2]){case 0:g[m-1].x-=f;g[m].x-=f;1===m&&(g[g.length-1].x-=f);m===g.length-1&&(g[0].x-=f);break;case 1:g[m-1].x+=f;g[m].x+=f;1===m&&(g[g.length-1].x+=f);m===g.length-1&&(g[0].x+=f);
break;case 2:g[m-1].y-=f;g[m].y-=f;1===m&&(g[g.length-1].y-=f);m===g.length-1&&(g[0].y-=f);break;case 3:g[m-1].y+=f,g[m].y+=f,1===m&&(g[g.length-1].y+=f),m===g.length-1&&(g[0].y+=f)}}};return a}()})},"esri/views/2d/engine/webgl/GeometryUtils":function(){define(["require","exports"],function(n,a){function c(a,c){a%=c;return 0<=a?a:a+c}Object.defineProperty(a,"__esModule",{value:!0});a.C_INFINITY=Number.POSITIVE_INFINITY;a.C_PI=Math.PI;a.C_2PI=2*a.C_PI;a.C_PI_BY_2=a.C_PI/2;a.C_RAD_TO_256=128/a.C_PI;
a.C_256_TO_RAD=a.C_PI/128;a.C_DEG_TO_256=256/360;a.C_DEG_TO_RAD=a.C_PI/180;a.C_SQRT2=1.414213562;a.C_SQRT2_INV=1/a.C_SQRT2;var q=1/Math.LN2;a.positiveMod=c;a.radToByte=function(g){return c(g*a.C_RAD_TO_256,256)};a.degToByte=function(g){return c(g*a.C_DEG_TO_256,256)};a.log2=function(a){return Math.log(a)*q};a.sqr=function(a){return a*a};a.clamp=function(a,c,m){return Math.min(Math.max(a,c),m)};a.interpolate=function(a,c,m){return a*(1-m)+c*m};a.between=function(a,c,m){return a>=c&&a<=m||a>=m&&a<=
c}})},"esri/views/vectorTiles/Feature":function(){define(["require","exports","../2d/engine/webgl/Geometry"],function(n,a,c){return function(){function a(a,c){this.values={};var e=c.keys;for(c=c.values;a.next();)switch(a.tag()){case 1:this.id=a.getUInt64();break;case 2:for(var b=a.getMessage(),f=this.values;!b.empty();){var g=b.getUInt32(),d=b.getUInt32();f[e[g]]=c[d]}break;case 3:this.type=a.getUInt32();break;case 4:this._pbfGeometry=a.getMessage();break;default:a.skip()}}a.prototype.getGeometry=
function(a){if(void 0!==this._geometry)return this._geometry;var e=this._pbfGeometry,g,b;a?a.reset(this.type):g=[];for(var f=1,l=0,d=0,p=0;!e.empty();)switch(0===l&&(l=e.getUInt32(),f=l&7,l>>=3),l--,f){case 1:d+=e.getSInt32();p+=e.getSInt32();a?a.moveTo(d,p):(b&&g.push(b),b=[],b.push(new c.Point(d,p)));break;case 2:d+=e.getSInt32();p+=e.getSInt32();a?a.lineTo(d,p):b.push(new c.Point(d,p));break;case 7:a?a.close():b&&!b[0].equals(d,p)&&b.push(b[0].clone());break;default:throw Error("Invalid path operation");
}a?a=a.result():(b&&g.push(b),a=g);return this._geometry=a};return a}()})},"esri/views/vectorTiles/SourceLayerData":function(){define(["require","exports"],function(n,a){return function(){function a(c){this.extent=4096;this.keys=[];this.values=[];for(this._pbfLayer=c.clone();c.next();)switch(c.tag()){case 1:this.name=c.getString();break;case 3:this.keys.push(c.getString());break;case 4:this.values.push(a._parseValue(c.getMessage()));break;case 5:this.extent=c.getUInt32();break;default:c.skip()}}a.prototype.getData=
function(){return this._pbfLayer};a._parseValue=function(a){for(;a.next();)switch(a.tag()){case 1:return a.getString();case 2:return a.getFloat();case 3:return a.getDouble();case 4:return a.getInt64();case 5:return a.getUInt64();case 6:return a.getSInt64();case 7:return a.getBool();default:a.skip()}return null};return a}()})},"esri/views/vectorTiles/VertexMemoryBuffer":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper ./GeometryUtils ./MemoryBuffer".split(" "),
function(n,a,c,q,g,e){Object.defineProperty(a,"__esModule",{value:!0});var m=new Float32Array(1),b=new Uint32Array(m.buffer);n=function(a){function f(b){var c=a.call(this,b?20:12)||this;c._isDataDriven=b;return c}c(f,a);f.prototype.isDataDriven=function(){return this._isDataDriven};f.prototype.add=function(a,c,f,g,l,n,q,E){var d=this.array;a=e.i1616to32(a,c);d.push(a);a=e.i8888to32(Math.round(31*f),Math.round(31*g),Math.round(31*l),Math.round(31*n));d.push(a);a=e.i1616to32(q,0);d.push(a);if(this._isDataDriven){if(!E)throw Error("Expecting data driven values.");
f=E.color;g=f[3]*E.opacity*255;d.push(e.i8888to32(f[0]*g,f[1]*g,f[2]*g,g));m[0]=E.size;d.push(b[0])}};return f}(e);a.LineVertexBuffer=n;n=function(a){function b(b){var c=a.call(this,b?8:4)||this;c._isDataDriven=b;return c}c(b,a);b.prototype.isDataDriven=function(){return this._isDataDriven};b.prototype.add=function(a,b,c){var d=this.array;d.push(e.i1616to32(a,b));if(this._isDataDriven){if(!c)throw Error("Expecting data driven values.");a=c.color;c=a[3]*c.opacity*255;d.push(e.i8888to32(a[0]*c,a[1]*
c,a[2]*c,c))}};return b}(e);a.FillVertexBuffer=n;n=function(a){function b(b){var c=a.call(this,b?12:8)||this;c._isDataDriven=b;return c}c(b,a);b.prototype.isDataDriven=function(){return this._isDataDriven};b.prototype.add=function(a,b,c,f,g,l,m){var d=this.array,p=this.index;a=e.i1616to32(a,b);d.push(a);a=e.i8888to32(Math.round(15*c),Math.round(15*f),g,l);d.push(a);if(this._isDataDriven){if(!m)throw Error("Expecting data driven values.");c=m.color;m=c[3]*m.opacity*255;d.push(e.i8888to32(c[0]*m,c[1]*
m,c[2]*m,m))}return p};return b}(e);a.OutlineVertexBuffer=n;n=function(a){function f(b){var c=a.call(this,b?24:16)||this;c._isDataDriven=b;return c}c(f,a);f.prototype.isDataDriven=function(){return this._isDataDriven};f.prototype.add=function(a,c,f,l,n,q,w,E,D,C,z){var d=this.array;a=e.i1616to32(a,c);d.push(a);a=e.i1616to32(Math.round(8*f),Math.round(8*l));d.push(a);a=e.i8888to32(n/4,q/4,0,0);d.push(a);a=e.i8888to32(Math.ceil(10*C),g.radToByte(w),10*E,Math.min(10*D,255));d.push(a);if(this._isDataDriven){if(!z)throw Error("Expecting data driven values.");
f=z.color;l=f[3]*z.opacity*255;d.push(e.i8888to32(f[0]*l,f[1]*l,f[2]*l,l));m[0]=z.size;d.push(b[0])}};return f}(e);a.SymbolVertexBuffer=n;n=function(a){function b(){return a.call(this,16)||this}c(b,a);b.prototype.add=function(a,b,c,f,g,l,m,n,q,C,z){var d=this.array;a=e.i1616to32(2*a+c,2*b+f);d.push(a);m=l[3]*m*255;a=e.i8888to32(l[0]*m,l[1]*m,l[2]*m,m);d.push(a);l=C[3]*z*255;a=e.i8888to32(C[0]*l,C[1]*l,C[2]*l,l);d.push(a);a=e.i8888to32(Math.min(32*n,255),Math.min(4*q,255),Math.min(g,255),0);d.push(a)};
return b}(e);a.CircleVertexBuffer=n})},"esri/views/vectorTiles/style/StyleRepository":function(){define(["require","exports","dojo/has","./StyleLayer"],function(n,a,c,q){return function(){function a(c,g){this.styleJSON=c;this.version=parseFloat(c.version);this.sprite=g?g.spriteUrl:c.sprite;this.glyphs=g?g.glyphsUrl:c.glyphs;this.layers=(c.layers||[]).map(a._create);this._identifyRefLayers()}a.prototype._identifyRefLayers=function(){for(var a=[],c=[],b=0,f=0,g=this.layers;f<g.length;f++){var d=g[f];
if(1===d.type){var p=d,n=d.sourceLayer,n=n+("|"+JSON.stringify(d.minzoom)),n=n+("|"+JSON.stringify(d.maxzoom)),n=n+("|"+JSON.stringify(d.filter));if(p.hasDataDrivenFill||p.hasDataDrivenOutline)n+="|"+JSON.stringify(b);a.push({key:n,layer:d})}2===d.type&&(p=d,n=d.sourceLayer,n+="|"+JSON.stringify(d.minzoom),n+="|"+JSON.stringify(d.maxzoom),n+="|"+JSON.stringify(d.filter),n+="|"+JSON.stringify(d.layout&&d.layout["line-cap"]),n+="|"+JSON.stringify(d.layout&&d.layout["line-join"]),p.hasDataDrivenLine&&
(n+="|"+JSON.stringify(b)),c.push({key:n,layer:d}));++b}this._assignRefLayers(a);this._assignRefLayers(c)};a.prototype._assignRefLayers=function(a){a.sort(function(a,b){return a.key<b.key?-1:a.key>b.key?1:0});for(var c,b,e=a.length,g=0;g<e;g++){var d=a[g];if(d.key===c)d.layer.refLayerId=b;else if(c=d.key,b=d.layer.id,1===d.layer.type&&!d.layer.getPaintProperty("fill-outline-color"))for(var p=g+1;p<e;p++){var n=a[p];if(n.key===c){if(n.layer.getPaintProperty("fill-outline-color")){a[g]=n;a[p]=d;b=n.layer.id;
break}}else break}}};a._create=function(a,c,b){c=1-1/(b.length+1)*(1+c);switch(a.type){case "background":return new q.BackgroundStyleLayer(0,a,c);case "fill":return new q.FillStyleLayer(1,a,c);case "line":return new q.LineStyleLayer(2,a,c);case "symbol":return new q.SymbolStyleLayer(3,a,c);case "raster":throw Error("Unsupported vector tile raster layer");case "circle":return new q.CircleStyleLayer(4,a,c)}throw Error("Unknown vector tile layer");};return a}()})},"*noref":1}});
define("require exports dojo/Deferred ../../core/promiseUtils ../2d/tiling/enums ./WorkerTile ./style/StyleRepository".split(" "),function(n,a,c,q,g,e,m){return function(){function a(){this._tiles=new Map;this._spriteInfo={};this._glyphInfo={}}a.prototype.reset=function(){var a=new c;this._spriteInfo={};this._glyphInfo={};var b=this._tiles;b.forEach(function(a){return a.setObsolete()});b.clear();a.resolve();return a.promise};a.prototype.getLayers=function(){return this._layers};a.prototype.setLayers=
function(a){this._layers=(new m(a)).layers;return q.resolve({data:""})};a.prototype.getTile=function(a,b){var c=this,f=a.key,l=e.pool.acquire();l.initialize(a.key,a.refKey,this,a.rotation);var m=a.cacheTile;return b.invoke("fetchTileData",a.refKey).then(function(a){return l.setDataAndParse(a,b).then(function(a){m&&l.status!==g.TileStatus.INVALID&&c._tiles.set(f,l);return a}).catch(function(a){l.setObsolete();e.pool.release(l);c._tiles["delete"](l.tileKey);return q.reject(a)})}).catch(function(a){l.setObsolete();
if(c._tiles.has(l.tileKey))c._tiles["delete"](l.tileKey);return q.reject(a)}).always(function(a){m||e.pool.release(l);return a})};a.prototype.update=function(a){var b=this._tiles.get(a.key);return b?b.updateSymbols(a.rotation):q.reject()};a.prototype.destructTileData=function(a){this._tiles.has(a)&&(e.pool.release(this._tiles.get(a)),this._tiles["delete"](a));return q.resolve()};a.prototype.fetchSprites=function(a,b){var c=[],e=this._spriteInfo;a.forEach(function(a){void 0===e[a]&&c.push(a)});return 0===
c.length?q.resolve():b.invoke("getSprites",c).then(function(a){for(var b in a)e[b]=a[b]})};a.prototype.getSpriteItems=function(){return this._spriteInfo};a.prototype.fetchGlyphs=function(a,b,c,e){var d=[],f=this._glyphInfo[b];f?c.forEach(function(a){f[a]||d.push(a)}):(f=this._glyphInfo[b]=[],c.forEach(function(a){return d.push(a)}));return 0===d.length?q.resolve():e.invoke("getGlyphs",{tileID:a,font:b,codePoints:d}).then(function(a){for(var b in a)f[b]=a[b]})};a.prototype.getGlyphItems=function(a){return this._glyphInfo[a]};
return a}()});