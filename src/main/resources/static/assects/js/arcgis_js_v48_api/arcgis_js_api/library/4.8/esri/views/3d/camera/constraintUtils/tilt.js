// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.8/esri/copyright.txt for details.
//>>built
define("require exports ./common ../../lib/glMatrix ../../state/utils/viewUtils ../../support/earthUtils ../../support/mathUtils".split(" "),function(w,k,f,e,r,l,n){function p(b,a,d,c){void 0===d&&(d=f.defaultApplyOptions);void 0===c&&(c=f.defaultApplyOptions);if(3===d.interactionType||!b.state.constraints.tilt)return 0;var e=r.viewAngle(b.renderCoordsHelper,a.center,a.eye);a=b.state.constraints.tilt(a.distance,v);if(0!==d.interactionType){var g=d.interactionStartCamera,h=d.interactionFactor,k=a.min,
m=a.max,q=p(b,g,f.defaultApplyOptions,d),l=0===q?0:r.viewAngle(b.renderCoordsHelper,g.center,g.eye);a.min=k;a.max=m;2===d.interactionType?(f.hasConstraintType(d.selection,2)&&t(b,g,a),f.adjustRangeForInteraction(q,l,!0,h,u,a)):f.adjustRangeForInteraction(q,l,!1,h,u,a)}2===c.interactionType&&f.hasConstraintType(c.selection,2)&&t(b,c.interactionStartCamera,a);b=n.clamp(e,a.min,a.max);e-=b;return 1E-6>=Math.abs(e)?0:e}function t(b,a,d){if(!b.state.isLocal){var c=b.state.constraints;if(c.altitude){b=
e.vec3d.length2(a.center);var f=Math.sqrt(b);a=a.distance;var g=c.altitude.min+l.earthRadius,c=c.altitude.max+l.earthRadius,g=(g*g-a*a-b)/(-2*f*a);d.min=Math.max(d.min,Math.min(Math.PI-n.acos((c*c-a*a-b)/(-2*f*a)),d.max));d.max=Math.min(d.max,Math.PI-n.acos(g))}}}Object.defineProperty(k,"__esModule",{value:!0});k.apply=function(b,a,d,c){void 0===d&&(d=f.defaultApplyOptions);void 0===c&&(c=a);a!==c&&c.copyFrom(a);b=p(b,a,d);if(0===b)return!1;e.mat4d.identity(h);e.mat4d.rotate(h,-b,a.viewRight);e.vec3d.subtract(a.center,
a.eye,m);e.mat4d.multiplyVec3(h,m);e.vec3d.subtract(a.center,m,c.eye);e.mat4d.multiplyVec3(h,c.up);c.markViewDirty();return!0};k.error=p;var m=e.vec3d.create(),h=e.mat4d.create(),u=n.deg2rad(5),v={min:0,max:0}});