// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.8/esri/copyright.txt for details.
//>>built
define("dojo/promise/all dojo/Deferred dojo/aspect dojo/has dojo/errors/create ./scheduling ./Logger ./declare ./lang".split(" "),function(m,h,n,b,g,p,q,r,t){function d(a,c){u.warn("DEPRECATED: "+a+"()"+(c?" -- use "+c+" instead":""))}b.add("esri-promise-compatibility",!0);b.add("esri-promise-compatibility-deprecation-warnings",!0);var u=q.getLogger("esri.core.Promise"),k=function(a){var c=a._promiseProps;if(!c.resolver.isFulfilled()){var e=c.resolvingPromises,b,d;c.allPromise&&c.allPromise.cancel();
var f=new h;for(b=e.length-1;0<=b;b--)d=e[b],d.isCanceled&&d.isCanceled()?e.splice(b,1):d.then(null,null,c.resolver.progress);d=null;(c.allPromise=m(e.concat([f.promise]))).then(function(){c.resolver.resolve(a);a=c=f=c.allPromise=c.resolvingPromises=null},function(b){c.allPromise=null;if(!b||"cancel"!==b.dojoType){var d=Array.prototype.slice.call(arguments,0);c.resolver.reject(d[0]);a=c=f=c.allPromise=c.resolvingPromises=null}});f&&p.schedule(function(){f&&f.resolve()})}},v=g("CancelError",null,function(a){this.target=
a}),w=function(a){return a||new v(this.instance)},l=function(a){this.instance=a;this.canceler=w.bind(this);this.resolver=new h;this.initialized=!1;this.resolvingPromises=[]};l.prototype={canceler:null,cancel:function(a){if(!this.resolver.isFulfilled()){this.allPromise.cancel();for(var c=this.resolvingPromises.concat(),b=c.length-1;0<=b;b--)c[b].cancel(a);this.resolver.cancel(a)}}};g={declaredClass:"esri.core.Promise",constructor:function(){Object.defineProperty(this,"_promiseProps",{value:new l(this),
enumerable:!1,configurable:!1,writable:!0});var a=n.after(this,"postscript",function(c,b){a.remove();a=null;k(this)},!0)},_promiseProps:null,always:function(a){b("esri-promise-compatibility-deprecation-warnings")&&d("always",".when(callbackOrErrback, callbackOrErrback)");return this.when(a,a)},isResolved:function(){return this._promiseProps.resolver.isResolved()},isRejected:function(){return this._promiseProps.resolver.isRejected()},isFulfilled:function(){return this._promiseProps.resolver.isFulfilled()},
otherwise:function(a){b("esri-promise-compatibility-deprecation-warnings")&&d("otherwise",".when().catch(errback)");return this.when(null,a)},catch:function(a){return this.when(null,a)},when:function(a,c,b){var d=new h(this._promiseProps.canceler);a=d.then(a,c,b);this._promiseProps.resolver.then(d.resolve,d.reject,d.progress);return a},addResolvingPromise:function(a){a&&!this._promiseProps.resolver.isFulfilled()&&(a._promiseProps&&(a=a.when()),this._promiseProps.resolvingPromises.push(a),k(this))}};
b("esri-promise-compatibility")||(g=t.mixin(g,{then:function(a,c,e){b("esri-promise-compatibility-deprecation-warnings")&&d("then",".when(callback, errback)");return this.when(a,c,e)},cancel:function(){b("esri-promise-compatibility-deprecation-warnings")&&d("cancel")},isCanceled:function(){b("esri-promise-compatibility-deprecation-warnings")&&d("isCanceled");return!1},trace:function(){b("esri-promise-compatibility-deprecation-warnings")&&d("trace");return this},traceRejected:function(){b("esri-promise-compatibility-deprecation-warnings")&&
d("traceRejected");return this}}));return r(null,g)});