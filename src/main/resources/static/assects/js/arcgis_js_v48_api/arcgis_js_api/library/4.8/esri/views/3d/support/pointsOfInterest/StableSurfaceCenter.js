// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.8/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/Accessor ../../../../core/Handles ../../../../core/watchUtils ../../../../core/accessorSupport/decorators ../../../../geometry/Point ../../../../geometry/support/aaBoundingRect".split(" "),function(d,f,g,e,h,k,l,c,m,n){Object.defineProperty(f,"__esModule",{value:!0});d=function(d){function a(b){b=d.call(this,b)||this;b.location=null;b._updatePromise=null;b._handles=new k;
return b}g(a,d);Object.defineProperty(a.prototype,"renderLocation",{get:function(){if(!this.location)return null;var b=[0,0,0];this.view.renderCoordsHelper.toRenderCoords(this.location,b);return b},enumerable:!0,configurable:!0});a.prototype.initialize=function(){var b=this;this.view.state.isLocal&&(this._handles.add([this.watch(["surfaceView.spatialReference","surfaceView.extent"],function(){return b._update()}),l.on(this,"surface.layers","change",function(){return b._update()})]),this._update())};
a.prototype.destroy=function(){this._handles.destroy()};a.prototype._update=function(){var b=this;this._updatePromise&&(this._updatePromise.cancel("cancel"),this._updatePromise=null);if(this.surfaceView&&this.surfaceView.extent&&this.surfaceView.spatialReference){var a=n.center(this.surfaceView.extent),a=new m({x:a[0],y:a[1],z:0,spatialReference:this.surfaceView.spatialReference});this.surface&&0<this.surface.layers.length?(this._set("location",null),this._updatePromise=this.surface.queryElevation(a,
{noDataValue:0}).then(function(a){b._updatePromise=null;b._set("location",a.geometry)}).catch(function(a){"cancel"===a||a&&"elevation-query:invalid-layer"===a.name||console.error("StableSurfaceCenter failed to update: ",a)})):this._set("location",a)}else this._set("location",null)};e([c.property({constructOnly:!0})],a.prototype,"view",void 0);e([c.property({readOnly:!0,aliasOf:"view.map.ground"})],a.prototype,"surface",void 0);e([c.property({readOnly:!0,aliasOf:"view.basemapTerrain"})],a.prototype,
"surfaceView",void 0);e([c.property({readOnly:!0})],a.prototype,"location",void 0);e([c.property({readOnly:!0,dependsOn:["location"]})],a.prototype,"renderLocation",null);return a=e([c.subclass("esri.views.3d.terrain.StableSurfaceCenter")],a)}(c.declared(h));f.StableSurfaceCenter=d;f.default=d});