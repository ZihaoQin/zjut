// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.8/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/tsSupport/assignHelper ../../../../core/Accessor ../../../../core/Promise ../../../../core/promiseUtils ../../../../core/requireUtils ../../../../core/throttle ../../../../core/workers ../../../../core/accessorSupport/decorators ./util module".split(" "),function(h,d,k,e,f,l,m,n,p,q,r,c,g,t){Object.defineProperty(d,"__esModule",{value:!0});f=function(d){function b(a){a=
d.call(this,a)||this;a.tileRenderer=null;a.setViewState=q.throttle(a.setViewState,50,a);return a}k(b,d);b.prototype.initialize=function(){var a=this;this.addResolvingPromise(r.open(p.getAbsMid("../features/Pipeline",h,t),{client:this.client,strategy:"dedicated"}).then(function(b){a._connection=b;return a._getStartupOptions(a.layer,a.tileInfo)}).then(function(b){return Array.isArray(b.service.source)?a._connection.invoke("startup",b,b.service.source):a._connection.invoke("startup",b)}))};b.prototype.destroy=
function(){this._connection&&this._connection.close()};b.prototype.configure=function(a){return this._connection.invoke("configure",a)};b.prototype.refresh=function(){return this._connection.invoke("controller.refresh")};b.prototype.redraw=function(){return this._connection.invoke("controller.redraw")};b.prototype.setViewState=function(a){return this._connection.invoke("setViewState",a.toJSON())};b.prototype.queryFeatures=function(a){return this._connection.invoke("controller.queryFeatures",a.toJSON())};
b.prototype.queryObjectIds=function(a){return this._connection.invoke("controller.queryObjectIds",a.toJSON())};b.prototype.queryFeatureCount=function(a){return this._connection.invoke("controller.queryFeatureCount",a.toJSON())};b.prototype.queryExtent=function(a){return this._connection.invoke("controller.queryExtent",a.toJSON())};b.prototype._getStartupOptions=function(a,b){var c=a.source;return c&&"esri.layers.graphics.sources.CSVSource"===c.declaredClass?c.openPorts().then(function(c){return{service:{capabilities:a.capabilities,
fields:a.fields.map(function(a){return a.toJSON()}),fullExtent:a.fullExtent.toJSON(),geometryType:g.toJSONGeometryType(a.geometryType),objectIdField:a.objectIdField,source:c},tileInfo:b.toJSON()}}):n.resolve({service:{capabilities:a.capabilities,fields:a.fields.map(function(a){return a.toJSON()}),fullExtent:a.fullExtent.toJSON(),geometryType:g.toJSONGeometryType(a.geometryType),objectIdField:a.objectIdField,source:a.url+"/"+a.layerId},tileInfo:b.toJSON()})};e([c.property({constructOnly:!0})],b.prototype,
"client",void 0);e([c.property({constructOnly:!0})],b.prototype,"layer",void 0);e([c.property({constructOnly:!0})],b.prototype,"tileInfo",void 0);e([c.property()],b.prototype,"tileRenderer",void 0);return b=e([c.subclass()],b)}(c.declared(l,m));d.default=f});