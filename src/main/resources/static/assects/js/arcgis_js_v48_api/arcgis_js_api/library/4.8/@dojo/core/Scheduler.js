//>>built
(function(a){"object"===typeof module&&"object"===typeof module.exports?(a=a(require,exports),void 0!==a&&(module.exports=a)):"function"===typeof define&&define.amd&&define(["require","exports","./queue"],a)})(function(a,c){function d(a){return{destroy:function(){this.destroy=function(){};a.isActive=!1;a.callback=null}}}Object.defineProperty(c,"__esModule",{value:!0});var e=a("./queue");a=function(){function a(b){this._task=this._deferred=null;this.deferWhileProcessing=b&&"deferWhileProcessing"in
b?b.deferWhileProcessing:!0;this.queueFunction=b&&b.queueFunction?b.queueFunction:e.queueTask;this._boundDispatch=this._dispatch.bind(this);this._isProcessing=!1;this._queue=[]}a.prototype._defer=function(b){b={isActive:!0,callback:b};this._deferred||(this._deferred=[]);this._deferred.push(b);return d(b)};a.prototype._dispatch=function(){this._isProcessing=!0;this._task&&(this._task.destroy(),this._task=null);for(var b=this._queue,a;a=b.shift();)a.isActive&&a.callback&&a.callback();this._isProcessing=
!1;if((b=this._deferred)&&b.length)for(this._deferred=null;a=b.shift();)this._schedule(a)};a.prototype._schedule=function(a){this._task||(this._task=this.queueFunction(this._boundDispatch));this._queue.push(a)};a.prototype.schedule=function(a){if(this._isProcessing&&this.deferWhileProcessing)return this._defer(a);a={isActive:!0,callback:a};this._schedule(a);return d(a)};return a}();c.default=a});